---
title: "01. Chapter5 - Interspecific variation in enzyme thermal performance curves"
author: "Elliott Schmidt"
date: "06 February, 2024"
output:
  html_document:
    keep_md: yes
    code_folding: show
    collapse: no
    df_print: paged
    fig_caption: yes
    fig_height: 4
    fig_width: 6
    highlight: monochrome
    theme: cerulean
    latex_engine: xelatex
    toc: yes
    toc_float: yes
    css: styles.css
  pdf_document:
    df_print: default
    fig_caption: yes
    fig_height: 4
    fig_width: 4
    highlight: tango
    latex_engine: xelatex
    number_sections: yes
    toc_depth: 2
documentclass: article
fontsize: 12pt
mainfont: Arial
mathfont: LiberationMono
classoption: a4paper
---

# Scenario 

Understanding thermal perfomance curves of anaerobic and aerobic enzymes for species can help identify differences in thermal tolerance among difference species. In this study four different species including, _Apogon rubrimacula_, _Apogon doederlein_, _Pomeacentrus australia_, and _Pomacentrus moluccensis_ had white muscle tissue samples collected, and used to determine thermal performance curves of two enzymes - lactate dehydrogenase (LDH) and citrate synthase (CS). Each enzyme was tested over five different temperatures including, 10$^\circ$C, 20$^\circ$C, 30$^\circ$C, 40$^\circ$C, and 50$^\circ$C, to create a thermal performance curve. Specie in this study consisted for two cardinal fish species and two damselfish species, with different levels of reliance on coral reef structures. Results from this study will help determine thermal tolerance levels of nultiple reef species to help understand how different species may respond differently to changing environmental conditions. 

# Load packages 


```r
library(plyr) # data manipulation
library(tidyverse) # data manipulation
library(janitor) # data manipulation
library(dplyr) # data manipulation
library(chron) # data manipulation - time data
library(lubridate) # data manipulation - specifically time data
library(ggplot2) # plotting figures
library(glmmTMB) # running models
library(performance) # model validation
library(car) # dependent
library(DHARMa) # model validation
library(MuMIn) # model validation
library(kableExtra) # creating tables
library(broom) # dependent
library(emmeans) # post-hoc analysis
library(ggeffects) # plotting models/model validation
library(vtable) # creating tables
library(modelr) # model validation
library(kableExtra) # formatting output tables
library(sjPlot) # plotting models & saving images as .svg
library(ggpmisc) # plotting linear equations on figures
```

# Lactate dehydrogenase (LDH)

## Read in the data




```r
knitr::opts_knit$set(root.dir=working.dir)
```

## Load data 



```r
ldh <- import.data
tissue.mass <- import.data2
```

## Data manipulation 


```r
#--- data preparation/manipulation ---# 
ldh2 <- ldh |>
  clean_names() |>
  separate(sample, into=c('tissue_type','species','replicate','temperature'), sep = "_", remove = FALSE) |> 
  mutate(creation_time = dmy_hm(creation_time)) |>
  separate(creation_time, into=c('DATE','TIME'), sep = " ", remove = FALSE) |>
  arrange(sample_id_1, DATE, TIME) 

ldh3 <- ldh2 |> 
  mutate(TIME = hms(ldh2$TIME)) |>
  mutate(TIME = chron(times=ldh2$TIME)) |>
  arrange(TIME) |>
  dplyr::group_by(sample, sample_id_1) |> 
  dplyr::mutate(TIME_DIFF = TIME - first(TIME)) |> 
  dplyr::filter(TIME != first(TIME)) |>
  dplyr::ungroup() |> 
  mutate(TIME_DIFF_SECS = period_to_seconds(hms(TIME_DIFF))) |> 
  mutate(MINUTES = TIME_DIFF_SECS/60) |> 
  mutate(MINUTES = round(MINUTES, digits = 2)) |> 
  dplyr::rename(CUVETTE = sample_id_1) |> 
  mutate(LATIN_NAME = case_when( species =="Adoed"~ "Apogon doederlein", 
                             species == "Arub" ~ "Apogon rubrimacula", 
                             species == "Paus" ~ "Pomacentrus australis",
                             species == "Pmol" ~ "Pomacentrus moluccensis",
                             TRUE ~ "na")) |> 
  unite("UNIQUE_SAMPLE_ID", c(species, replicate, temperature, sample_index), sep="_", remove = FALSE)
```

### Data cleaning 

Next select data points will be removed. Data points have been checked using previously written app script that allows the user to look at the plotted points of samples that were run. Because we are interested in the slope, points that plateaued were removed from the analysis, as it signifies that the reaction ran out of 'fuel' to use.

* **grp1**: removed last data point which was causing a plateau
* **grp2**: removed last 2 data points which was causing a plateau
* **grp3**: removed last 3 data points which was causing a plateau
* **grp4**: removed last 4 data points which was causing a plateau
* **grp5**: removed last 5 data points which was causing a plateau


```r
grp1 <- c() 
grp2 <- c("Paus_07_50_1","Paus_07_50_2","Paus_07_50_3","Paus_08_50_1","Paus_08_50_2","Paus_08_50_3", 
          "Pmol_06_50_1","Pmol_06_50_2","Pmol_06_50_3", "Pmol_08_50_1","Pmol_08_50_2","Pmol_08_50_3", 
          "Pmol_09_50_1","Pmol_09_50_2","Pmol_09_50_3")
grp3 <- c() 
grp4 <- c("Adoed_05_50_1","Adoed_05_50_2","Adoed_05_50_3", "Adoed_09_50_1","Adoed_09_50_2","Adoed_09_50_3") 
grp5 <- c("Arub_08_50_1","Arub_08_50_2","Arub_08_50_3", "Arub_07_50_1","Arub_07_50_2","Arub_07_50_3", 
          "Adoed_04_50_1","Adoed_04_50_2","Adoed_04_50_3", "Adoed_06_50_1","Adoed_06_50_2","Adoed_06_50_3", 
          "Adoed_07_50_1","Adoed_07_50_2","Adoed_07_50_3", "Adoed_08_50_1","Adoed_08_50_2","Adoed_08_50_3", 
          "Adoed_10_50_1","Adoed_10_50_2","Adoed_10_50_3", "Pmol_01_50_1","Pmol_01_50_2","Pmol_01_50_3")  
grp6 <- c() 
grp7 <- c() 
grp8 <- c("Adoed_02_50_1","Adoed_02_50_2","Adoed_02_50_3") 
```



```r
ldh3.filtered <- ldh3 |> 
  filter(!(UNIQUE_SAMPLE_ID %in% c("Arub_08_30_2", "Arub_06_40_2", "Arub_04_10_1", "Arub_02_40_2", 
                                   "Adoed_03_30_2", "Adoed_04_40_1", "Adoed_08_30_2", 
                                   "Paus_10_20_2", 
                                   "Pmol_03_40_3", "Pmol_04_50_3", "Pmol_05_30_2"))) |>
  dplyr::group_by(UNIQUE_SAMPLE_ID) |> 
  arrange(UNIQUE_SAMPLE_ID, TIME) |>
  dplyr::filter(!(UNIQUE_SAMPLE_ID %in% grp2 & row_number() > (n() - 2))) |> 
  dplyr::filter(!(UNIQUE_SAMPLE_ID %in% grp4 & row_number() > (n() - 4))) |> 
  dplyr::filter(!(UNIQUE_SAMPLE_ID %in% grp5 & row_number() > (n() - 5))) |> 
  dplyr::filter(!(UNIQUE_SAMPLE_ID %in% grp8 & row_number() > (n() - 8))) |> 
  dplyr::ungroup() |> 
  mutate(UNIQUE_SAMPLE_ID = str_sub(UNIQUE_SAMPLE_ID, end = -3))
```



```r
write.table(ldh3.filtered, file = "./excel_files/LDH_Hunter_filtered.csv", col.names = TRUE, row.names = FALSE, sep=",")
write.table(ldh3.filtered, file = "./import_files/LDH_Hunter_filtered.txt", col.names = TRUE, row.names = FALSE, sep="\t")
write.table(ldh3, file = "./excel_files/LDH_Hunter_processed.csv", col.names = TRUE, row.names = FALSE, sep=",")
write.table(ldh3, file = "./import_files/LDH_Hunter_processed.txt", col.names = TRUE, row.names = FALSE, sep="\t")
```
Great! Now we have all the data points that we want to keep. However, the data needs to manipulated in a way that we can obtain and pull out slopes from the absorption readings, and the calculate enzyme activity based on these slopes. This will involve a number of steps.  

### Data calculations 

#### Step1: Extract slopes 

Step1 will produce a data frame that provides you with the slope that was obtained for cuvettes 1-3 for each sample run at each experimental temperature. Note that at the end of this step we are removing slopes that were positive in value, as LDH slopes should produce a negative slope, due to NADH being used up. 

```r
LDH_activity <- ldh3.filtered %>% 
  dplyr::group_by(UNIQUE_SAMPLE_ID, CUVETTE) %>% 
  do({
    mod = lm(result ~ MINUTES, data = .)
    data.frame(Intercept = coef(mod)[1],
               Slope = coef(mod)[2], 
               r2 = summary(mod)$adj.r.squared)
  }) %>%
  dplyr::ungroup() %>%
  filter(CUVETTE != ("6"))%>% 
  filter(CUVETTE != ("4"))%>% 
  filter(CUVETTE != ("5")) %>% 
  filter(Slope <= 0)
```

#### Step2: Slope means

Step2 will calculate the mean slope for cuvette 1-3. 

```r
LDH_activity_means <- LDH_activity %>% 
  dplyr::group_by(UNIQUE_SAMPLE_ID) %>% 
  dplyr::mutate(Mean = mean(Slope)) %>% 
  ungroup()
```

#### Step3: Background activity level

Step3 will calculate background activity level by measuring the slope from cuvette 5 (postive control)

```r
LDH_background <- ldh3 %>% 
  group_by(UNIQUE_SAMPLE_ID, CUVETTE) %>% 
  do({
    mod = lm(result ~ MINUTES, data = .)
    data.frame(Intercept = coef(mod)[1],
               Slope = coef(mod)[2])
  }) %>%
  ungroup() %>%
  filter(CUVETTE == ("5")) %>% 
  dplyr::rename(Background = Slope) %>% 
  mutate(UNIQUE_SAMPLE_ID = str_sub(UNIQUE_SAMPLE_ID, end = -3)) 
```

#### Step4: Merging dataframes

Step4 will merge the data frames that you created with the mean slopes and the background slopes.

```r
final_table <- LDH_activity %>% 
  full_join(distinct(LDH_activity_means[,c(1,6)]), by = "UNIQUE_SAMPLE_ID") %>% 
  full_join(LDH_background[,c(1,4)], by = "UNIQUE_SAMPLE_ID") 
final_table$Mean[duplicated(final_table$Mean)] <- ""
final_table$Background[duplicated(final_table$Background)] <- ""
final_table <- final_table %>% 
  mutate(Mean = as.numeric(Mean), 
         Background = as.numeric(Background), 
         Background_perc = Background/Mean) 
```

#### Step5: Enzyme activity levels 

Step5 is where enzyme activity levels are calculated. See further details in manuscript (doi: xxx). Within this step background activity level is taken into account and subtracted from slopes where background activity was >5% or more of the sample slope. 

```r
ldh.data <- final_table %>% 
  select(c(UNIQUE_SAMPLE_ID, Mean, Background, Background_perc)) %>% 
  mutate(Mean = as.numeric(Mean), 
         Background = as.numeric(Background), 
         Background_perc = as.numeric(Background_perc)) %>% 
  mutate(Background2 = case_when(Background_perc <= 0.05 ~ 0, 
                                    TRUE ~ Background), 
         LDH_ABSORBANCE = Mean - Background2) %>%
  drop_na() %>% 
  inner_join(select(ldh3.filtered, c(UNIQUE_SAMPLE_ID, species, replicate, temperature, LATIN_NAME)), by ="UNIQUE_SAMPLE_ID") %>% 
  unite("fish_id", c(species,replicate), sep = "_", remove = FALSE)%>% 
  filter(fish_id != "Paus_07") %>%
  inner_join(tissue.mass, by = "fish_id") %>% 
  mutate(TISSUE_MASS_CENTERED = scale(tissue_mass, center = TRUE, scale = FALSE)) %>%
  distinct(UNIQUE_SAMPLE_ID, .keep_all = TRUE) %>% 
  mutate(PATH_LENGTH = 1, 
         EXTINCTION_COEFFICIENT = 6.22, 
         TISSUE_CONCENTRATION = 0.005, 
         ASSAY_VOL = 0.975, 
         SAMPLE_VOL = 0.025, 
         LDH_ACTIVITY = ((LDH_ABSORBANCE/(PATH_LENGTH*EXTINCTION_COEFFICIENT*TISSUE_CONCENTRATION))*(ASSAY_VOL/SAMPLE_VOL))*-1) %>% 
  mutate(species = factor(species), 
         replicate = factor(replicate), 
         temperature = as.numeric(temperature), 
         fish_id = factor(fish_id)) %>% 
  separate(LATIN_NAME, c("LATIN_GENUS","LATIN_SPECIES"), sep = " ", remove = FALSE) %>% 
  mutate(LATIN_GENUS = factor(LATIN_GENUS), 
         LATIN_SPECIES = factor(LATIN_SPECIES)) %>% 
  mutate(LATITUDE = factor(case_when(species =="Adoed"~ "sub-tropical", 
                             species == "Arub" ~ "tropical", 
                             species == "Paus" ~ "sub-tropical",
                             species == "Pmol" ~ "tropical",
                             TRUE ~ "na"))) 
```

All done! Ready for data analysis 

## Initial plot {.tabset}

### LDH v TEMPERATURE [SPECIES]


```r
ggplot(ldh.data, aes(x =temperature, y= LDH_ACTIVITY, color = species)) + 
  geom_point() + geom_smooth(method = "lm", se=FALSE) + theme_classic() 
```

![](01.DataAnalysis_files/figure-html/ldh-initial-plots-1.png)<!-- -->

### LDH [distribution]

```r
ggplot(ldh.data, aes(x = LDH_ACTIVITY, fill = temperature, color = temperature)) + 
  geom_density(alpha =0.5, position = "identity") 
```

![](01.DataAnalysis_files/figure-html/ldh-initial-plots-2-1.png)<!-- -->

```r
ggplot(ldh.data, aes(x=LDH_ACTIVITY)) + geom_histogram()
```

![](01.DataAnalysis_files/figure-html/ldh-initial-plots-2-2.png)<!-- -->

### LDH v TEMPERATURE [LATITUDE]

```r
ggplot(ldh.data, aes(x =temperature, y= LDH_ACTIVITY, colour = LATITUDE, fill=LATITUDE)) +   geom_point(alpha=0.3) + stat_smooth(method = "lm", se=TRUE,  formula=y ~ poly(x, 3, raw=TRUE), alpha=0.3) + facet_grid(~LATIN_GENUS) + theme_classic()
```

![](01.DataAnalysis_files/figure-html/ldh-initial-plots-3-1.png)<!-- -->

### LDH v TEMPERATURE [GENUS]

```r
ggplot(ldh.data, aes(x =temperature, y= LDH_ACTIVITY, colour = LATIN_GENUS, fill=LATIN_GENUS)) +   geom_point(alpha=0.3) + stat_smooth(method = "lm", se=TRUE,  formula=y ~ poly(x, 3, raw=TRUE), alpha=0.3) + facet_grid(~LATITUDE) + theme_classic()
```

![](01.DataAnalysis_files/figure-html/ldh-initial-plots-4-1.png)<!-- -->

### LDH v TEMPERATURE [SPECIES]

```r
ggplot(ldh.data, aes(x =temperature, y= LDH_ACTIVITY, colour = species, fill= species)) +   geom_point(alpha=0.3) + stat_smooth(method = "lm", se=TRUE,  formula=y ~ poly(x, 3, raw=TRUE), alpha=0.3) + theme_classic()
```

![](01.DataAnalysis_files/figure-html/ldh-initial-plots-5-1.png)<!-- -->

### {-}

## Fit the model 

The model was fit using the **glm** and later **glmmTMB** package in R. A number of different models were tested to determine which hypothesis and associated variables best predicted resting oxygen consumption. Model fit was examined using AICc, BIC, and r-squared values. Additional model were examined via the validation diagnostics provided by the **performance** and **dHARMA** packages in R.

From out initial plots we can see that our data is heavily skewed to the right. From our initial plots we can all see that the relationship between enzyme activity and temperature is no linear, but rather may represent either a quadratic or cubic relationship. Let's start out model selection process by comparing different polynomial models.  

### polynomial models

```r
#--- model 1 ---# 
ldh.model.1 <- glm(LDH_ACTIVITY ~ temperature * LATITUDE * LATIN_GENUS, 
               family = gaussian(),
               data = ldh.data) 

ldh.model.1.p2 <- glm(LDH_ACTIVITY ~ poly(temperature, 2) * LATITUDE * LATIN_GENUS, 
               family = gaussian(),
               data = ldh.data)  

ldh.model.1.p3 <- glm(LDH_ACTIVITY ~ poly(temperature, 3) * LATITUDE * LATIN_GENUS, 
               family = gaussian(),
               data = ldh.data) 
```

#### model comparisons - polynomial models 

```r
aic.c=AICc(ldh.model.1, ldh.model.1.p2, ldh.model.1.p3, k=2) 
bic=BIC(ldh.model.1, ldh.model.1.p2, ldh.model.1.p3)

model.fit.table <- as.data.frame(aic.c) %>% 
  tibble::rownames_to_column("model") %>%
  mutate(BIC = bic$BIC, 
         r2 = c(r.squaredLR(ldh.model.1)[1], r.squaredLR(ldh.model.1.p2)[1], r.squaredLR(ldh.model.1.p3)[1]))
model.fit.table %>% knitr::kable(format = "html")  %>%
  kable_paper(full_width = TRUE) 
```

<table class=" lightable-paper" style='font-family: "Arial Narrow", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>
 <thead>
  <tr>
   <th style="text-align:left;"> model </th>
   <th style="text-align:right;"> df </th>
   <th style="text-align:right;"> AICc </th>
   <th style="text-align:right;"> BIC </th>
   <th style="text-align:right;"> r2 </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> ldh.model.1 </td>
   <td style="text-align:right;"> 9 </td>
   <td style="text-align:right;"> 1891.262 </td>
   <td style="text-align:right;"> 1918.940 </td>
   <td style="text-align:right;"> 0.7594055 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> ldh.model.1.p2 </td>
   <td style="text-align:right;"> 13 </td>
   <td style="text-align:right;"> 1693.458 </td>
   <td style="text-align:right;"> 1732.774 </td>
   <td style="text-align:right;"> 0.9237926 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> ldh.model.1.p3 </td>
   <td style="text-align:right;"> 17 </td>
   <td style="text-align:right;"> 1693.711 </td>
   <td style="text-align:right;"> 1744.213 </td>
   <td style="text-align:right;"> 0.9276430 </td>
  </tr>
</tbody>
</table>

```r
anova(ldh.model.1, ldh.model.1.p2, ldh.model.1.p3, test = "Chisq")
```

<div data-pagedtable="false">
  <script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Resid. Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Resid. Dev"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Deviance"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chi)"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"172","2":"346697.5","3":"NA","4":"NA","5":"NA","_rn_":"1"},{"1":"168","2":"109815.2","3":"4","4":"236882.356","5":"2.320999e-79","_rn_":"2"},{"1":"164","2":"104266.7","3":"4","4":"5548.494","5":"6.829272e-02","_rn_":"3"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>

Looks like the model where temperature is treated as a second order polynomial (quadratic) is better than the linear and third order polynomial model. Lets see if adding the variable **tissue.mass** improves the model. 

### fixed factor comparisons

```r
#--- model 1 ---# 
ldh.model.1.p2 <- glm(LDH_ACTIVITY ~ poly(temperature, 2) * LATITUDE * LATIN_GENUS, 
               family = gaussian(),
               data = ldh.data)  

ldh.model.1.p2b <- ldh.model.1.p2 %>% update(. ~ poly(temperature, 2) * LATITUDE * LATIN_GENUS + TISSUE_MASS_CENTERED) 
```

#### model comparisons - fixed factor comparisons 

```r
aic.c=AICc(ldh.model.1.p2, ldh.model.1.p2b, k=2) 
bic=BIC(ldh.model.1.p2, ldh.model.1.p2b)

model.fit.table <- as.data.frame(aic.c) %>% 
  tibble::rownames_to_column("model") %>%
  mutate(BIC = bic$BIC, 
         r2 = c(r.squaredLR(ldh.model.1.p2)[1], r.squaredLR(ldh.model.1.p2b)[1]))
model.fit.table %>% knitr::kable(format = "html")  %>%
  kable_paper(full_width = TRUE) 
```

<table class=" lightable-paper" style='font-family: "Arial Narrow", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>
 <thead>
  <tr>
   <th style="text-align:left;"> model </th>
   <th style="text-align:right;"> df </th>
   <th style="text-align:right;"> AICc </th>
   <th style="text-align:right;"> BIC </th>
   <th style="text-align:right;"> r2 </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> ldh.model.1.p2 </td>
   <td style="text-align:right;"> 13 </td>
   <td style="text-align:right;"> 1693.458 </td>
   <td style="text-align:right;"> 1732.774 </td>
   <td style="text-align:right;"> 0.9237926 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> ldh.model.1.p2b </td>
   <td style="text-align:right;"> 14 </td>
   <td style="text-align:right;"> 1695.391 </td>
   <td style="text-align:right;"> 1737.547 </td>
   <td style="text-align:right;"> 0.9239699 </td>
  </tr>
</tbody>
</table>

```r
anova(ldh.model.1.p2, ldh.model.1.p2b, test = "Chisq")
```

<div data-pagedtable="false">
  <script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Resid. Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Resid. Dev"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Deviance"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chi)"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"168","2":"109815.2","3":"NA","4":"NA","5":"NA","_rn_":"1"},{"1":"167","2":"109559.6","3":"1","4":"255.6002","5":"0.5325058","_rn_":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>

The variable **TISSUE_MASS_CENTERED does not** improve the model, therefore it will be left out of the model moving forward. 

Lastly, because tissue samples from the same fish were tested at multiple temperatures we need to include **fish_id** as a random factor. 

### Generalised linear mixed model (GLMM)

```r
ldh.glmm.1.p2 <- glmmTMB(LDH_ACTIVITY ~ poly(temperature, 2) * LATITUDE * LATIN_GENUS + (1|fish_id), 
               family = gaussian(),
               REML = TRUE,
               data = ldh.data) 
```

Great! Now lets check our model validations to see how the model is performing. 

## Model validation {.tabset}

### ldh.glmm.1.p2 [performance]


```r
ldh.glmm.1.p2 %>% check_model(detrend=FALSE)
```

![](01.DataAnalysis_files/figure-html/model-validatiaon-1-1.png)<!-- -->

### ldh.glmm.1.p2 [DHARMa]


```r
ldh.glmm.1.p2 %>% simulateResiduals(plot=TRUE)
```

![](01.DataAnalysis_files/figure-html/model-validatiaon-2-1.png)<!-- -->

```
## Object of Class DHARMa with simulated residuals based on 250 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. 
##  
## Scaled residual values: 0.46 0.752 0.896 0.964 0.908 0.512 0.596 0.204 0 0 0.436 0.544 0.128 0.58 0.94 0.496 0.604 0.44 0.384 0.064 ...
```

```r
ldh.glmm.1.p2 %>% DHARMa::testResiduals(plot=TRUE)
```

![](01.DataAnalysis_files/figure-html/model-validatiaon-2-2.png)<!-- -->

```
## $uniformity
## 
## 	Asymptotic one-sample Kolmogorov-Smirnov test
## 
## data:  simulationOutput$scaledResiduals
## D = 0.12067, p-value = 0.01058
## alternative hypothesis: two-sided
## 
## 
## $dispersion
## 
## 	DHARMa nonparametric dispersion test via sd of residuals fitted vs.
## 	simulated
## 
## data:  simulationOutput
## dispersion = 0.92406, p-value = 0.528
## alternative hypothesis: two.sided
## 
## 
## $outliers
## 
## 	DHARMa outlier test based on exact binomial test with approximate
## 	expectations
## 
## data:  simulationOutput
## outliers at both margin(s) = 4, observations = 180, p-value = 0.05693
## alternative hypothesis: true probability of success is not equal to 0.007968127
## 95 percent confidence interval:
##  0.006087232 0.055917697
## sample estimates:
## frequency of outliers (expected: 0.00796812749003984 ) 
##                                             0.02222222
```

```
## $uniformity
## 
## 	Asymptotic one-sample Kolmogorov-Smirnov test
## 
## data:  simulationOutput$scaledResiduals
## D = 0.12067, p-value = 0.01058
## alternative hypothesis: two-sided
## 
## 
## $dispersion
## 
## 	DHARMa nonparametric dispersion test via sd of residuals fitted vs.
## 	simulated
## 
## data:  simulationOutput
## dispersion = 0.92406, p-value = 0.528
## alternative hypothesis: two.sided
## 
## 
## $outliers
## 
## 	DHARMa outlier test based on exact binomial test with approximate
## 	expectations
## 
## data:  simulationOutput
## outliers at both margin(s) = 4, observations = 180, p-value = 0.05693
## alternative hypothesis: true probability of success is not equal to 0.007968127
## 95 percent confidence interval:
##  0.006087232 0.055917697
## sample estimates:
## frequency of outliers (expected: 0.00796812749003984 ) 
##                                             0.02222222
```

There are a number of issues with this model. Lets see if we can solve some of the issues by exploring link functions that we have available.  

### {-}

## Re-fitting model 

Turn **REML** off when comparing models

### re-fitting models [link functions]


```r
ldh.glmm.1.p2 <- ldh.glmm.1.p2 %>% update(REML=FALSE)
ldh.glmm.1.p2.log <- ldh.glmm.1.p2 %>% update(family=gaussian(link="log"), 
                                              REML=FALSE) 
ldh.glmm.1.p2.sqrt <- ldh.glmm.1.p2 %>% update(family=gaussian(link="sqrt"), 
                                               REML=FALSE) 
```

### re-fit model comparisons [link function]


```r
aic.c=AICc(ldh.model.1.p2, ldh.glmm.1.p2.log,ldh.glmm.1.p2.sqrt,  k=2) 
bic=BIC(ldh.model.1.p2, ldh.glmm.1.p2.log, ldh.glmm.1.p2.sqrt)

model.fit.table <- as.data.frame(aic.c) %>% 
  tibble::rownames_to_column("model") %>%
  mutate(BIC = bic$BIC, 
         r2 = c(r.squaredGLMM(ldh.model.1.p2)[1], r.squaredGLMM(ldh.glmm.1.p2.log)[1], r.squaredGLMM(ldh.glmm.1.p2.sqrt)[1]))
model.fit.table %>% knitr::kable(format = "html")  %>%
  kable_paper(full_width = TRUE) 
```

<table class=" lightable-paper" style='font-family: "Arial Narrow", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>
 <thead>
  <tr>
   <th style="text-align:left;"> model </th>
   <th style="text-align:right;"> df </th>
   <th style="text-align:right;"> AICc </th>
   <th style="text-align:right;"> BIC </th>
   <th style="text-align:right;"> r2 </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> ldh.model.1.p2 </td>
   <td style="text-align:right;"> 13 </td>
   <td style="text-align:right;"> 1693.458 </td>
   <td style="text-align:right;"> 1732.774 </td>
   <td style="text-align:right;"> 0.9192059 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> ldh.glmm.1.p2.log </td>
   <td style="text-align:right;"> 14 </td>
   <td style="text-align:right;"> 1506.620 </td>
   <td style="text-align:right;"> 1548.776 </td>
   <td style="text-align:right;"> 0.0303329 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> ldh.glmm.1.p2.sqrt </td>
   <td style="text-align:right;"> 14 </td>
   <td style="text-align:right;"> 1506.513 </td>
   <td style="text-align:right;"> 1548.669 </td>
   <td style="text-align:right;"> 0.2098911 </td>
  </tr>
</tbody>
</table>

From this model comparison it looks like the model that uses the **square root** link function does the best job modelling the data. Lets see how the model validation looks. We will run the model one more time with **REML=TRUE** before looking at model validation outputs. 


```r
ldh.glmm.1.p2.sqrt <- ldh.glmm.1.p2.sqrt %>% update(REML = TRUE)
```

## Model re-validation {.tabset}

### ldh.glmm.1.p2 [performance]


```r
ldh.glmm.1.p2.sqrt %>% check_model(detrend=FALSE)
```

![](01.DataAnalysis_files/figure-html/ldh-model-re-validatiaon-1-1.png)<!-- -->

### ldh.glmm.1.p2 [DHARMa]


```r
ldh.glmm.1.p2.sqrt %>% simulateResiduals(plot=TRUE)
```

![](01.DataAnalysis_files/figure-html/ldh-model-re-validatiaon-2-1.png)<!-- -->

```
## Object of Class DHARMa with simulated residuals based on 250 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. 
##  
## Scaled residual values: 0.584 0.908 0.92 0.856 0.7 0.58 0.644 0.192 0.04 0.032 0.464 0.528 0.096 0.58 0.752 0.54 0.588 0.504 0.464 0.256 ...
```

```r
ldh.glmm.1.p2.sqrt %>% DHARMa::testResiduals(plot=TRUE)
```

![](01.DataAnalysis_files/figure-html/ldh-model-re-validatiaon-2-2.png)<!-- -->

```
## $uniformity
## 
## 	Asymptotic one-sample Kolmogorov-Smirnov test
## 
## data:  simulationOutput$scaledResiduals
## D = 0.168, p-value = 7.733e-05
## alternative hypothesis: two-sided
## 
## 
## $dispersion
## 
## 	DHARMa nonparametric dispersion test via sd of residuals fitted vs.
## 	simulated
## 
## data:  simulationOutput
## dispersion = 0.77407, p-value = 0.296
## alternative hypothesis: two.sided
## 
## 
## $outliers
## 
## 	DHARMa outlier test based on exact binomial test with approximate
## 	expectations
## 
## data:  simulationOutput
## outliers at both margin(s) = 0, observations = 180, p-value = 0.4112
## alternative hypothesis: true probability of success is not equal to 0.007968127
## 95 percent confidence interval:
##  0.0000000 0.0202852
## sample estimates:
## frequency of outliers (expected: 0.00796812749003984 ) 
##                                                      0
```

```
## $uniformity
## 
## 	Asymptotic one-sample Kolmogorov-Smirnov test
## 
## data:  simulationOutput$scaledResiduals
## D = 0.168, p-value = 7.733e-05
## alternative hypothesis: two-sided
## 
## 
## $dispersion
## 
## 	DHARMa nonparametric dispersion test via sd of residuals fitted vs.
## 	simulated
## 
## data:  simulationOutput
## dispersion = 0.77407, p-value = 0.296
## alternative hypothesis: two.sided
## 
## 
## $outliers
## 
## 	DHARMa outlier test based on exact binomial test with approximate
## 	expectations
## 
## data:  simulationOutput
## outliers at both margin(s) = 0, observations = 180, p-value = 0.4112
## alternative hypothesis: true probability of success is not equal to 0.007968127
## 95 percent confidence interval:
##  0.0000000 0.0202852
## sample estimates:
## frequency of outliers (expected: 0.00796812749003984 ) 
##                                                      0
```

### {-}

## Important note

**NOTE:** The sqrt gaussian model actually performs pretty well. However, when we look at the model there are clear signs of heteroscadiscity within the data (i.e., increasing variation at higher dependent variable values). This seems to be feature of the enzyme data whereby at low temperatures there is very little activity, and therefore little variation within activity at 10, 20, and 30C. However as temperatures increase to 40 and 50C we start to see enzyme activities increase exponentially and begin to identify maximal enzyme activity. Here we would _expect_ to see more variation as we are beginning to see the difference different individuals have in maximum LDH activity. One could argue in continuing to use this more despite heteroscadiscity being seen within the data. However, there are a couple of options if one chooses to fix the issue. The first could be to try a different distribution, another could be to transform that data. Both options are explored below. While these options may help, I think it is important to think about whether or not we want increase variation at higher temperatures to be something that is included within our model as it may be a _feature_ of the model rather than an unwanted _artefact_ within the data.

## Model re-re-fit 

### Gamma models

```r
ldh.glmm.1.p2.sqrt <- ldh.glmm.1.p2.sqrt %>% update(REML = FALSE)
ldh.glmm.1.p2.gamma.log <- ldh.glmm.1.p2.sqrt %>% update(family = Gamma(link="log"), 
                                                     REML = FALSE)  
ldh.glmm.1.p2.gamma.sqrt <- ldh.glmm.1.p2.sqrt %>% update(family = Gamma(link="sqrt"), 
                                                     REML = FALSE)  
```

### model comparisons - Gamma models 

```r
aic.c=AICc(ldh.glmm.1.p2.sqrt, ldh.glmm.1.p2.gamma.log,ldh.glmm.1.p2.gamma.sqrt,  k=2) 
bic=BIC(ldh.glmm.1.p2.sqrt, ldh.glmm.1.p2.gamma.log, ldh.glmm.1.p2.gamma.sqrt)

model.fit.table <- as.data.frame(aic.c) %>% 
  tibble::rownames_to_column("model") %>%
  mutate(BIC = bic$BIC, 
         r2 = c(r.squaredGLMM(ldh.glmm.1.p2.sqrt)[1], r.squaredGLMM(ldh.glmm.1.p2.gamma.log)[1], "NA"))
model.fit.table %>% knitr::kable(format = "html")  %>%
  kable_paper(full_width = TRUE) 
```

<table class=" lightable-paper" style='font-family: "Arial Narrow", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>
 <thead>
  <tr>
   <th style="text-align:left;"> model </th>
   <th style="text-align:right;"> df </th>
   <th style="text-align:right;"> AICc </th>
   <th style="text-align:right;"> BIC </th>
   <th style="text-align:left;"> r2 </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> ldh.glmm.1.p2.sqrt </td>
   <td style="text-align:right;"> 14 </td>
   <td style="text-align:right;"> 1506.513 </td>
   <td style="text-align:right;"> 1548.669 </td>
   <td style="text-align:left;"> 0.209891129009974 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> ldh.glmm.1.p2.gamma.log </td>
   <td style="text-align:right;"> 14 </td>
   <td style="text-align:right;"> 1466.203 </td>
   <td style="text-align:right;"> 1508.359 </td>
   <td style="text-align:left;"> 0.903875962318068 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> ldh.glmm.1.p2.gamma.sqrt </td>
   <td style="text-align:right;"> 14 </td>
   <td style="text-align:right;"> 1420.122 </td>
   <td style="text-align:right;"> 1462.278 </td>
   <td style="text-align:left;"> NA </td>
  </tr>
</tbody>
</table>

## Model re-re-validation {.tabset}

### ldh.glmm.1.p2.gamma [performance]


```r
ldh.glmm.1.p2.gamma.sqrt %>% check_model(detrend=FALSE)
```

![](01.DataAnalysis_files/figure-html/ldh-model-re-re-validatiaon-1-1.png)<!-- -->

### ldh.glmm.1.p2 [DHARMa]


```r
ldh.glmm.1.p2.gamma.sqrt %>% simulateResiduals(plot=TRUE)
```

![](01.DataAnalysis_files/figure-html/ldh-model-re-re-validatiaon-2-1.png)<!-- -->

```
## Object of Class DHARMa with simulated residuals based on 250 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. 
##  
## Scaled residual values: 0.496 0.96 1 0.92 0.528 0.516 0.38 0.264 0.152 0.064 0.236 0.1 0.088 0.744 0.52 0.432 0.076 0.676 0.656 0.204 ...
```

```r
ldh.glmm.1.p2.gamma.sqrt %>% DHARMa::testResiduals(plot=TRUE)
```

![](01.DataAnalysis_files/figure-html/ldh-model-re-re-validatiaon-2-2.png)<!-- -->

```
## $uniformity
## 
## 	Asymptotic one-sample Kolmogorov-Smirnov test
## 
## data:  simulationOutput$scaledResiduals
## D = 0.047111, p-value = 0.8192
## alternative hypothesis: two-sided
## 
## 
## $dispersion
## 
## 	DHARMa nonparametric dispersion test via sd of residuals fitted vs.
## 	simulated
## 
## data:  simulationOutput
## dispersion = 0.50061, p-value < 2.2e-16
## alternative hypothesis: two.sided
## 
## 
## $outliers
## 
## 	DHARMa outlier test based on exact binomial test with approximate
## 	expectations
## 
## data:  simulationOutput
## outliers at both margin(s) = 3, observations = 180, p-value = 0.1743
## alternative hypothesis: true probability of success is not equal to 0.007968127
## 95 percent confidence interval:
##  0.003450344 0.047932200
## sample estimates:
## frequency of outliers (expected: 0.00796812749003984 ) 
##                                             0.01666667
```

```
## $uniformity
## 
## 	Asymptotic one-sample Kolmogorov-Smirnov test
## 
## data:  simulationOutput$scaledResiduals
## D = 0.047111, p-value = 0.8192
## alternative hypothesis: two-sided
## 
## 
## $dispersion
## 
## 	DHARMa nonparametric dispersion test via sd of residuals fitted vs.
## 	simulated
## 
## data:  simulationOutput
## dispersion = 0.50061, p-value < 2.2e-16
## alternative hypothesis: two.sided
## 
## 
## $outliers
## 
## 	DHARMa outlier test based on exact binomial test with approximate
## 	expectations
## 
## data:  simulationOutput
## outliers at both margin(s) = 3, observations = 180, p-value = 0.1743
## alternative hypothesis: true probability of success is not equal to 0.007968127
## 95 percent confidence interval:
##  0.003450344 0.047932200
## sample estimates:
## frequency of outliers (expected: 0.00796812749003984 ) 
##                                             0.01666667
```

### {-}

## Important note 2
The Gamma distribution does seem to improve the model, definitely helps solve the heteroscadisity problem, however, there are down sides. The gamma more with the square-root link doesn't seem to as good a job at handling data at the upper and lower ends of the spectrum as noted by the qq-plot in the performance package diagnostics. Also, the dispersion assumption within the DHARMa diagnositics is violated. Let's move on and see how the data transformation models perform. 

## Fit model [Transformed data]

### polynomial models [Transformed data]

```r
#--- model 1 ---# 
ldh.sqrt.model.1 <- glm(sqrt(LDH_ACTIVITY) ~ temperature * LATITUDE * LATIN_GENUS, 
               family = gaussian(),
               data = ldh.data) 

ldh.sqrt.model.1.p2 <- glm(sqrt(LDH_ACTIVITY) ~ poly(temperature, 2) * LATITUDE * LATIN_GENUS, 
               family = gaussian(),
               data = ldh.data)  

ldh.sqrt.model.1.p3 <- glm(sqrt(LDH_ACTIVITY) ~ poly(temperature, 3) * LATITUDE * LATIN_GENUS, 
               family = gaussian(),
               data = ldh.data) 
```

#### model comparisons - polynomial models 

```r
aic.c=AICc(ldh.sqrt.model.1, ldh.sqrt.model.1.p2, ldh.sqrt.model.1.p3, k=2) 
bic=BIC(ldh.sqrt.model.1, ldh.sqrt.model.1.p2, ldh.sqrt.model.1.p3)

model.fit.table <- as.data.frame(aic.c) %>% 
  tibble::rownames_to_column("model") %>%
  mutate(BIC = bic$BIC, 
         r2 = c(r.squaredLR(ldh.sqrt.model.1)[1], r.squaredLR(ldh.sqrt.model.1.p2)[1], r.squaredLR(ldh.sqrt.model.1.p3)[1]))
model.fit.table %>% knitr::kable(format = "html")  %>%
  kable_paper(full_width = TRUE) 
```

<table class=" lightable-paper" style='font-family: "Arial Narrow", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>
 <thead>
  <tr>
   <th style="text-align:left;"> model </th>
   <th style="text-align:right;"> df </th>
   <th style="text-align:right;"> AICc </th>
   <th style="text-align:right;"> BIC </th>
   <th style="text-align:right;"> r2 </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> ldh.sqrt.model.1 </td>
   <td style="text-align:right;"> 9 </td>
   <td style="text-align:right;"> 756.2015 </td>
   <td style="text-align:right;"> 783.8793 </td>
   <td style="text-align:right;"> 0.8516424 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> ldh.sqrt.model.1.p2 </td>
   <td style="text-align:right;"> 13 </td>
   <td style="text-align:right;"> 603.8626 </td>
   <td style="text-align:right;"> 643.1783 </td>
   <td style="text-align:right;"> 0.9395054 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> ldh.sqrt.model.1.p3 </td>
   <td style="text-align:right;"> 17 </td>
   <td style="text-align:right;"> 606.1139 </td>
   <td style="text-align:right;"> 656.6164 </td>
   <td style="text-align:right;"> 0.9419206 </td>
  </tr>
</tbody>
</table>

```r
anova(ldh.sqrt.model.1, ldh.sqrt.model.1.p2, ldh.sqrt.model.1.p3, test = "Chisq")
```

<div data-pagedtable="false">
  <script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Resid. Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Resid. Dev"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Deviance"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chi)"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"172","2":"632.9029","3":"NA","4":"NA","5":"NA","_rn_":"1"},{"1":"168","2":"258.0738","3":"4","4":"374.82904","5":"1.670132e-52","_rn_":"2"},{"1":"164","2":"247.7704","3":"4","4":"10.30339","5":"1.457203e-01","_rn_":"3"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>

Once again the model that fits temperature as a second order polynomial seems to be the best fit. lets continue. 


```r
ldh.sqrt.model.1.p2 <- glmmTMB(sqrt(LDH_ACTIVITY) ~ poly(temperature, 2) * LATITUDE * LATIN_GENUS + (1|fish_id), 
               family = gaussian(),
               REML=TRUE,
               data = ldh.data)  
```

## Model validation [Transformed data] {.tabset}

### ldh.sqrt.model.1.p2 [performance]


```r
ldh.sqrt.model.1.p2 %>% check_model(detrend=FALSE)
```

![](01.DataAnalysis_files/figure-html/ldh-model-trans-validatiaon-1-1.png)<!-- -->

### ldh.sqrt.model.1.p2 [DHARMa]


```r
ldh.sqrt.model.1.p2 %>% simulateResiduals(plot=TRUE)
```

![](01.DataAnalysis_files/figure-html/ldh-model-trans-validatiaon-2-1.png)<!-- -->

```
## Object of Class DHARMa with simulated residuals based on 250 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. 
##  
## Scaled residual values: 0.584 0.792 0.976 0.98 0.64 0.648 0.344 0.124 0.052 0 0.424 0.144 0.04 0.832 0.7 0.576 0.168 0.556 0.66 0.136 ...
```

```r
ldh.sqrt.model.1.p2 %>% DHARMa::testResiduals(plot=TRUE)
```

![](01.DataAnalysis_files/figure-html/ldh-model-trans-validatiaon-2-2.png)<!-- -->

```
## $uniformity
## 
## 	Asymptotic one-sample Kolmogorov-Smirnov test
## 
## data:  simulationOutput$scaledResiduals
## D = 0.060667, p-value = 0.5217
## alternative hypothesis: two-sided
## 
## 
## $dispersion
## 
## 	DHARMa nonparametric dispersion test via sd of residuals fitted vs.
## 	simulated
## 
## data:  simulationOutput
## dispersion = 0.91628, p-value = 0.552
## alternative hypothesis: two.sided
## 
## 
## $outliers
## 
## 	DHARMa outlier test based on exact binomial test with approximate
## 	expectations
## 
## data:  simulationOutput
## outliers at both margin(s) = 3, observations = 180, p-value = 0.1743
## alternative hypothesis: true probability of success is not equal to 0.007968127
## 95 percent confidence interval:
##  0.003450344 0.047932200
## sample estimates:
## frequency of outliers (expected: 0.00796812749003984 ) 
##                                             0.01666667
```

```
## $uniformity
## 
## 	Asymptotic one-sample Kolmogorov-Smirnov test
## 
## data:  simulationOutput$scaledResiduals
## D = 0.060667, p-value = 0.5217
## alternative hypothesis: two-sided
## 
## 
## $dispersion
## 
## 	DHARMa nonparametric dispersion test via sd of residuals fitted vs.
## 	simulated
## 
## data:  simulationOutput
## dispersion = 0.91628, p-value = 0.552
## alternative hypothesis: two.sided
## 
## 
## $outliers
## 
## 	DHARMa outlier test based on exact binomial test with approximate
## 	expectations
## 
## data:  simulationOutput
## outliers at both margin(s) = 3, observations = 180, p-value = 0.1743
## alternative hypothesis: true probability of success is not equal to 0.007968127
## 95 percent confidence interval:
##  0.003450344 0.047932200
## sample estimates:
## frequency of outliers (expected: 0.00796812749003984 ) 
##                                             0.01666667
```

### plot_model 

```r
plot_model(ldh.sqrt.model.1.p2, type = "diag")[-2] 
```

```
## [[1]]
```

![](01.DataAnalysis_files/figure-html/ldh-model-trans-validatiaon-3-1.png)<!-- -->

```
## 
## [[2]]
```

![](01.DataAnalysis_files/figure-html/ldh-model-trans-validatiaon-3-2.png)<!-- -->

```
## 
## [[3]]
```

![](01.DataAnalysis_files/figure-html/ldh-model-trans-validatiaon-3-3.png)<!-- -->

### {-}

## Important note 3 

It looks like transforming the data via a square root transformation really helps model performance. No significant data violations occur and the diagnostic plots start to look a lot better. This is definitely a viable and justifiable option. 

## Partial plots {.tabset} 

### ggemmeans {.tabset} 

#### TEMPERATURE V LATITUDE

![](01.DataAnalysis_files/figure-html/ldh-partial-plots-1-1.png)<!-- -->

#### TEMPERATURE V GENUS

![](01.DataAnalysis_files/figure-html/ldh-partial-plots-1b-1.png)<!-- -->

#### TEMPERATURE V GENUS V LATITUDE

![](01.DataAnalysis_files/figure-html/ldh-partial-plots-1c-1.png)<!-- -->

### plot_model 


```
## Formula contains log- or sqrt-terms.
##   See help("standardize") for how such terms are standardized.
```

![](01.DataAnalysis_files/figure-html/ldhpartial-plots-1d-1.png)<!-- -->

#### {-}

### {-}

## Model investigation {.tabset .tabset-pills}

### summary 
<table class=" lightable-paper" style='font-family: "Arial Narrow", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:right;"> Estimate </th>
   <th style="text-align:right;"> StdError </th>
   <th style="text-align:right;"> Zvalue </th>
   <th style="text-align:right;"> Pvalue </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> (Intercept) </td>
   <td style="text-align:right;"> 8.4346789 </td>
   <td style="text-align:right;"> 0.3069896 </td>
   <td style="text-align:right;"> 27.4754528 </td>
   <td style="text-align:right;"> 0.0000000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2)1 </td>
   <td style="text-align:right;"> 69.9975165 </td>
   <td style="text-align:right;"> 1.8970910 </td>
   <td style="text-align:right;"> 36.8972903 </td>
   <td style="text-align:right;"> 0.0000000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2)2 </td>
   <td style="text-align:right;"> 19.2710299 </td>
   <td style="text-align:right;"> 1.8970910 </td>
   <td style="text-align:right;"> 10.1582002 </td>
   <td style="text-align:right;"> 0.0000000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> LATITUDEtropical </td>
   <td style="text-align:right;"> -1.9610952 </td>
   <td style="text-align:right;"> 0.4231560 </td>
   <td style="text-align:right;"> -4.6344499 </td>
   <td style="text-align:right;"> 0.0000036 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> LATIN_GENUSPomacentrus </td>
   <td style="text-align:right;"> -1.8977322 </td>
   <td style="text-align:right;"> 0.4641247 </td>
   <td style="text-align:right;"> -4.0888414 </td>
   <td style="text-align:right;"> 0.0000434 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2)1:LATITUDEtropical </td>
   <td style="text-align:right;"> -17.0083943 </td>
   <td style="text-align:right;"> 2.6149594 </td>
   <td style="text-align:right;"> -6.5042670 </td>
   <td style="text-align:right;"> 0.0000000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2)2:LATITUDEtropical </td>
   <td style="text-align:right;"> 0.3492053 </td>
   <td style="text-align:right;"> 2.6149594 </td>
   <td style="text-align:right;"> 0.1335414 </td>
   <td style="text-align:right;"> 0.8937652 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2)1:LATIN_GENUSPomacentrus </td>
   <td style="text-align:right;"> -17.4786510 </td>
   <td style="text-align:right;"> 2.8681320 </td>
   <td style="text-align:right;"> -6.0940888 </td>
   <td style="text-align:right;"> 0.0000000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2)2:LATIN_GENUSPomacentrus </td>
   <td style="text-align:right;"> 0.0320126 </td>
   <td style="text-align:right;"> 2.8681320 </td>
   <td style="text-align:right;"> 0.0111615 </td>
   <td style="text-align:right;"> 0.9910946 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> LATITUDEtropical:LATIN_GENUSPomacentrus </td>
   <td style="text-align:right;"> 2.5136290 </td>
   <td style="text-align:right;"> 0.6205227 </td>
   <td style="text-align:right;"> 4.0508251 </td>
   <td style="text-align:right;"> 0.0000510 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2)1:LATITUDEtropical:LATIN_GENUSPomacentrus </td>
   <td style="text-align:right;"> 23.9315475 </td>
   <td style="text-align:right;"> 3.8346184 </td>
   <td style="text-align:right;"> 6.2409202 </td>
   <td style="text-align:right;"> 0.0000000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2)2:LATITUDEtropical:LATIN_GENUSPomacentrus </td>
   <td style="text-align:right;"> -0.4332372 </td>
   <td style="text-align:right;"> 3.8346184 </td>
   <td style="text-align:right;"> -0.1129805 </td>
   <td style="text-align:right;"> 0.9100460 </td>
  </tr>
</tbody>
</table>

### anova 
<table class=" lightable-paper" style='font-family: "Arial Narrow", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:right;"> Chisq </th>
   <th style="text-align:right;"> Df </th>
   <th style="text-align:right;"> Pr(&gt;Chisq) </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2) </td>
   <td style="text-align:right;"> 4277.899783 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.0000000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> LATITUDE </td>
   <td style="text-align:right;"> 6.551040 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0104823 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> LATIN_GENUS </td>
   <td style="text-align:right;"> 2.545565 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.1106043 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2):LATITUDE </td>
   <td style="text-align:right;"> 9.455468 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.0088465 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2):LATIN_GENUS </td>
   <td style="text-align:right;"> 4.628818 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.0988246 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> LATITUDE:LATIN_GENUS </td>
   <td style="text-align:right;"> 16.409184 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0000510 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2):LATITUDE:LATIN_GENUS </td>
   <td style="text-align:right;"> 38.961849 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.0000000 </td>
  </tr>
</tbody>
</table>

### confint 
<table class=" lightable-paper" style='font-family: "Arial Narrow", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:right;"> 2.5 % </th>
   <th style="text-align:right;"> 97.5 % </th>
   <th style="text-align:right;"> Estimate </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> (Intercept) </td>
   <td style="text-align:right;"> 7.8329903 </td>
   <td style="text-align:right;"> 9.0363675 </td>
   <td style="text-align:right;"> 8.4346789 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2)1 </td>
   <td style="text-align:right;"> 66.2792865 </td>
   <td style="text-align:right;"> 73.7157465 </td>
   <td style="text-align:right;"> 69.9975165 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2)2 </td>
   <td style="text-align:right;"> 15.5527999 </td>
   <td style="text-align:right;"> 22.9892599 </td>
   <td style="text-align:right;"> 19.2710299 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> LATITUDEtropical </td>
   <td style="text-align:right;"> -2.7904657 </td>
   <td style="text-align:right;"> -1.1317247 </td>
   <td style="text-align:right;"> -1.9610952 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> LATIN_GENUSPomacentrus </td>
   <td style="text-align:right;"> -2.8073999 </td>
   <td style="text-align:right;"> -0.9880646 </td>
   <td style="text-align:right;"> -1.8977322 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2)1:LATITUDEtropical </td>
   <td style="text-align:right;"> -22.1336207 </td>
   <td style="text-align:right;"> -11.8831680 </td>
   <td style="text-align:right;"> -17.0083943 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2)2:LATITUDEtropical </td>
   <td style="text-align:right;"> -4.7760210 </td>
   <td style="text-align:right;"> 5.4744317 </td>
   <td style="text-align:right;"> 0.3492053 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2)1:LATIN_GENUSPomacentrus </td>
   <td style="text-align:right;"> -23.1000863 </td>
   <td style="text-align:right;"> -11.8572156 </td>
   <td style="text-align:right;"> -17.4786510 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2)2:LATIN_GENUSPomacentrus </td>
   <td style="text-align:right;"> -5.5894228 </td>
   <td style="text-align:right;"> 5.6534479 </td>
   <td style="text-align:right;"> 0.0320126 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> LATITUDEtropical:LATIN_GENUSPomacentrus </td>
   <td style="text-align:right;"> 1.2974268 </td>
   <td style="text-align:right;"> 3.7298312 </td>
   <td style="text-align:right;"> 2.5136290 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2)1:LATITUDEtropical:LATIN_GENUSPomacentrus </td>
   <td style="text-align:right;"> 16.4158335 </td>
   <td style="text-align:right;"> 31.4472616 </td>
   <td style="text-align:right;"> 23.9315475 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2)2:LATITUDEtropical:LATIN_GENUSPomacentrus </td>
   <td style="text-align:right;"> -7.9489512 </td>
   <td style="text-align:right;"> 7.0824768 </td>
   <td style="text-align:right;"> -0.4332372 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Std.Dev.(Intercept)|fish_id </td>
   <td style="text-align:right;"> 0.5979972 </td>
   <td style="text-align:right;"> 1.1174566 </td>
   <td style="text-align:right;"> 0.8174570 </td>
  </tr>
</tbody>
</table>

### r-squared
<table class=" lightable-paper" style='font-family: "Arial Narrow", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>
 <thead>
  <tr>
   <th style="text-align:right;"> R2_conditional </th>
   <th style="text-align:right;"> R2_marginal </th>
   <th style="text-align:left;"> optional </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:right;"> 0.9624467 </td>
   <td style="text-align:right;"> 0.9345559 </td>
   <td style="text-align:left;"> FALSE </td>
  </tr>
</tbody>
</table>

### {-} 

## Pairwise comparisons {.tabset .tabset-faded} 

### emtrends 


```r
ldh.sqrt.model.1.p2 %>% emtrends(var = "temperature", type = "response") %>% pairs(by = "temperature") %>% summary(by = NULL, adjust = "sidak", infer=TRUE)
```

<div data-pagedtable="false">
  <script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["contrast"],"name":[1],"type":["fct"],"align":["left"]},{"label":["temperature"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["estimate"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["SE"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["lower.CL"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["upper.CL"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["t.ratio"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[9],"type":["dbl"],"align":["right"]}],"data":[{"1":"(sub-tropical Apogon) - tropical Apogon","2":"30","3":"0.089635887","4":"0.01378213","5":"178","6":"0.05296687","7":"0.126304909","8":"6.5037783","9":"4.594408e-09","_rn_":"1"},{"1":"(sub-tropical Apogon) - (sub-tropical Pomacentrus)","2":"30","3":"0.092120009","4":"0.01511647","5":"178","6":"0.05190080","7":"0.132339215","8":"6.0940163","9":"3.986274e-08","_rn_":"2"},{"1":"(sub-tropical Apogon) - tropical Pomacentrus","2":"30","3":"0.055633285","4":"0.01378213","5":"178","6":"0.01896426","7":"0.092302306","8":"4.0366260","9":"4.825908e-04","_rn_":"3"},{"1":"tropical Apogon - (sub-tropical Pomacentrus)","2":"30","3":"0.002484122","4":"0.01478210","5":"178","6":"-0.03684545","7":"0.041813693","8":"0.1680493","9":"9.999944e-01","_rn_":"4"},{"1":"tropical Apogon - tropical Pomacentrus","2":"30","3":"-0.034002602","4":"0.01341454","5":"178","6":"-0.06969361","7":"0.001688402","8":"-2.5347581","9":"7.051804e-02","_rn_":"5"},{"1":"(sub-tropical Pomacentrus) - tropical Pomacentrus","2":"30","3":"-0.036486724","4":"0.01478210","5":"178","6":"-0.07581630","7":"0.002842848","8":"-2.4683048","9":"8.401672e-02","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
SCROLL TO THE RIGHT -->

The numbers in the left most column in the table just mention that the slopes are assuming mean **MASS_CENTERED** and **RESTING_TIME_SEONDS** values when looking at differences between latitudinal slopes.

### emmeans 

```r
ldh.sqrt.model.1.p2 %>% emmeans(pairwise ~ temperature*LATITUDE*LATIN_GENUS, type = "response") %>% pairs(by = "temperature") %>% summary(by = NULL, adjust = "sidak", infer=TRUE)
```

<div data-pagedtable="false">
  <script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["contrast"],"name":[1],"type":["fct"],"align":["left"]},{"label":["temperature"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["estimate"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["SE"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["lower.CL"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["upper.CL"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["t.ratio"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[9],"type":["dbl"],"align":["right"]}],"data":[{"1":"(sub-tropical Apogon) - tropical Apogon","2":"30","3":"1.99220492","4":"0.4830434","5":"178","6":"0.70700913","7":"3.2774007","8":"4.124277","9":"0.0003419074","_rn_":"1"},{"1":"(sub-tropical Apogon) - (sub-tropical Pomacentrus)","2":"30","3":"1.90058415","4":"0.5298102","5":"178","6":"0.49095955","7":"3.3102087","8":"3.587292","9":"0.0025868869","_rn_":"2"},{"1":"(sub-tropical Apogon) - tropical Pomacentrus","2":"30","3":"1.34056421","4":"0.4830434","5":"178","6":"0.05536842","7":"2.6257600","8":"2.775246","9":"0.0360775756","_rn_":"3"},{"1":"tropical Apogon - (sub-tropical Pomacentrus)","2":"30","3":"-0.09162078","4":"0.5180910","5":"178","6":"-1.47006498","7":"1.2868234","8":"-0.176843","9":"0.9999924163","_rn_":"4"},{"1":"tropical Apogon - tropical Pomacentrus","2":"30","3":"-0.65164071","4":"0.4701599","5":"178","6":"-1.90255844","7":"0.5992770","8":"-1.385998","9":"0.6670617476","_rn_":"5"},{"1":"(sub-tropical Pomacentrus) - tropical Pomacentrus","2":"30","3":"-0.56001993","4":"0.5180910","5":"178","6":"-1.93846414","7":"0.8184243","8":"-1.080930","9":"0.8620626111","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>

### temperature 

```r
ldh.sqrt.model.1.p2 %>% emmeans(~ temperature*LATITUDE*LATIN_GENUS, type = "response")  %>% summary(infer=TRUE)
```

<div data-pagedtable="false">
  <script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["temperature"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["LATITUDE"],"name":[2],"type":["fct"],"align":["left"]},{"label":["LATIN_GENUS"],"name":[3],"type":["fct"],"align":["left"]},{"label":["response"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["SE"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["lower.CL"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["upper.CL"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["t.ratio"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[10],"type":["dbl"],"align":["right"]}],"data":[{"1":"30","2":"sub-tropical","3":"Apogon","4":"45.12990","5":"4.708380","6":"178","7":"36.31671","8":"54.89956","9":"19.17003","10":"3.750407e-45","_rn_":"1"},{"1":"30","2":"tropical","3":"Apogon","4":"22.33200","5":"3.142132","6":"178","7":"16.56178","8":"28.96303","9":"14.21455","10":"3.912105e-31","_rn_":"2"},{"1":"30","2":"sub-tropical","3":"Pomacentrus","4":"23.20633","5":"3.828378","6":"178","7":"16.26635","8":"31.37605","9":"12.12332","10":"4.767496e-25","_rn_":"3"},{"1":"30","2":"tropical","3":"Pomacentrus","4":"28.91552","5":"3.575412","6":"178","7":"22.29028","8":"36.40158","9":"16.17465","10":"8.724701e-37","_rn_":"4"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>

### temperture [combined]

```r
ldh.means.temp <- ldh.sqrt.model.1.p2 %>% update(sqrt(LDH_ACTIVITY) ~ factor(temperature) * LATITUDE * LATIN_GENUS + (1|fish_id)) %>% emmeans(pairwise ~ temperature, type = "response"); ldh.means.temp$emmeans
```

```
## NOTE: Results may be misleading due to involvement in interactions
```

```
##  temperature response   SE  df lower.CL upper.CL
##           10     7.57 1.14 178     5.49     9.98
##           20     9.66 1.29 178     7.29    12.36
##           30    26.07 2.11 178    22.07    30.40
##           40    96.83 4.07 178    88.97   105.03
##           50   220.92 6.15 178   208.95   233.21
## 
## Results are averaged over the levels of: LATITUDE, LATIN_GENUS 
## Confidence level used: 0.95 
## Intervals are back-transformed from the sqrt scale
```

```r
ldh.means.temp.df <- ldh.means.temp$emmeans %>% as.data.frame() %>% 
  mutate("\u394 change"=response - lag(response, n=1, default = first(response)), 
         "\u394 %change" = response/lag(response, n=1, default = first(response))*100) 
ldh.means.temp.df[1,8] = 0.0000 

ldh.means.temp.df %>% knitr::kable(format = "html")  %>%
  kable_paper(full_width = TRUE) 
```

<table class=" lightable-paper" style='font-family: "Arial Narrow", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>
 <thead>
  <tr>
   <th style="text-align:right;"> temperature </th>
   <th style="text-align:right;"> response </th>
   <th style="text-align:right;"> SE </th>
   <th style="text-align:right;"> df </th>
   <th style="text-align:right;"> lower.CL </th>
   <th style="text-align:right;"> upper.CL </th>
   <th style="text-align:right;"> Δ change </th>
   <th style="text-align:right;"> Δ %change </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:right;"> 10 </td>
   <td style="text-align:right;"> 7.568596 </td>
   <td style="text-align:right;"> 1.137716 </td>
   <td style="text-align:right;"> 178 </td>
   <td style="text-align:right;"> 5.489949 </td>
   <td style="text-align:right;"> 9.980242 </td>
   <td style="text-align:right;"> 0.000000 </td>
   <td style="text-align:right;"> 0.0000 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 20 </td>
   <td style="text-align:right;"> 9.657817 </td>
   <td style="text-align:right;"> 1.285185 </td>
   <td style="text-align:right;"> 178 </td>
   <td style="text-align:right;"> 7.288158 </td>
   <td style="text-align:right;"> 12.360476 </td>
   <td style="text-align:right;"> 2.089221 </td>
   <td style="text-align:right;"> 127.6038 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 30 </td>
   <td style="text-align:right;"> 26.069664 </td>
   <td style="text-align:right;"> 2.111513 </td>
   <td style="text-align:right;"> 178 </td>
   <td style="text-align:right;"> 22.069344 </td>
   <td style="text-align:right;"> 30.402983 </td>
   <td style="text-align:right;"> 16.411846 </td>
   <td style="text-align:right;"> 269.9333 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 40 </td>
   <td style="text-align:right;"> 96.834193 </td>
   <td style="text-align:right;"> 4.069494 </td>
   <td style="text-align:right;"> 178 </td>
   <td style="text-align:right;"> 88.970031 </td>
   <td style="text-align:right;"> 105.031355 </td>
   <td style="text-align:right;"> 70.764530 </td>
   <td style="text-align:right;"> 371.4440 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 50 </td>
   <td style="text-align:right;"> 220.916747 </td>
   <td style="text-align:right;"> 6.146677 </td>
   <td style="text-align:right;"> 178 </td>
   <td style="text-align:right;"> 208.953512 </td>
   <td style="text-align:right;"> 233.212982 </td>
   <td style="text-align:right;"> 124.082554 </td>
   <td style="text-align:right;"> 228.1392 </td>
  </tr>
</tbody>
</table>



### Means - f(temperature)

```r
ldh.means <- ldh.sqrt.model.1.p2 %>% update(sqrt(LDH_ACTIVITY) ~ factor(temperature) * LATITUDE * LATIN_GENUS + (1|fish_id)) %>% emmeans(pairwise ~ temperature*LATIN_GENUS*LATITUDE, type = "response")

ldh.means.df <- ldh.means$emmeans %>% as.data.frame() %>% 
  mutate("change"=response - lag(response, n=1, default = first(response)), 
         "%change" = response/lag(response, n=1, default = first(response))*100) %>% 
  mutate("%change" = case_when(temperature == 10 ~ 0, 
                                     TRUE ~ `%change`), 
         "change" = case_when(temperature == 10 ~ 0, 
                                     TRUE ~ `change`)) %>% 
  rename("\u394 %change" = "%change", 
         "\u394 change" = "change")
         
ldh.means.df[10]
```

<div data-pagedtable="false">
  <script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Δ %change"],"name":[1],"type":["dbl"],"align":["right"]}],"data":[{"1":"0.0000","_rn_":"1"},{"1":"138.3296","_rn_":"2"},{"1":"315.7147","_rn_":"3"},{"1":"373.0996","_rn_":"4"},{"1":"198.6812","_rn_":"5"},{"1":"0.0000","_rn_":"6"},{"1":"113.8821","_rn_":"7"},{"1":"232.4215","_rn_":"8"},{"1":"388.9385","_rn_":"9"},{"1":"237.7025","_rn_":"10"},{"1":"0.0000","_rn_":"11"},{"1":"116.7073","_rn_":"12"},{"1":"246.1726","_rn_":"13"},{"1":"371.6589","_rn_":"14"},{"1":"251.1956","_rn_":"15"},{"1":"0.0000","_rn_":"16"},{"1":"142.2242","_rn_":"17"},{"1":"279.1479","_rn_":"18"},{"1":"354.3598","_rn_":"19"},{"1":"237.7615","_rn_":"20"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>

```r
ldh.means.df %>% knitr::kable(format = "html")  %>%
  kable_paper(full_width = TRUE) 
```

<table class=" lightable-paper" style='font-family: "Arial Narrow", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>
 <thead>
  <tr>
   <th style="text-align:right;"> temperature </th>
   <th style="text-align:left;"> LATIN_GENUS </th>
   <th style="text-align:left;"> LATITUDE </th>
   <th style="text-align:right;"> response </th>
   <th style="text-align:right;"> SE </th>
   <th style="text-align:right;"> df </th>
   <th style="text-align:right;"> lower.CL </th>
   <th style="text-align:right;"> upper.CL </th>
   <th style="text-align:right;"> Δ change </th>
   <th style="text-align:right;"> Δ %change </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:right;"> 10 </td>
   <td style="text-align:left;"> Apogon </td>
   <td style="text-align:left;"> sub-tropical </td>
   <td style="text-align:right;"> 9.084408 </td>
   <td style="text-align:right;"> 2.466609 </td>
   <td style="text-align:right;"> 178 </td>
   <td style="text-align:right;"> 4.868876 </td>
   <td style="text-align:right;"> 14.60400 </td>
   <td style="text-align:right;"> 0.000000 </td>
   <td style="text-align:right;"> 0.0000 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 20 </td>
   <td style="text-align:left;"> Apogon </td>
   <td style="text-align:left;"> sub-tropical </td>
   <td style="text-align:right;"> 12.566427 </td>
   <td style="text-align:right;"> 2.901068 </td>
   <td style="text-align:right;"> 178 </td>
   <td style="text-align:right;"> 7.493542 </td>
   <td style="text-align:right;"> 18.94337 </td>
   <td style="text-align:right;"> 3.482019 </td>
   <td style="text-align:right;"> 138.3296 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 30 </td>
   <td style="text-align:left;"> Apogon </td>
   <td style="text-align:left;"> sub-tropical </td>
   <td style="text-align:right;"> 39.674060 </td>
   <td style="text-align:right;"> 5.154724 </td>
   <td style="text-align:right;"> 178 </td>
   <td style="text-align:right;"> 30.153854 </td>
   <td style="text-align:right;"> 50.49832 </td>
   <td style="text-align:right;"> 27.107633 </td>
   <td style="text-align:right;"> 315.7147 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 40 </td>
   <td style="text-align:left;"> Apogon </td>
   <td style="text-align:left;"> sub-tropical </td>
   <td style="text-align:right;"> 148.023757 </td>
   <td style="text-align:right;"> 9.956754 </td>
   <td style="text-align:right;"> 178 </td>
   <td style="text-align:right;"> 129.027317 </td>
   <td style="text-align:right;"> 168.32425 </td>
   <td style="text-align:right;"> 108.349697 </td>
   <td style="text-align:right;"> 373.0996 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 50 </td>
   <td style="text-align:left;"> Apogon </td>
   <td style="text-align:left;"> sub-tropical </td>
   <td style="text-align:right;"> 294.095317 </td>
   <td style="text-align:right;"> 14.034473 </td>
   <td style="text-align:right;"> 178 </td>
   <td style="text-align:right;"> 267.051983 </td>
   <td style="text-align:right;"> 322.44271 </td>
   <td style="text-align:right;"> 146.071560 </td>
   <td style="text-align:right;"> 198.6812 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 10 </td>
   <td style="text-align:left;"> Pomacentrus </td>
   <td style="text-align:left;"> sub-tropical </td>
   <td style="text-align:right;"> 7.608475 </td>
   <td style="text-align:right;"> 2.559606 </td>
   <td style="text-align:right;"> 178 </td>
   <td style="text-align:right;"> 3.395719 </td>
   <td style="text-align:right;"> 13.49787 </td>
   <td style="text-align:right;"> 0.000000 </td>
   <td style="text-align:right;"> 0.0000 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 20 </td>
   <td style="text-align:left;"> Pomacentrus </td>
   <td style="text-align:left;"> sub-tropical </td>
   <td style="text-align:right;"> 8.664692 </td>
   <td style="text-align:right;"> 2.731498 </td>
   <td style="text-align:right;"> 178 </td>
   <td style="text-align:right;"> 4.112728 </td>
   <td style="text-align:right;"> 14.89330 </td>
   <td style="text-align:right;"> 1.056218 </td>
   <td style="text-align:right;"> 113.8821 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 30 </td>
   <td style="text-align:left;"> Pomacentrus </td>
   <td style="text-align:left;"> sub-tropical </td>
   <td style="text-align:right;"> 20.138605 </td>
   <td style="text-align:right;"> 4.164271 </td>
   <td style="text-align:right;"> 178 </td>
   <td style="text-align:right;"> 12.759233 </td>
   <td style="text-align:right;"> 29.19462 </td>
   <td style="text-align:right;"> 11.473913 </td>
   <td style="text-align:right;"> 232.4215 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 40 </td>
   <td style="text-align:left;"> Pomacentrus </td>
   <td style="text-align:left;"> sub-tropical </td>
   <td style="text-align:right;"> 78.326790 </td>
   <td style="text-align:right;"> 8.212577 </td>
   <td style="text-align:right;"> 178 </td>
   <td style="text-align:right;"> 62.958568 </td>
   <td style="text-align:right;"> 95.37165 </td>
   <td style="text-align:right;"> 58.188185 </td>
   <td style="text-align:right;"> 388.9385 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 50 </td>
   <td style="text-align:left;"> Pomacentrus </td>
   <td style="text-align:left;"> sub-tropical </td>
   <td style="text-align:right;"> 186.184768 </td>
   <td style="text-align:right;"> 12.661827 </td>
   <td style="text-align:right;"> 178 </td>
   <td style="text-align:right;"> 162.036482 </td>
   <td style="text-align:right;"> 212.00970 </td>
   <td style="text-align:right;"> 107.857978 </td>
   <td style="text-align:right;"> 237.7025 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 10 </td>
   <td style="text-align:left;"> Apogon </td>
   <td style="text-align:left;"> tropical </td>
   <td style="text-align:right;"> 7.013643 </td>
   <td style="text-align:right;"> 2.056104 </td>
   <td style="text-align:right;"> 178 </td>
   <td style="text-align:right;"> 3.542991 </td>
   <td style="text-align:right;"> 11.65795 </td>
   <td style="text-align:right;"> 0.000000 </td>
   <td style="text-align:right;"> 0.0000 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 20 </td>
   <td style="text-align:left;"> Apogon </td>
   <td style="text-align:left;"> tropical </td>
   <td style="text-align:right;"> 8.185437 </td>
   <td style="text-align:right;"> 2.221234 </td>
   <td style="text-align:right;"> 178 </td>
   <td style="text-align:right;"> 4.388922 </td>
   <td style="text-align:right;"> 13.15560 </td>
   <td style="text-align:right;"> 1.171793 </td>
   <td style="text-align:right;"> 116.7073 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 30 </td>
   <td style="text-align:left;"> Apogon </td>
   <td style="text-align:left;"> tropical </td>
   <td style="text-align:right;"> 20.150305 </td>
   <td style="text-align:right;"> 3.485091 </td>
   <td style="text-align:right;"> 178 </td>
   <td style="text-align:right;"> 13.859718 </td>
   <td style="text-align:right;"> 27.61454 </td>
   <td style="text-align:right;"> 11.964868 </td>
   <td style="text-align:right;"> 246.1726 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 40 </td>
   <td style="text-align:left;"> Apogon </td>
   <td style="text-align:left;"> tropical </td>
   <td style="text-align:right;"> 74.890406 </td>
   <td style="text-align:right;"> 6.718718 </td>
   <td style="text-align:right;"> 178 </td>
   <td style="text-align:right;"> 62.218641 </td>
   <td style="text-align:right;"> 88.73582 </td>
   <td style="text-align:right;"> 54.740101 </td>
   <td style="text-align:right;"> 371.6589 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 50 </td>
   <td style="text-align:left;"> Apogon </td>
   <td style="text-align:left;"> tropical </td>
   <td style="text-align:right;"> 188.121418 </td>
   <td style="text-align:right;"> 10.648598 </td>
   <td style="text-align:right;"> 178 </td>
   <td style="text-align:right;"> 167.694503 </td>
   <td style="text-align:right;"> 209.72198 </td>
   <td style="text-align:right;"> 113.231012 </td>
   <td style="text-align:right;"> 251.1956 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 10 </td>
   <td style="text-align:left;"> Pomacentrus </td>
   <td style="text-align:left;"> tropical </td>
   <td style="text-align:right;"> 6.675622 </td>
   <td style="text-align:right;"> 2.005946 </td>
   <td style="text-align:right;"> 178 </td>
   <td style="text-align:right;"> 3.303952 </td>
   <td style="text-align:right;"> 11.22094 </td>
   <td style="text-align:right;"> 0.000000 </td>
   <td style="text-align:right;"> 0.0000 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 20 </td>
   <td style="text-align:left;"> Pomacentrus </td>
   <td style="text-align:left;"> tropical </td>
   <td style="text-align:right;"> 9.494352 </td>
   <td style="text-align:right;"> 2.392247 </td>
   <td style="text-align:right;"> 178 </td>
   <td style="text-align:right;"> 5.360363 </td>
   <td style="text-align:right;"> 14.80199 </td>
   <td style="text-align:right;"> 2.818730 </td>
   <td style="text-align:right;"> 142.2242 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 30 </td>
   <td style="text-align:left;"> Pomacentrus </td>
   <td style="text-align:left;"> tropical </td>
   <td style="text-align:right;"> 26.503289 </td>
   <td style="text-align:right;"> 3.996899 </td>
   <td style="text-align:right;"> 178 </td>
   <td style="text-align:right;"> 19.202709 </td>
   <td style="text-align:right;"> 34.97752 </td>
   <td style="text-align:right;"> 17.008937 </td>
   <td style="text-align:right;"> 279.1479 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 40 </td>
   <td style="text-align:left;"> Pomacentrus </td>
   <td style="text-align:left;"> tropical </td>
   <td style="text-align:right;"> 93.917002 </td>
   <td style="text-align:right;"> 7.523942 </td>
   <td style="text-align:right;"> 178 </td>
   <td style="text-align:right;"> 79.656224 </td>
   <td style="text-align:right;"> 109.35143 </td>
   <td style="text-align:right;"> 67.413713 </td>
   <td style="text-align:right;"> 354.3598 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 50 </td>
   <td style="text-align:left;"> Pomacentrus </td>
   <td style="text-align:left;"> tropical </td>
   <td style="text-align:right;"> 223.298508 </td>
   <td style="text-align:right;"> 11.601556 </td>
   <td style="text-align:right;"> 178 </td>
   <td style="text-align:right;"> 200.991044 </td>
   <td style="text-align:right;"> 246.77962 </td>
   <td style="text-align:right;"> 129.381506 </td>
   <td style="text-align:right;"> 237.7615 </td>
  </tr>
</tbody>
</table>

### Abs. diff - f(temperature)

```r
ldh.sqrt.model.1.p2 %>% update(sqrt(LDH_ACTIVITY) ~ factor(temperature) * LATITUDE * LATIN_GENUS + (1|fish_id)) %>% emmeans(pairwise ~ temperature*LATIN_GENUS*LATITUDE, type = "response") %>% regrid() %>% pairs(by =c("LATIN_GENUS","LATITUDE")) %>% summary(infer=TRUE, type = "response")
```

<div data-pagedtable="false">
  <script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["contrast"],"name":[1],"type":["fct"],"align":["left"]},{"label":["LATIN_GENUS"],"name":[2],"type":["fct"],"align":["left"]},{"label":["LATITUDE"],"name":[3],"type":["fct"],"align":["left"]},{"label":["estimate"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["SE"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["lower.CL"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["upper.CL"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["t.ratio"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[10],"type":["dbl"],"align":["right"]}],"data":[{"1":"temperature10 - temperature20","2":"Apogon","3":"sub-tropical","4":"-3.482019","5":"2.830001","6":"178","7":"-11.281339","8":"4.3173004","9":"-1.2303949","10":"7.336496e-01","_rn_":"1"},{"1":"temperature10 - temperature30","2":"Apogon","3":"sub-tropical","4":"-30.589652","5":"4.595769","6":"178","7":"-43.255324","8":"-17.9239800","9":"-6.6560470","10":"3.355100e-09","_rn_":"2"},{"1":"temperature10 - temperature40","2":"Apogon","3":"sub-tropical","4":"-138.939349","5":"9.107239","6":"178","7":"-164.038373","8":"-113.8403257","9":"-15.2559241","10":"3.108624e-15","_rn_":"3"},{"1":"temperature10 - temperature50","2":"Apogon","3":"sub-tropical","4":"-285.010909","5":"13.101411","6":"178","7":"-321.117638","8":"-248.9041805","9":"-21.7542154","10":"3.108624e-15","_rn_":"4"},{"1":"temperature20 - temperature30","2":"Apogon","3":"sub-tropical","4":"-27.107633","5":"4.628340","6":"178","7":"-39.863069","8":"-14.3521970","9":"-5.8568806","10":"2.219516e-07","_rn_":"5"},{"1":"temperature20 - temperature40","2":"Apogon","3":"sub-tropical","4":"-135.457330","5":"9.019404","6":"178","7":"-160.314285","8":"-110.6003748","9":"-15.0184346","10":"3.108624e-15","_rn_":"6"},{"1":"temperature20 - temperature50","2":"Apogon","3":"sub-tropical","4":"-281.528890","5":"12.978740","6":"178","7":"-317.297544","8":"-245.7602356","9":"-21.6915431","10":"3.108624e-15","_rn_":"7"},{"1":"temperature30 - temperature40","2":"Apogon","3":"sub-tropical","4":"-108.349697","5":"8.896561","6":"178","7":"-132.868104","8":"-83.8312899","9":"-12.1788290","10":"5.329071e-15","_rn_":"8"},{"1":"temperature30 - temperature50","2":"Apogon","3":"sub-tropical","4":"-254.421257","5":"12.566234","6":"178","7":"-289.053071","8":"-219.7894435","9":"-20.2464200","10":"3.108624e-15","_rn_":"9"},{"1":"temperature40 - temperature50","2":"Apogon","3":"sub-tropical","4":"-146.071560","5":"13.013030","6":"178","7":"-181.934718","8":"-110.2084025","9":"-11.2250226","10":"2.420286e-14","_rn_":"10"},{"1":"temperature10 - temperature20","2":"Pomacentrus","3":"sub-tropical","4":"-1.056218","5":"2.769514","6":"178","7":"-8.688837","8":"6.5764019","9":"-0.3813729","10":"9.954765e-01","_rn_":"11"},{"1":"temperature10 - temperature30","2":"Pomacentrus","3":"sub-tropical","4":"-12.530130","5":"3.771395","6":"178","7":"-22.923877","8":"-2.1363832","9":"-3.3224123","10":"9.450385e-03","_rn_":"12"},{"1":"temperature10 - temperature40","2":"Pomacentrus","3":"sub-tropical","4":"-70.718315","5":"7.411386","6":"178","7":"-91.143666","8":"-50.2929636","9":"-9.5418471","10":"5.162537e-14","_rn_":"13"},{"1":"temperature10 - temperature50","2":"Pomacentrus","3":"sub-tropical","4":"-178.576293","5":"11.724891","6":"178","7":"-210.889412","8":"-146.2631739","9":"-15.2305295","10":"3.108624e-15","_rn_":"14"},{"1":"temperature20 - temperature30","2":"Pomacentrus","3":"sub-tropical","4":"-11.473913","5":"3.805729","6":"178","7":"-21.962281","8":"-0.9855443","9":"-3.0149054","10":"2.428662e-02","_rn_":"15"},{"1":"temperature20 - temperature40","2":"Pomacentrus","3":"sub-tropical","4":"-69.662097","5":"7.386307","6":"178","7":"-90.018331","8":"-49.3058633","9":"-9.4312486","10":"5.129230e-14","_rn_":"16"},{"1":"temperature20 - temperature50","2":"Pomacentrus","3":"sub-tropical","4":"-177.520076","5":"11.679390","6":"178","7":"-209.707798","8":"-145.3323527","9":"-15.1994301","10":"3.108624e-15","_rn_":"17"},{"1":"temperature30 - temperature40","2":"Pomacentrus","3":"sub-tropical","4":"-58.188185","5":"7.332345","6":"178","7":"-78.395702","8":"-37.9806676","9":"-7.9358224","10":"2.301048e-12","_rn_":"18"},{"1":"temperature30 - temperature50","2":"Pomacentrus","3":"sub-tropical","4":"-166.046163","5":"11.394340","6":"178","7":"-197.448303","8":"-134.6440229","9":"-14.5726885","10":"3.108624e-15","_rn_":"19"},{"1":"temperature40 - temperature50","2":"Pomacentrus","3":"sub-tropical","4":"-107.857978","5":"11.551460","6":"178","7":"-139.693131","8":"-76.0228251","9":"-9.3371732","10":"5.218048e-14","_rn_":"20"},{"1":"temperature10 - temperature20","2":"Apogon","3":"tropical","4":"-1.171794","5":"2.240171","6":"178","7":"-7.345576","8":"5.0019892","9":"-0.5230821","10":"9.849255e-01","_rn_":"21"},{"1":"temperature10 - temperature30","2":"Apogon","3":"tropical","4":"-13.136662","5":"3.142131","6":"178","7":"-21.796191","8":"-4.4771320","9":"-4.1808135","10":"4.335650e-04","_rn_":"22"},{"1":"temperature10 - temperature40","2":"Apogon","3":"tropical","4":"-67.876763","5":"6.069340","6":"178","7":"-84.603513","8":"-51.1500132","9":"-11.1835490","10":"2.486900e-14","_rn_":"23"},{"1":"temperature10 - temperature50","2":"Apogon","3":"tropical","4":"-181.107775","5":"9.887279","6":"178","7":"-208.356544","8":"-153.8590056","9":"-18.3172506","10":"3.108624e-15","_rn_":"24"},{"1":"temperature20 - temperature30","2":"Apogon","3":"tropical","4":"-11.964868","5":"3.171315","6":"178","7":"-20.704827","8":"-3.2249088","9":"-3.7728417","10":"2.026969e-03","_rn_":"25"},{"1":"temperature20 - temperature40","2":"Apogon","3":"tropical","4":"-66.704969","5":"6.044564","6":"178","7":"-83.363436","8":"-50.0465023","9":"-11.0355311","10":"2.864375e-14","_rn_":"26"},{"1":"temperature20 - temperature50","2":"Apogon","3":"tropical","4":"-179.935981","5":"9.842229","6":"178","7":"-207.060593","8":"-152.8113696","9":"-18.2820364","10":"3.108624e-15","_rn_":"27"},{"1":"temperature30 - temperature40","2":"Apogon","3":"tropical","4":"-54.740101","5":"6.003798","6":"178","7":"-71.286220","8":"-38.1939829","9":"-9.1175794","10":"5.306866e-14","_rn_":"28"},{"1":"temperature30 - temperature50","2":"Apogon","3":"tropical","4":"-167.971113","5":"9.585020","6":"178","7":"-194.386874","8":"-141.5553525","9":"-17.5243356","10":"3.108624e-15","_rn_":"29"},{"1":"temperature40 - temperature50","2":"Apogon","3":"tropical","4":"-113.231012","5":"9.676320","6":"178","7":"-139.898390","8":"-86.5636339","9":"-11.7018669","10":"1.132427e-14","_rn_":"30"},{"1":"temperature10 - temperature20","2":"Pomacentrus","3":"tropical","4":"-2.818730","5":"2.322383","6":"178","7":"-9.219083","8":"3.5816226","9":"-1.2137233","10":"7.434336e-01","_rn_":"31"},{"1":"temperature10 - temperature30","2":"Pomacentrus","3":"tropical","4":"-19.827667","5":"3.567326","6":"178","7":"-29.659011","8":"-9.9963227","9":"-5.5581312","10":"9.750792e-07","_rn_":"32"},{"1":"temperature10 - temperature40","2":"Pomacentrus","3":"tropical","4":"-87.241380","5":"6.851431","6":"178","7":"-106.123527","8":"-68.3592322","9":"-12.7333073","10":"3.552714e-15","_rn_":"33"},{"1":"temperature10 - temperature50","2":"Pomacentrus","3":"tropical","4":"-216.622886","5":"10.840130","6":"178","7":"-246.497656","8":"-186.7481153","9":"-19.9834212","10":"3.108624e-15","_rn_":"34"},{"1":"temperature20 - temperature30","2":"Pomacentrus","3":"tropical","4":"-17.008937","5":"3.608903","6":"178","7":"-26.954865","8":"-7.0630084","9":"-4.7130487","10":"4.787009e-05","_rn_":"35"},{"1":"temperature20 - temperature40","2":"Pomacentrus","3":"tropical","4":"-84.422650","5":"6.782660","6":"178","7":"-103.115267","8":"-65.7300325","9":"-12.4468355","10":"4.440892e-15","_rn_":"36"},{"1":"temperature20 - temperature50","2":"Pomacentrus","3":"tropical","4":"-213.804156","5":"10.730416","6":"178","7":"-243.376562","8":"-184.2317495","9":"-19.9250566","10":"3.108624e-15","_rn_":"37"},{"1":"temperature30 - temperature40","2":"Pomacentrus","3":"tropical","4":"-67.413713","5":"6.730855","6":"178","7":"-85.963561","8":"-48.8638652","9":"-10.0156233","10":"5.084821e-14","_rn_":"38"},{"1":"temperature30 - temperature50","2":"Pomacentrus","3":"tropical","4":"-196.795219","5":"10.416626","6":"178","7":"-225.502837","8":"-168.0876010","9":"-18.8924146","10":"3.108624e-15","_rn_":"39"},{"1":"temperature40 - temperature50","2":"Pomacentrus","3":"tropical","4":"-129.381506","5":"10.583968","6":"178","7":"-158.550309","8":"-100.2127028","9":"-12.2242908","10":"5.107026e-15","_rn_":"40"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>

### Genus comparisons

```r
ldh.sqrt.model.1.p2 %>% update(sqrt(LDH_ACTIVITY) ~ factor(temperature) * LATITUDE * LATIN_GENUS + (1|fish_id)) %>% emmeans(pairwise ~ temperature*LATIN_GENUS*LATITUDE, type = "response") %>% regrid() %>% pairs(by =c("LATIN_GENUS")) %>% summary(infer=TRUE, type = "response")
```

<div data-pagedtable="false">
  <script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["contrast"],"name":[1],"type":["fct"],"align":["left"]},{"label":["LATIN_GENUS"],"name":[2],"type":["fct"],"align":["left"]},{"label":["estimate"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["SE"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["lower.CL"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["upper.CL"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["t.ratio"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[9],"type":["dbl"],"align":["right"]}],"data":[{"1":"(temperature10 sub-tropical) - (temperature20 sub-tropical)","2":"Apogon","3":"-3.4820193","4":"2.830001","5":"178","6":"-12.5501777","7":"5.5861392","8":"-1.2303949","9":"9.665006e-01","_rn_":"1"},{"1":"(temperature10 sub-tropical) - (temperature30 sub-tropical)","2":"Apogon","3":"-30.5896522","4":"4.595769","5":"178","6":"-45.3158499","7":"-15.8634546","8":"-6.6560470","9":"1.505789e-08","_rn_":"2"},{"1":"(temperature10 sub-tropical) - (temperature40 sub-tropical)","2":"Apogon","3":"-138.9393491","4":"9.107239","5":"178","6":"-168.1216281","7":"-109.7570701","8":"-15.2559241","9":"3.108624e-15","_rn_":"3"},{"1":"(temperature10 sub-tropical) - (temperature50 sub-tropical)","2":"Apogon","3":"-285.0109093","4":"13.101411","5":"178","6":"-326.9916913","7":"-243.0301272","8":"-21.7542154","9":"3.108624e-15","_rn_":"4"},{"1":"(temperature10 sub-tropical) - temperature10 tropical","2":"Apogon","3":"2.0707644","4":"3.211188","5":"178","6":"-8.2188279","7":"12.3603567","8":"0.6448593","9":"9.997383e-01","_rn_":"5"},{"1":"(temperature10 sub-tropical) - temperature20 tropical","2":"Apogon","3":"0.8989709","4":"3.319343","5":"178","6":"-9.7371840","7":"11.5351258","8":"0.2708279","9":"9.999999e-01","_rn_":"6"},{"1":"(temperature10 sub-tropical) - temperature30 tropical","2":"Apogon","3":"-11.0658973","4":"4.269663","5":"178","6":"-24.7471560","7":"2.6153614","8":"-2.5917496","9":"2.293787e-01","_rn_":"7"},{"1":"(temperature10 sub-tropical) - temperature40 tropical","2":"Apogon","3":"-65.8059985","4":"7.157188","5":"178","6":"-88.7397373","7":"-42.8722598","8":"-9.1943935","9":"9.736656e-14","_rn_":"8"},{"1":"(temperature10 sub-tropical) - temperature50 tropical","2":"Apogon","3":"-179.0370104","4":"10.930545","5":"178","6":"-214.0616978","7":"-144.0123231","8":"-16.3795141","9":"3.108624e-15","_rn_":"9"},{"1":"(temperature20 sub-tropical) - (temperature30 sub-tropical)","2":"Apogon","3":"-27.1076329","4":"4.628340","5":"178","6":"-41.9381976","7":"-12.2770683","8":"-5.8568806","9":"9.908536e-07","_rn_":"10"},{"1":"(temperature20 sub-tropical) - (temperature40 sub-tropical)","2":"Apogon","3":"-135.4573299","4":"9.019404","5":"178","6":"-164.3581594","7":"-106.5565003","8":"-15.0184346","9":"3.108624e-15","_rn_":"11"},{"1":"(temperature20 sub-tropical) - (temperature50 sub-tropical)","2":"Apogon","3":"-281.5288900","4":"12.978740","5":"178","6":"-323.1165977","7":"-239.9411823","8":"-21.6915431","9":"3.108624e-15","_rn_":"12"},{"1":"(temperature20 sub-tropical) - temperature10 tropical","2":"Apogon","3":"5.5527836","4":"3.555807","5":"178","6":"-5.8410701","7":"16.9466374","8":"1.5616100","9":"8.645449e-01","_rn_":"13"},{"1":"(temperature20 sub-tropical) - temperature20 tropical","2":"Apogon","3":"4.3809901","4":"3.653776","5":"178","6":"-7.3267845","7":"16.0887647","8":"1.1990309","9":"9.716883e-01","_rn_":"14"},{"1":"(temperature20 sub-tropical) - temperature30 tropical","2":"Apogon","3":"-7.5838780","4":"4.534541","5":"178","6":"-22.1138826","7":"6.9461266","8":"-1.6724689","9":"8.093835e-01","_rn_":"15"},{"1":"(temperature20 sub-tropical) - temperature40 tropical","2":"Apogon","3":"-62.3239793","4":"7.318290","5":"178","6":"-85.7739381","7":"-38.8740205","8":"-8.5161942","9":"4.065637e-13","_rn_":"16"},{"1":"(temperature20 sub-tropical) - temperature50 tropical","2":"Apogon","3":"-175.5549912","4":"11.036704","5":"178","6":"-210.9198454","7":"-140.1901369","8":"-15.9064686","9":"3.108624e-15","_rn_":"17"},{"1":"(temperature30 sub-tropical) - (temperature40 sub-tropical)","2":"Apogon","3":"-108.3496969","4":"8.896561","5":"178","6":"-136.8569014","7":"-79.8424924","8":"-12.1788290","9":"7.549517e-15","_rn_":"18"},{"1":"(temperature30 sub-tropical) - (temperature50 sub-tropical)","2":"Apogon","3":"-254.4212571","4":"12.566234","5":"178","6":"-294.6871761","7":"-214.1553380","8":"-20.2464200","9":"3.108624e-15","_rn_":"19"},{"1":"(temperature30 sub-tropical) - temperature10 tropical","2":"Apogon","3":"32.6604166","4":"5.549661","5":"178","6":"14.8776656","7":"50.4431676","8":"5.8851188","9":"8.595317e-07","_rn_":"20"},{"1":"(temperature30 sub-tropical) - temperature20 tropical","2":"Apogon","3":"31.4886231","4":"5.612936","5":"178","6":"13.5031202","7":"49.4741260","8":"5.6100089","9":"3.368111e-06","_rn_":"21"},{"1":"(temperature30 sub-tropical) - temperature30 tropical","2":"Apogon","3":"19.5237549","4":"6.222301","5":"178","6":"-0.4143333","7":"39.4618432","8":"3.1377064","9":"6.038812e-02","_rn_":"22"},{"1":"(temperature30 sub-tropical) - temperature40 tropical","2":"Apogon","3":"-35.2163463","4":"8.468314","5":"178","6":"-62.3513219","7":"-8.0813708","8":"-4.1586017","9":"1.983274e-03","_rn_":"23"},{"1":"(temperature30 sub-tropical) - temperature50 tropical","2":"Apogon","3":"-148.4473582","4":"11.830631","5":"178","6":"-186.3561863","7":"-110.5385302","8":"-12.5477131","9":"4.440892e-15","_rn_":"24"},{"1":"(temperature40 sub-tropical) - (temperature50 sub-tropical)","2":"Apogon","3":"-146.0715601","4":"13.013030","5":"178","6":"-187.7691455","7":"-104.3739748","8":"-11.2250226","9":"4.507505e-14","_rn_":"25"},{"1":"(temperature40 sub-tropical) - temperature10 tropical","2":"Apogon","3":"141.0101135","4":"10.166834","5":"178","6":"108.4325800","7":"173.5876470","8":"13.8696188","9":"3.108624e-15","_rn_":"26"},{"1":"(temperature40 sub-tropical) - temperature20 tropical","2":"Apogon","3":"139.8383200","4":"10.201511","5":"178","6":"107.1496710","7":"172.5269689","8":"13.7076084","9":"3.108624e-15","_rn_":"27"},{"1":"(temperature40 sub-tropical) - temperature30 tropical","2":"Apogon","3":"127.8734518","4":"10.549067","5":"178","6":"94.0711321","7":"161.6757716","8":"12.1217786","9":"9.547918e-15","_rn_":"28"},{"1":"(temperature40 sub-tropical) - temperature40 tropical","2":"Apogon","3":"73.1333506","4":"12.011583","5":"178","6":"34.6446983","7":"111.6220028","8":"6.0885690","9":"3.046019e-07","_rn_":"29"},{"1":"(temperature40 sub-tropical) - temperature50 tropical","2":"Apogon","3":"-40.0976613","4":"14.578395","5":"178","6":"-86.8111358","7":"6.6158132","8":"-2.7504854","9":"1.621525e-01","_rn_":"30"},{"1":"(temperature50 sub-tropical) - temperature10 tropical","2":"Apogon","3":"287.0816736","4":"14.184287","5":"178","6":"241.6310356","7":"332.5323117","8":"20.2394147","9":"3.108624e-15","_rn_":"31"},{"1":"(temperature50 sub-tropical) - temperature20 tropical","2":"Apogon","3":"285.9098801","4":"14.209163","5":"178","6":"240.3795322","7":"331.4402280","8":"20.1215142","9":"3.108624e-15","_rn_":"32"},{"1":"(temperature50 sub-tropical) - temperature30 tropical","2":"Apogon","3":"273.9450120","4":"14.460716","5":"178","6":"227.6086156","7":"320.2814084","8":"18.9440838","9":"3.108624e-15","_rn_":"33"},{"1":"(temperature50 sub-tropical) - temperature40 tropical","2":"Apogon","3":"219.2049107","4":"15.559808","5":"178","6":"169.3467001","7":"269.0631213","8":"14.0878934","9":"3.108624e-15","_rn_":"34"},{"1":"(temperature50 sub-tropical) - temperature50 tropical","2":"Apogon","3":"105.9738988","4":"17.617011","5":"178","6":"49.5238013","7":"162.4239964","8":"6.0154300","9":"4.434282e-07","_rn_":"35"},{"1":"temperature10 tropical - temperature20 tropical","2":"Apogon","3":"-1.1717935","4":"2.240171","5":"178","6":"-8.3499632","7":"6.0063761","8":"-0.5230821","9":"9.999546e-01","_rn_":"36"},{"1":"temperature10 tropical - temperature30 tropical","2":"Apogon","3":"-13.1366617","4":"3.142131","5":"178","6":"-23.2049741","7":"-3.0683492","8":"-4.1808135","9":"1.820740e-03","_rn_":"37"},{"1":"temperature10 tropical - temperature40 tropical","2":"Apogon","3":"-67.8767629","4":"6.069340","5":"178","6":"-87.3247179","7":"-48.4288080","8":"-11.1835490","9":"4.662937e-14","_rn_":"38"},{"1":"temperature10 tropical - temperature50 tropical","2":"Apogon","3":"-181.1077748","4":"9.887279","5":"178","6":"-212.7895328","7":"-149.4260168","8":"-18.3172506","9":"3.108624e-15","_rn_":"39"},{"1":"temperature20 tropical - temperature30 tropical","2":"Apogon","3":"-11.9648681","4":"3.171315","5":"178","6":"-22.1266950","7":"-1.8030412","8":"-3.7728417","9":"8.156839e-03","_rn_":"40"},{"1":"temperature20 tropical - temperature40 tropical","2":"Apogon","3":"-66.7049694","4":"6.044564","5":"178","6":"-86.0735330","7":"-47.3364057","8":"-11.0355311","9":"5.395684e-14","_rn_":"41"},{"1":"temperature20 tropical - temperature50 tropical","2":"Apogon","3":"-179.9359813","4":"9.842229","5":"178","6":"-211.4733831","7":"-148.3985795","8":"-18.2820364","9":"3.108624e-15","_rn_":"42"},{"1":"temperature30 tropical - temperature40 tropical","2":"Apogon","3":"-54.7401013","4":"6.003798","5":"178","6":"-73.9780387","7":"-35.5021638","8":"-9.1175794","9":"1.072475e-13","_rn_":"43"},{"1":"temperature30 tropical - temperature50 tropical","2":"Apogon","3":"-167.9711132","4":"9.585020","5":"178","6":"-198.6843439","7":"-137.2578824","8":"-17.5243356","9":"3.108624e-15","_rn_":"44"},{"1":"temperature40 tropical - temperature50 tropical","2":"Apogon","3":"-113.2310119","4":"9.676320","5":"178","6":"-144.2367946","7":"-82.2252292","8":"-11.7018669","9":"1.931788e-14","_rn_":"45"},{"1":"(temperature10 sub-tropical) - (temperature20 sub-tropical)","2":"Pomacentrus","3":"-1.0562176","4":"2.769514","5":"178","6":"-9.9305563","7":"7.8181210","8":"-0.3813729","9":"9.999970e-01","_rn_":"46"},{"1":"(temperature10 sub-tropical) - (temperature30 sub-tropical)","2":"Pomacentrus","3":"-12.5301303","4":"3.771395","5":"178","6":"-24.6147928","7":"-0.4454678","8":"-3.3224123","9":"3.531784e-02","_rn_":"47"},{"1":"(temperature10 sub-tropical) - (temperature40 sub-tropical)","2":"Pomacentrus","3":"-70.7183150","4":"7.411386","5":"178","6":"-94.4665816","7":"-46.9700483","8":"-9.5418471","9":"1.002531e-13","_rn_":"48"},{"1":"(temperature10 sub-tropical) - (temperature50 sub-tropical)","2":"Pomacentrus","3":"-178.5762932","4":"11.724891","5":"178","6":"-216.1462992","7":"-141.0062871","8":"-15.2305295","9":"3.108624e-15","_rn_":"49"},{"1":"(temperature10 sub-tropical) - temperature10 tropical","2":"Pomacentrus","3":"0.9328526","4":"3.251984","5":"178","6":"-9.4874632","7":"11.3531684","8":"0.2868564","9":"9.999998e-01","_rn_":"50"},{"1":"(temperature10 sub-tropical) - temperature20 tropical","2":"Pomacentrus","3":"-1.8858776","4":"3.503488","5":"178","6":"-13.1120856","7":"9.3403303","8":"-0.5382858","9":"9.999422e-01","_rn_":"51"},{"1":"(temperature10 sub-tropical) - temperature30 tropical","2":"Pomacentrus","3":"-18.8948143","4":"4.746239","5":"178","6":"-34.1031637","7":"-3.6864648","8":"-3.9810076","9":"3.868077e-03","_rn_":"52"},{"1":"(temperature10 sub-tropical) - temperature40 tropical","2":"Pomacentrus","3":"-86.3085272","4":"7.947407","5":"178","6":"-111.7743631","7":"-60.8426913","8":"-10.8599602","9":"6.905587e-14","_rn_":"53"},{"1":"(temperature10 sub-tropical) - temperature50 tropical","2":"Pomacentrus","3":"-215.6900333","4":"11.880559","5":"178","6":"-253.7588460","7":"-177.6212205","8":"-18.1548727","9":"3.108624e-15","_rn_":"54"},{"1":"(temperature20 sub-tropical) - (temperature30 sub-tropical)","2":"Pomacentrus","3":"-11.4739126","4":"3.805729","5":"178","6":"-23.6685899","7":"0.7207646","8":"-3.0149054","9":"8.433516e-02","_rn_":"55"},{"1":"(temperature20 sub-tropical) - (temperature40 sub-tropical)","2":"Pomacentrus","3":"-69.6620973","4":"7.386307","5":"178","6":"-93.3300023","7":"-45.9941924","8":"-9.4312486","9":"9.992007e-14","_rn_":"56"},{"1":"(temperature20 sub-tropical) - (temperature50 sub-tropical)","2":"Pomacentrus","3":"-177.5200755","4":"11.679390","5":"178","6":"-214.9442850","7":"-140.0958661","8":"-15.1994301","9":"3.108624e-15","_rn_":"57"},{"1":"(temperature20 sub-tropical) - temperature10 tropical","2":"Pomacentrus","3":"1.9890702","4":"3.388938","5":"178","6":"-8.8700855","7":"12.8482260","8":"0.5869303","9":"9.998802e-01","_rn_":"58"},{"1":"(temperature20 sub-tropical) - temperature20 tropical","2":"Pomacentrus","3":"-0.8296600","4":"3.630968","5":"178","6":"-12.4643506","7":"10.8050306","8":"-0.2284956","9":"1.000000e+00","_rn_":"59"},{"1":"(temperature20 sub-tropical) - temperature30 tropical","2":"Pomacentrus","3":"-17.8385967","4":"4.841104","5":"178","6":"-33.3509200","7":"-2.3262733","8":"-3.6848202","9":"1.104262e-02","_rn_":"60"},{"1":"(temperature20 sub-tropical) - temperature40 tropical","2":"Pomacentrus","3":"-85.2523096","4":"8.004423","5":"178","6":"-110.9008394","7":"-59.6037798","8":"-10.6506507","9":"7.904788e-14","_rn_":"61"},{"1":"(temperature20 sub-tropical) - temperature50 tropical","2":"Pomacentrus","3":"-214.6338157","4":"11.918774","5":"178","6":"-252.8250815","7":"-176.4425498","8":"-18.0080446","9":"3.108624e-15","_rn_":"62"},{"1":"(temperature30 sub-tropical) - (temperature40 sub-tropical)","2":"Pomacentrus","3":"-58.1881847","4":"7.332345","5":"178","6":"-81.6831785","7":"-34.6931909","8":"-7.9358224","9":"1.022082e-11","_rn_":"63"},{"1":"(temperature30 sub-tropical) - (temperature50 sub-tropical)","2":"Pomacentrus","3":"-166.0461629","4":"11.394340","5":"178","6":"-202.5569863","7":"-129.5353395","8":"-14.5726885","9":"3.108624e-15","_rn_":"64"},{"1":"(temperature30 sub-tropical) - temperature10 tropical","2":"Pomacentrus","3":"13.4629829","4":"4.622226","5":"178","6":"-1.3479914","7":"28.2739572","8":"2.9126623","9":"1.097769e-01","_rn_":"65"},{"1":"(temperature30 sub-tropical) - temperature20 tropical","2":"Pomacentrus","3":"10.6442526","4":"4.802499","5":"178","6":"-4.7443705","7":"26.0328758","8":"2.2163986","9":"4.495695e-01","_rn_":"66"},{"1":"(temperature30 sub-tropical) - temperature30 tropical","2":"Pomacentrus","3":"-6.3646840","4":"5.772032","5":"178","6":"-24.8599772","7":"12.1306092","8":"-1.1026764","9":"9.839097e-01","_rn_":"67"},{"1":"(temperature30 sub-tropical) - temperature40 tropical","2":"Pomacentrus","3":"-73.7783969","4":"8.599468","5":"178","6":"-101.3336283","7":"-46.2231656","8":"-8.5794138","9":"3.045342e-13","_rn_":"68"},{"1":"(temperature30 sub-tropical) - temperature50 tropical","2":"Pomacentrus","3":"-203.1599030","4":"12.326283","5":"178","6":"-242.6569470","7":"-163.6628590","8":"-16.4818466","9":"3.108624e-15","_rn_":"69"},{"1":"(temperature40 sub-tropical) - (temperature50 sub-tropical)","2":"Pomacentrus","3":"-107.8579782","4":"11.551460","5":"178","6":"-144.8722597","7":"-70.8436967","8":"-9.3371732","9":"1.023626e-13","_rn_":"70"},{"1":"(temperature40 sub-tropical) - temperature10 tropical","2":"Pomacentrus","3":"71.6511676","4":"8.454007","5":"178","6":"44.5620355","7":"98.7402997","8":"8.4754086","9":"4.907186e-13","_rn_":"71"},{"1":"(temperature40 sub-tropical) - temperature20 tropical","2":"Pomacentrus","3":"68.8324373","4":"8.553904","5":"178","6":"41.4232082","7":"96.2416665","8":"8.0469035","9":"5.316192e-12","_rn_":"72"},{"1":"(temperature40 sub-tropical) - temperature30 tropical","2":"Pomacentrus","3":"51.8235007","4":"9.133544","5":"178","6":"22.5569329","7":"81.0900685","8":"5.6739750","9":"2.461405e-06","_rn_":"73"},{"1":"(temperature40 sub-tropical) - temperature40 tropical","2":"Pomacentrus","3":"-15.5902122","4":"11.138049","5":"178","6":"-51.2798031","7":"20.0993786","8":"-1.3997257","9":"9.259497e-01","_rn_":"74"},{"1":"(temperature40 sub-tropical) - temperature50 tropical","2":"Pomacentrus","3":"-144.9717183","4":"14.214166","5":"178","6":"-190.5180969","7":"-99.4253397","8":"-10.1991012","9":"9.481305e-14","_rn_":"75"},{"1":"(temperature50 sub-tropical) - temperature10 tropical","2":"Pomacentrus","3":"179.5091458","4":"12.819738","5":"178","6":"138.4309263","7":"220.5873653","8":"14.0025597","9":"3.108624e-15","_rn_":"76"},{"1":"(temperature50 sub-tropical) - temperature20 tropical","2":"Pomacentrus","3":"176.6904155","4":"12.885834","5":"178","6":"135.4004061","7":"217.9804250","8":"13.7119896","9":"3.108624e-15","_rn_":"77"},{"1":"(temperature50 sub-tropical) - temperature30 tropical","2":"Pomacentrus","3":"159.6814789","4":"13.277691","5":"178","6":"117.1358442","7":"202.2271135","8":"12.0262992","9":"1.110223e-14","_rn_":"78"},{"1":"(temperature50 sub-tropical) - temperature40 tropical","2":"Pomacentrus","3":"92.2677660","4":"14.728597","5":"178","6":"45.0730000","7":"139.4625319","8":"6.2645320","9":"1.219881e-07","_rn_":"79"},{"1":"(temperature50 sub-tropical) - temperature50 tropical","2":"Pomacentrus","3":"-37.1137401","4":"17.173176","5":"178","6":"-92.1416570","7":"17.9141768","8":"-2.1611460","9":"4.873955e-01","_rn_":"80"},{"1":"temperature10 tropical - temperature20 tropical","2":"Pomacentrus","3":"-2.8187303","4":"2.322383","5":"178","6":"-10.2603299","7":"4.6228694","8":"-1.2137233","9":"9.693388e-01","_rn_":"81"},{"1":"temperature10 tropical - temperature30 tropical","2":"Pomacentrus","3":"-19.8276669","4":"3.567326","5":"178","6":"-31.2584315","7":"-8.3969023","8":"-5.5581312","9":"4.335824e-06","_rn_":"82"},{"1":"temperature10 tropical - temperature40 tropical","2":"Pomacentrus","3":"-87.2413798","4":"6.851431","5":"178","6":"-109.1953854","7":"-65.2873743","8":"-12.7333073","9":"3.996803e-15","_rn_":"83"},{"1":"temperature10 tropical - temperature50 tropical","2":"Pomacentrus","3":"-216.6228859","4":"10.840130","5":"178","6":"-251.3578584","7":"-181.8879134","8":"-19.9834212","9":"3.108624e-15","_rn_":"84"},{"1":"temperature20 tropical - temperature30 tropical","2":"Pomacentrus","3":"-17.0089366","4":"3.608903","5":"178","6":"-28.5729266","7":"-5.4449467","8":"-4.7130487","9":"2.078239e-04","_rn_":"85"},{"1":"temperature20 tropical - temperature40 tropical","2":"Pomacentrus","3":"-84.4226496","4":"6.782660","5":"178","6":"-106.1562907","7":"-62.6890084","8":"-12.4468355","9":"5.773160e-15","_rn_":"86"},{"1":"temperature20 tropical - temperature50 tropical","2":"Pomacentrus","3":"-213.8041556","4":"10.730416","5":"178","6":"-248.1875733","7":"-179.4207379","8":"-19.9250566","9":"3.108624e-15","_rn_":"87"},{"1":"temperature30 tropical - temperature40 tropical","2":"Pomacentrus","3":"-67.4137129","4":"6.730855","5":"178","6":"-88.9813581","7":"-45.8460678","8":"-10.0156233","9":"9.836576e-14","_rn_":"88"},{"1":"temperature30 tropical - temperature50 tropical","2":"Pomacentrus","3":"-196.7952190","4":"10.416626","5":"178","6":"-230.1731598","7":"-163.4172782","8":"-18.8924146","9":"3.108624e-15","_rn_":"89"},{"1":"temperature40 tropical - temperature50 tropical","2":"Pomacentrus","3":"-129.3815061","4":"10.583968","5":"178","6":"-163.2956604","7":"-95.4673517","8":"-12.2242908","9":"7.105427e-15","_rn_":"90"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>

### Genus [combined]

```r
ldh.means.genus <- ldh.sqrt.model.1.p2 %>% update(LDH_ACTIVITY ~ factor(temperature) * LATITUDE * LATIN_GENUS + (1|fish_id)) %>% emmeans(pairwise ~ LATIN_GENUS, type = "response") %>% summary(infer=TRUE); ldh.means.genus
```

```
## NOTE: Results may be misleading due to involvement in interactions
```

```
## $emmeans
##  LATIN_GENUS emmean   SE  df lower.CL upper.CL t.ratio p.value
##  Apogon        81.8 3.90 178     74.1     89.5  20.994  <.0001
##  Pomacentrus   67.1 4.18 178     58.8     75.3  16.055  <.0001
## 
## Results are averaged over the levels of: temperature, LATITUDE 
## Confidence level used: 0.95 
## 
## $contrasts
##  contrast             estimate   SE  df lower.CL upper.CL t.ratio p.value
##  Apogon - Pomacentrus     14.7 5.71 178     3.43       26   2.574  0.0109
## 
## Results are averaged over the levels of: temperature, LATITUDE 
## Confidence level used: 0.95
```

### effect size [emmeans]

```r
ldh.emm <- ldh.sqrt.model.1.p2 %>% emmeans(~temperature*LATITUDE*LATIN_GENUS)
eff_size(ldh.emm, sigma = sigma(ldh.sqrt.model.1.p2), edf=df.residual(ldh.sqrt.model.1.p2))
```

```
##  contrast                                                                      
##  (temperature30 sub-tropical Apogon) - temperature30 tropical Apogon           
##  (temperature30 sub-tropical Apogon) - (temperature30 sub-tropical Pomacentrus)
##  (temperature30 sub-tropical Apogon) - temperature30 tropical Pomacentrus      
##  temperature30 tropical Apogon - (temperature30 sub-tropical Pomacentrus)      
##  temperature30 tropical Apogon - temperature30 tropical Pomacentrus            
##  (temperature30 sub-tropical Pomacentrus) - temperature30 tropical Pomacentrus 
##  effect.size    SE  df lower.CL upper.CL
##       2.1003 0.521 178    1.072    3.129
##       2.0037 0.569 178    0.882    3.126
##       1.4133 0.515 178    0.398    2.429
##      -0.0966 0.546 178   -1.174    0.981
##      -0.6870 0.497 178   -1.668    0.294
##      -0.5904 0.547 178   -1.670    0.489
## 
## sigma used for effect sizes: 0.9485 
## Confidence level used: 0.95
```

### effect size [emtrends]

```r
ldh.emm <- ldh.sqrt.model.1.p2 %>% emtrends(var = "temperature")
eff_size(ldh.emm, sigma = sigma(ldh.sqrt.model.1.p2), edf=df.residual(ldh.sqrt.model.1.p2))
```

```
##  contrast                                                                      
##  (temperature30 sub-tropical Apogon) - temperature30 tropical Apogon           
##  (temperature30 sub-tropical Apogon) - (temperature30 sub-tropical Pomacentrus)
##  (temperature30 sub-tropical Apogon) - temperature30 tropical Pomacentrus      
##  temperature30 tropical Apogon - (temperature30 sub-tropical Pomacentrus)      
##  temperature30 tropical Apogon - temperature30 tropical Pomacentrus            
##  (temperature30 sub-tropical Pomacentrus) - temperature30 tropical Pomacentrus 
##  effect.size     SE  df lower.CL upper.CL
##      0.09450 0.0154 178   0.0642  0.12483
##      0.09712 0.0167 178   0.0641  0.13017
##      0.05865 0.0149 178   0.0293  0.08797
##      0.00262 0.0156 178  -0.0281  0.03337
##     -0.03585 0.0143 178  -0.0640 -0.00769
##     -0.03847 0.0157 178  -0.0695 -0.00745
## 
## sigma used for effect sizes: 0.9485 
## Confidence level used: 0.95
```

### {-}

## Summary figure 



```r
ldh.emm <- emmeans(ldh.sqrt.model.1.p2, ~temperature|LATITUDE|LATIN_GENUS, 
                   at = list(temperature = seq(from =10, to =50, by =.1)), 
                   type = "response") 

ldh.emm.df <- ldh.emm %>% as.data.frame() %>%
  unite("species", c("LATIN_GENUS","LATITUDE"), sep = "-", remove = FALSE) 

ldh.obs <-  ldh.data %>% 
  mutate(Pred=predict(ldh.sqrt.model.1.p2, re.form=NA, type="response"),
         Resid = residuals(ldh.sqrt.model.1.p2),
         Fit = Pred + Resid) %>%
   unite("species", c("LATIN_GENUS","LATITUDE"), sep = "-", remove = FALSE) 


ldh.plot <- ggplot(ldh.emm.df, aes(y=response, x=temperature, linetype=species, color = species, fill=species))+
  geom_jitter(data=ldh.obs, 
              aes(y=Fit^2, color = species), 
              width=0.05, 
              alpha = 0.3, 
              size = 2) +
  geom_line(linewidth =1) + 
  geom_ribbon(aes(x=temperature, 
              ymin= lower.CL, ymax= upper.CL),
              alpha = 0.2, 
              color=NA)+ 
  scale_x_continuous(limits = c(9, 52), 
                     breaks = seq(10, 52, by = 10))+ 
  scale_y_continuous(limits = c(0,350), breaks = seq(0, 350, by = 50)) +
  theme_classic() + 
  ylab(expression("LDH ACTIVITY (U mg "^{-1} * "tissue)")) + 
  xlab("")+
  scale_linetype_manual(values = c("solid", "dashed","solid", "dashed"), 
                        labels = c("Apogon doederlein","Apogon rubrimacula","Pomacentrus australis", "Pomacentrus moluccensis"))+
  scale_color_manual(values=c("#3F3525","#C65C1B",  "#07AFF2", "#EAAE00"), 
                        labels = c("Apogon doederlein","Apogon rubrimacula","Pomacentrus australis", "Pomacentrus moluccensis")) +
  scale_fill_manual(values=c("#3F3525","#C65C1B",  "#07AFF2", "#EAAE00"), 
                        labels = c("Apogon doederlein","Apogon rubrimacula","Pomacentrus australis", "Pomacentrus moluccensis")) + 
  theme(legend.position = "top", 
        legend.text = element_text(size = 10), 
        legend.title = element_blank(), 
        axis.title = element_text(size =12), 
        axis.text = element_text(size=10)); ldh.plot
```

![](01.DataAnalysis_files/figure-html/ldh-sum-fig-1.png)<!-- -->

## Arrhenius plot 

```r
ldh.arrhenius.plot <- ggplot(ldh.emm.df, aes(y=log(response), x=1/(temperature+273.15), linetype=species, color = species, fill=species))+
  geom_jitter(data=ldh.obs, 
              aes(y=log(Fit^2), color = species), 
              #width=0.005, 
              alpha = 0.3, 
              size = 2) +
  stat_poly_line(method="lm", se = TRUE) + 
  stat_poly_eq(use_label(c("eq", "R2")), hjust = -1.6)+
  #geom_ribbon(aes(x=1/(temperature+273.15), 
              #ymin= log(asymp.LCL), ymax= log(asymp.UCL)),
              #alpha = 0.2, 
              #color=NA)+ 
  #scale_x_continuous(limits = c(9, 52), 
                     #breaks = seq(10, 52, by = 10))+ 
  #scale_y_continuous(limits = c(0,120), breaks = seq(0, 120, by = 20)) +
  theme_classic() + 
  ylab(expression("log(LDH (U mg "^{-1} * "tissue))")) + 
  xlab("")+
  scale_linetype_manual(values = c("solid", "dashed","solid", "dashed"), 
                        labels = c("Apogon doederlein","Apogon rubrimacula","Pomacentrus australis", "Pomacentrus moluccensis"))+
  scale_color_manual(values=c("#3F3525","#C65C1B",  "#07AFF2", "#EAAE00"), 
                        labels = c("Apogon doederlein","Apogon rubrimacula","Pomacentrus australis", "Pomacentrus moluccensis")) +
  scale_fill_manual(values=c("#3F3525","#C65C1B",  "#07AFF2", "#EAAE00"), 
                        labels = c("Apogon doederlein","Apogon rubrimacula","Pomacentrus australis", "Pomacentrus moluccensis")) + 
  theme(legend.position = "top", 
        legend.text = element_text(size = 10), 
        legend.title = element_blank(), 
        axis.title = element_text(size =12), 
        axis.text = element_text(size=10)); ldh.arrhenius.plot
```

![](01.DataAnalysis_files/figure-html/ldh-arrhenius plot-1.png)<!-- -->

# Citrate synthase (CS)

## Load data 



```r
cs <- cs.import.data
```

## Data manipulation

```r
#--- data preparation/manipulation ---# 
cs2 <- cs |>
  clean_names() |>
  separate(sample, into=c('tissue_type','species','replicate','temperature'), sep = "_", remove = FALSE) |>  
  separate(creation_time, into=c('DATE','TIME'), sep = " ", remove = FALSE) |>
  arrange(sample_id_1, DATE, TIME) 

cs3 <- cs2 |> 
  mutate(TIME = hms(cs2$TIME)) |>
  mutate(TIME = chron(times=cs2$TIME)) |>
  arrange(TIME) |>
  dplyr::group_by(sample, sample_id_1) |> 
  dplyr::mutate(TIME_DIFF = TIME - first(TIME)) |> 
  dplyr::filter(TIME != first(TIME)) |>
  dplyr::ungroup() |> 
  mutate(TIME_DIFF_SECS = period_to_seconds(hms(TIME_DIFF))) |> 
  mutate(MINUTES = TIME_DIFF_SECS/60) |> 
  mutate(MINUTES = round(MINUTES, digits = 2)) |> 
  dplyr::rename(CUVETTE = sample_id_1) |> 
  mutate(LATIN_NAME = case_when( species =="Adoed"~ "Apogon doederlein", 
                             species == "Arub" ~ "Apogon rubrimacula", 
                             species == "Paus" ~ "Pomacentrus australis",
                             species == "Pmol" ~ "Pomacentrus moluccensis",
                             TRUE ~ "na")) |> 
  unite("UNIQUE_SAMPLE_ID", c(species, replicate, temperature, sample_index), sep="_", remove = FALSE)
```

### Data cleaning 

Next select data points will be removed. Data points have been checked using previously written app script that allows the user to look at the plotted points of samples that were run. Because we are interested in the slope, points that plateaued were removed from the analysis, as it signifies that the reaction ran out of 'fuel' to use.

Note that later on the first data point will be removed from all samples. For example, if a run requires that the first 4 data points be removed, 3 will be removed below and then one will be removed at a later step. 


* **grp2**: removed first 2 data points which was causing a plateau
* **grp3**: removed first 3 data points which was causing a plateau
* **grp4**: removed first 4 data points which was causing a plateau
* **grp5**: removed first 5 data points which was causing a plateau


```r
grp1 <- c("Arub_04_30_3","Paus_02_30_2","Pmol_01_20_3","Pmol_03_30_1","Pmol_03_30_3", 
          "Paus_08_10_2", "Paus_10_40_1", "Pmol_07_20_2","Pmol_09_10_1","Arub_06_30_3",
          "Pmol_10_20_1") 
grp2 <- c("Arub_04_30_3","Paus_02_30_1","Pmol_06_30_1","Pmol_10_10_1","Pmol_10_10_2", 
          "Pmol_03_20_2","Pmol_05_30_3","Adoed_09_20_3","Pmol_09_30_3")
grp3 <- c("Adoed_03_20_3","Pmol_03_30_2","Pmol_03_10_3","Pmol_03_10_1","Pmol_03_30_2") 
grp4 <- c("Arub_04_30_2","Arub_06_30_1","Adoed_05_20_2","Pmol_02_30_3","Pmol_03_10_1","Pmol_03_10_1", 
          "Arub_06_30_1", "Adoed_05_20_2") 
grp5 <- c("Pmol_01_20_2")  
grp6 <- c("Arub_06_30_2","Pmol_02_30_1","Pmol_09_20_1","Arub_06_30_2") 
grp7 <- c("Arub_04_30_1","Pmol_03_10_2","Pmol_03_10_2","Pmol04_20_1") 
grp8 <- c("Pmol_02_30_2","Pmol_09_20_3","Pmol_06_20_2") 
grp9 <- c("Adoed_03_20_2","Pmol_03_40_3","Pmol_04_20_3") 
grp10 <- c() 
grp11 <- c("Pmol_04_20_1","Pmol_09_20_2","Pmol_04_20_5") 
data.grp1 <- c("Pmol_01_10_2") 
data.grp2 <- c("Pmol_05_20_3")
data.grp3 <- c("Pmol_07_20_3","Pmol_10_10_1")
data.grp4 <- c("Pmol_07_10_1") 
data.grp7 <- c("Pmol_05_30_3")
data.grp8 <- c("Adoed_05_50_5")
```



```r
cs3.filtered <- cs3 |> 
  filter(!(UNIQUE_SAMPLE_ID %in% c(
                                   #--- Apogon rubrimacula ---#
                                   "Arub_02_10_1", "Arub_02_10_2", "Arub_02_10_3", # control slope steep 
                                   "Arub_02_20_1", "Arub_02_20_2", "Arub_02_20_3", # slopes messy
                                   "Arub_03_50_1", "Arub_03_50_2", "Arub_03_50_3", # control slope steep 
                                   "Arub_04_10_1", "Arub_04_10_2", "Arub_04_10_3", # slopes messy
                                   "Arub_04_20_1", "Arub_04_20_2", "Arub_04_20_3", # slopes are all negative
                                   "Arub_05_30_1", "Arub_05_30_2", "Arub_05_30_3", # control slope steep 
                                   "Arub_06_20_1", "Arub_06_20_2", "Arub_06_20_3", # slopes all negative
                                   "Arub_10_30_3", 
                                   "Arub_01_50_1", "Arub_01_50_2", "Arub_01_50_3", # slopes look fine but are much shallower 
                                                                                   # than all other samples
                                   
                                   #--- Apogon doederlein ---# 
                                   "Adoed_09_10_1", 
                                   "Adoed_08_10_1", "Adoed_08_20_3", "Adoed_08_30_1", 
                                   "Adoed_06_10_1",
                                   
                                   #--- Pomacentrus australia ---#
                                   "Paus_02_10_2",  
                                   "Paus_02_20_1", "Paus_02_20_2", "Paus_02_20_3", 
                                   
                                   #--- Pomacentrus moluccensis  
                                   "Pmol_02_20_1", "Pmol_02_20_2", "Pmol_02_20_3", 
                                   "Pmol_03_20_1", "Pmol_03_20_3", "Pmol_03_10_2",
                                   "Pmol_04_20_2", 
                                   "Pmol_05_20_1", "Pmol_05_20_2",
                                   "Pmol_06_50_3",
                                   "Pmol_06_20_2", 
                                   "Pmol_04_10_2"
                                   ))) |>
  dplyr::group_by(UNIQUE_SAMPLE_ID) |> 
  dplyr::arrange(UNIQUE_SAMPLE_ID, TIME) |>
  dplyr::filter(!(UNIQUE_SAMPLE_ID %in% grp1 & row_number() <= 1)) |> 
  dplyr::filter(!(UNIQUE_SAMPLE_ID %in% grp2 & row_number() <= 2)) |> 
  dplyr::filter(!(UNIQUE_SAMPLE_ID %in% grp3 & row_number() <= 3)) |> 
  dplyr::filter(!(UNIQUE_SAMPLE_ID %in% grp4 & row_number() <= 4)) |> 
  dplyr::filter(!(UNIQUE_SAMPLE_ID %in% grp5 & row_number() <= 5)) |>
  dplyr::filter(!(UNIQUE_SAMPLE_ID %in% grp6 & row_number() <= 6)) |>
  dplyr::filter(!(UNIQUE_SAMPLE_ID %in% grp7 & row_number() <= 7)) |>
  dplyr::filter(!(UNIQUE_SAMPLE_ID %in% grp8 & row_number() <= 8)) |>
  dplyr::filter(!(UNIQUE_SAMPLE_ID %in% grp9 & row_number() <= 9)) |>
  dplyr::filter(!(UNIQUE_SAMPLE_ID %in% grp10 & row_number() <= 10)) |>
  dplyr::filter(!(UNIQUE_SAMPLE_ID %in% grp11 & row_number() <= 11)) |> 
  dplyr::filter(!(UNIQUE_SAMPLE_ID %in% data.grp1 & row_number() == 4)) |>
  dplyr::filter(!(UNIQUE_SAMPLE_ID %in% data.grp2 & between(row_number(), 7, 10))) |>
  dplyr::filter(!(UNIQUE_SAMPLE_ID %in% data.grp3 & row_number() == 4 )) |>
  dplyr::filter(!(UNIQUE_SAMPLE_ID %in% data.grp4 & row_number() == 10 )) |>
  dplyr::filter(!(UNIQUE_SAMPLE_ID %in% data.grp7 & between(row_number(), 9, 13))) |>
  dplyr::filter(!(UNIQUE_SAMPLE_ID %in% data.grp8 & between(row_number(), 15, 20))) |>
  dplyr::ungroup() |> 
  mutate(UNIQUE_SAMPLE_ID = str_sub(UNIQUE_SAMPLE_ID, end = -3))
```

Great! Now we have all the data points that we want to keep. However, the data needs to manipulated in a way that we can obtain and pull out slopes from the absorption readings, and the calculate enzyme activity based on these slopes. This will involve a number of steps.  

### Data calculations 

#### Step1: Extract slopes 

Step1 will produce a data frame that provides you with the slope that was obtained for cuvettes 1-3 for each sample run at each experimental temperature. Note that at the end of this step we are removing slopes that were positive in value, as LDH slopes should produce a negative slope, due to NADH being used up. 

```r
CS_activity <- cs3.filtered %>% 
  group_by(UNIQUE_SAMPLE_ID, CUVETTE) %>% 
  do({
    mod = lm(result ~ MINUTES, data = .)
    data.frame(Intercept = coef(mod)[1],
               Slope = coef(mod)[2], 
               r2 = summary(mod)$adj.r.squared)
  }) %>%
  ungroup() %>%
  filter(CUVETTE != ("6"))%>% 
  filter(CUVETTE != ("4"))%>% 
  filter(CUVETTE != ("5")) %>% 
  filter(Slope >= 0)
```

#### Step2: Slope means

Step2 will calculate the mean slope for cuvette 1-3. 

```r
CS_activity_means <- CS_activity %>% 
  group_by(UNIQUE_SAMPLE_ID) %>% 
  mutate(Mean = mean(Slope)) %>% 
  ungroup()
```

#### Step3: Background activity level

Step3 will calculate background activity level by measuring the slope from cuvette 5 (postive control)

```r
CS_background <- cs3.filtered %>% 
  group_by(UNIQUE_SAMPLE_ID, CUVETTE) %>% 
  do({
    mod = lm(result ~ MINUTES, data = .)
    data.frame(Intercept = coef(mod)[1],
               Slope = coef(mod)[2], 
               r2 = summary(mod)$adj.r.squared)
  }) %>%
  ungroup() %>%
  filter(CUVETTE == ("5")) %>% 
  dplyr::rename(Background = Slope)  
```

#### Step4: Merging dataframes

Step4 will merge the data frames that you created with the mean slopes and the background slopes.

```r
cs_final_table <- CS_activity %>% 
  full_join(distinct(CS_activity_means[,c(1,6)]), by = "UNIQUE_SAMPLE_ID") %>%
  full_join(CS_background[,c(1,4)], by = "UNIQUE_SAMPLE_ID") 
cs_final_table$Mean[duplicated(cs_final_table$Mean)] <- ""
cs_final_table$Background[duplicated(cs_final_table$Background)] <- ""
cs_final_table <- cs_final_table %>% 
  mutate(Mean = as.numeric(Mean), 
         Background = as.numeric(Background), 
         Background_perc = Background/Mean) %>% 
  drop_na(Mean) %>% 
  mutate(Background_perc = case_when(UNIQUE_SAMPLE_ID == "Adoed_03_40" ~ 0.0000, # ignore blank - QC
                                     UNIQUE_SAMPLE_ID == "Pmol_07_30" ~ 0.0000, 
                                     UNIQUE_SAMPLE_ID == "Arub_03_50" ~ 0.0000, 
                                     UNIQUE_SAMPLE_ID == "Paus_07_10" ~ 0.0000,
                                     UNIQUE_SAMPLE_ID == "Paus_02_10" ~ 0.0000,
                                     UNIQUE_SAMPLE_ID == "Adoed_06_10" ~ 0.0000,
                                     TRUE ~ Background_perc))
```

#### Step5: Enzyme activity levels 

Step5 is where enzyme activity levels are calculated. See further details in manuscript (doi: xxx). Within this step background activity level is taken into account and subtracted from slopes where background activity was >5% or more of the sample slope. 

```r
CS.data <- cs_final_table %>% 
  select(c(UNIQUE_SAMPLE_ID, Mean, Background, Background_perc)) %>% 
  mutate(Mean = as.numeric(Mean), 
         Background = as.numeric(Background), 
         Background_perc = as.numeric(Background_perc)) %>% 
  mutate(Background2 = case_when(Background_perc <= 0.05 ~ 0, 
                                 TRUE ~ Background), 
         CS_ABSORBANCE = Mean - Background2) %>%
  inner_join(select(cs3.filtered, c(UNIQUE_SAMPLE_ID, species, replicate, temperature, LATIN_NAME)), by ="UNIQUE_SAMPLE_ID") %>% 
  unite("fish_id", c(species,replicate), sep = "_", remove = FALSE) %>%
  inner_join(tissue.mass, by = "fish_id") %>% 
  mutate(TISSUE_MASS_CENTERED = scale(tissue_mass, center = TRUE, scale = FALSE)) %>%
  distinct(UNIQUE_SAMPLE_ID, .keep_all = TRUE) %>% 
  mutate(PATH_LENGTH = 1, 
         EXTINCTION_COEFFICIENT = 13.6, 
         TISSUE_CONCENTRATION = 0.01, 
         ASSAY_VOL = 0.930, 
         SAMPLE_VOL = 0.020, 
         CS_ACTIVITY = ((CS_ABSORBANCE/(PATH_LENGTH*EXTINCTION_COEFFICIENT*TISSUE_CONCENTRATION))*(ASSAY_VOL/SAMPLE_VOL)))   %>% 
  separate(LATIN_NAME, c("LATIN_GENUS","LATIN_SPECIES"), sep = " ", remove = FALSE) %>% 
  mutate(LATIN_GENUS = factor(LATIN_GENUS), 
         LATIN_SPECIES = factor(LATIN_SPECIES)) %>% 
  mutate(LATITUDE = factor(case_when(species =="Adoed"~ "sub-tropical", 
                             species == "Arub" ~ "tropical", 
                             species == "Paus" ~ "sub-tropical",
                             species == "Pmol" ~ "tropical",
                             TRUE ~ "na")), 
         temperature = as.numeric(temperature)) %>% 
  drop_na() %>% filter(CS_ACTIVITY >=0)
```




## Initial plot {.tabset}

### CS v TEMPERATURE [SPECIES]


```r
ggplot(CS.data, aes(x =temperature, y= CS_ACTIVITY, color = species)) + 
  geom_point() + 
  stat_smooth(method = "lm", se=FALSE) + 
  theme_classic() 
```

![](01.DataAnalysis_files/figure-html/cs-initial-plots-1.png)<!-- -->

### CS [distribution]

```r
ggplot(CS.data, aes(x = CS_ACTIVITY, fill = temperature, color = temperature)) + 
  geom_density(alpha =0.5, position = "identity") 
```

![](01.DataAnalysis_files/figure-html/cs-initial-plots-2-1.png)<!-- -->

```r
ggplot(CS.data, aes(x=CS_ACTIVITY)) + geom_histogram()
```

![](01.DataAnalysis_files/figure-html/cs-initial-plots-2-2.png)<!-- -->

### CS v TEMPERATURE [LATITUDE]

```r
ggplot(CS.data, aes(x =temperature, y= CS_ACTIVITY, colour = LATITUDE, fill=LATITUDE)) +   geom_point(alpha=0.3) + stat_smooth(method = "lm", se=TRUE,  formula=y ~ poly(x, 2, raw=TRUE), alpha=0.3) + facet_grid(~LATIN_GENUS) + theme_classic()
```

![](01.DataAnalysis_files/figure-html/cs-initial-plots-3-1.png)<!-- -->

### CS v TEMPERATURE [GENUS]

```r
ggplot(CS.data, aes(x =temperature, y= CS_ACTIVITY, colour = LATIN_GENUS, fill=LATIN_GENUS)) +   geom_point(alpha=0.3) + stat_smooth(method = "lm", se=TRUE,  formula=y ~ poly(x, 2, raw=TRUE), alpha=0.3) + facet_grid(~LATITUDE) + theme_classic()
```

![](01.DataAnalysis_files/figure-html/cs-initial-plots-4-1.png)<!-- -->

### CS v TEMPERATURE [SPECIES]

```r
ggplot(CS.data, aes(x =temperature, y= CS_ACTIVITY, colour = species, fill= species)) +   geom_point(alpha=0.3) + stat_smooth(method = "lm", se=TRUE,  formula=y ~ poly(x, 2, raw=TRUE), alpha=0.3) + theme_classic()
```

![](01.DataAnalysis_files/figure-html/cs-initial-plots-5-1.png)<!-- -->

### {-} 

## Fit the model 

The model was fit using the **glm** and later **glmmTMB** package in R. A number of different models were tested to determine which hypothesis and associated variables best predicted resting oxygen consumption. Model fit was examined using AICc, BIC, and r-squared values. Additional model were examined via the validation diagnostics provided by the **performance** and **dHARMA** packages in R.

From out initial plots we can see that our data is heavily skewed to the right. From our initial plots we can all see that the relationship between enzyme activity and temperature is no linear, but rather may represent either a quadratic or cubic relationship. Let's start out model selection process by comparing different polynomial models.  

### polynomial models

```r
#--- model 1 ---# 
cs.model.1 <- glm(CS_ACTIVITY ~ temperature * LATITUDE * LATIN_GENUS, 
               family = gaussian(),
               data = CS.data) 

cs.model.1.p2 <- glm(CS_ACTIVITY ~ poly(temperature, 2) * LATITUDE * LATIN_GENUS, 
               family = gaussian(),
               data = CS.data)  

cs.model.1.p3 <- glm(CS_ACTIVITY ~ poly(temperature, 3) * LATITUDE * LATIN_GENUS, 
               family = gaussian(),
               data = CS.data) 
```

#### model comparisons - polynomial models 

```r
aic.c=AICc(cs.model.1, cs.model.1.p2, cs.model.1.p3, k=2) 
bic=BIC(cs.model.1, cs.model.1.p2, cs.model.1.p3)

model.fit.table <- as.data.frame(aic.c) %>% 
  tibble::rownames_to_column("model") %>%
  mutate(BIC = bic$BIC, 
         r2 = c(r.squaredLR(cs.model.1)[1], r.squaredLR(cs.model.1.p2)[1], r.squaredLR(cs.model.1.p3)[1]))
model.fit.table %>% knitr::kable(format = "html")  %>%
  kable_paper(full_width = TRUE) 
```

<table class=" lightable-paper" style='font-family: "Arial Narrow", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>
 <thead>
  <tr>
   <th style="text-align:left;"> model </th>
   <th style="text-align:right;"> df </th>
   <th style="text-align:right;"> AICc </th>
   <th style="text-align:right;"> BIC </th>
   <th style="text-align:right;"> r2 </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> cs.model.1 </td>
   <td style="text-align:right;"> 9 </td>
   <td style="text-align:right;"> 700.9233 </td>
   <td style="text-align:right;"> 728.4879 </td>
   <td style="text-align:right;"> 0.7428450 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> cs.model.1.p2 </td>
   <td style="text-align:right;"> 13 </td>
   <td style="text-align:right;"> 692.0394 </td>
   <td style="text-align:right;"> 731.1831 </td>
   <td style="text-align:right;"> 0.7676196 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> cs.model.1.p3 </td>
   <td style="text-align:right;"> 17 </td>
   <td style="text-align:right;"> 701.5231 </td>
   <td style="text-align:right;"> 751.7884 </td>
   <td style="text-align:right;"> 0.7677787 </td>
  </tr>
</tbody>
</table>

```r
anova(cs.model.1, cs.model.1.p2, cs.model.1.p3, test = "Chisq")
```

<div data-pagedtable="false">
  <script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Resid. Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Resid. Dev"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Deviance"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chi)"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"170","2":"480.3596","3":"NA","4":"NA","5":"NA","_rn_":"1"},{"1":"166","2":"434.0813","3":"4","4":"46.2783528","5":"0.001702898","_rn_":"2"},{"1":"162","2":"433.7842","3":"4","4":"0.2970716","5":"0.998517171","_rn_":"3"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>

Looks like the model where temperature is treated as a second order polynomial (quadratic model) is better than the and third order polynomial model. Lets see if adding the variable **tissue.mass** improves the model. 

### fixed factor comparisons

```r
#--- model 1 ---# 
cs.model.1.p2 <- glm(CS_ACTIVITY ~ poly(temperature, 2) * LATITUDE * LATIN_GENUS, 
               family = gaussian(),
               data = CS.data)  

cs.model.1.p2b <- cs.model.1 %>% update(. ~ poly(temperature, 2) * LATITUDE * LATIN_GENUS + TISSUE_MASS_CENTERED) 
```

#### model comparisons - fixed factor comparisons 

```r
aic.c=AICc(cs.model.1.p2, cs.model.1.p2b, k=2) 
bic=BIC(cs.model.1.p2, cs.model.1.p2b)

model.fit.table <- as.data.frame(aic.c) %>% 
  tibble::rownames_to_column("model") %>%
  mutate(BIC = bic$BIC, 
         r2 = c(r.squaredLR(cs.model.1.p2)[1], r.squaredLR(cs.model.1.p2b)[1]))
model.fit.table %>% knitr::kable(format = "html")  %>%
  kable_paper(full_width = TRUE) 
```

<table class=" lightable-paper" style='font-family: "Arial Narrow", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>
 <thead>
  <tr>
   <th style="text-align:left;"> model </th>
   <th style="text-align:right;"> df </th>
   <th style="text-align:right;"> AICc </th>
   <th style="text-align:right;"> BIC </th>
   <th style="text-align:right;"> r2 </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> cs.model.1.p2 </td>
   <td style="text-align:right;"> 13 </td>
   <td style="text-align:right;"> 692.0394 </td>
   <td style="text-align:right;"> 731.1831 </td>
   <td style="text-align:right;"> 0.7676196 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> cs.model.1.p2b </td>
   <td style="text-align:right;"> 14 </td>
   <td style="text-align:right;"> 693.8526 </td>
   <td style="text-align:right;"> 735.8209 </td>
   <td style="text-align:right;"> 0.7683287 </td>
  </tr>
</tbody>
</table>

```r
anova(cs.model.1.p2, cs.model.1.p2b, test = "Chisq")
```

<div data-pagedtable="false">
  <script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Resid. Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Resid. Dev"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Deviance"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chi)"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"166","2":"434.0813","3":"NA","4":"NA","5":"NA","_rn_":"1"},{"1":"165","2":"432.7568","3":"1","4":"1.324541","5":"0.4773042","_rn_":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>

The variable **TISSUE_MASS_CENTERED does not** improve the model nor is there any significant difference the models, therefore it will be left out of the model moving forward. 

Lastly, because tissue samples from the same fish were tested at multiple temperatures we need to include **fish_id** as a random factor. 

### Generalised linear mixed model (GLMM)

```r
cs.model.1.p2 <- glmmTMB(CS_ACTIVITY ~ poly(temperature, 2) * LATITUDE * LATIN_GENUS + (1|fish_id), 
               family = gaussian(),
               REML = TRUE,
               data = CS.data) 
```

Great! Now lets check our model validations to see how the model is performing. 

## Model validation {.tabset}

### cs.model.1 [performance]


```r
cs.model.1.p2 %>% check_model(detrend = FALSE)
```

![](01.DataAnalysis_files/figure-html/cs-model-validatiaon-1-1.png)<!-- -->

### cs.model.1 [DHARMa]


```r
cs.model.1.p2 %>% simulateResiduals(plot=TRUE)
```

![](01.DataAnalysis_files/figure-html/cs-model-validatiaon-2-1.png)<!-- -->

```
Object of Class DHARMa with simulated residuals based on 250 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. 
 
Scaled residual values: 0.472 0.376 0.468 0.444 0.384 0.324 0.18 0.116 0.012 0.384 0.304 0.284 0.224 0.136 0.728 0.688 0.9 0.972 0.452 0.336 ...
```

```r
cs.model.1.p2 %>% DHARMa::testResiduals(plot=TRUE)
```

![](01.DataAnalysis_files/figure-html/cs-model-validatiaon-2-2.png)<!-- -->

```
$uniformity

	Asymptotic one-sample Kolmogorov-Smirnov test

data:  simulationOutput$scaledResiduals
D = 0.10769, p-value = 0.03222
alternative hypothesis: two-sided


$dispersion

	DHARMa nonparametric dispersion test via sd of residuals fitted vs.
	simulated

data:  simulationOutput
dispersion = 0.91225, p-value = 0.616
alternative hypothesis: two.sided


$outliers

	DHARMa outlier test based on exact binomial test with approximate
	expectations

data:  simulationOutput
outliers at both margin(s) = 1, observations = 178, p-value = 1
alternative hypothesis: true probability of success is not equal to 0.007968127
95 percent confidence interval:
 0.0001422248 0.0309023480
sample estimates:
frequency of outliers (expected: 0.00796812749003984 ) 
                                           0.005617978 
```

```
$uniformity

	Asymptotic one-sample Kolmogorov-Smirnov test

data:  simulationOutput$scaledResiduals
D = 0.10769, p-value = 0.03222
alternative hypothesis: two-sided


$dispersion

	DHARMa nonparametric dispersion test via sd of residuals fitted vs.
	simulated

data:  simulationOutput
dispersion = 0.91225, p-value = 0.616
alternative hypothesis: two.sided


$outliers

	DHARMa outlier test based on exact binomial test with approximate
	expectations

data:  simulationOutput
outliers at both margin(s) = 1, observations = 178, p-value = 1
alternative hypothesis: true probability of success is not equal to 0.007968127
95 percent confidence interval:
 0.0001422248 0.0309023480
sample estimates:
frequency of outliers (expected: 0.00796812749003984 ) 
                                           0.005617978 
```

### cs.model.1 [plot model]

```r
par(mar=c(2,2,2,2))
cs.model.1.p2 %>% plot_model(type = "diag")
```

```
[[1]]
```

```

[[2]]
[[2]]$fish_id
```

```


[[3]]
```

```

[[4]]
```


<img src="01.DataAnalysis_files/figure-html/cs-model-validatiaon-3-1.png" width="50%" /><img src="01.DataAnalysis_files/figure-html/cs-model-validatiaon-3-2.png" width="50%" /><img src="01.DataAnalysis_files/figure-html/cs-model-validatiaon-3-3.png" width="50%" /><img src="01.DataAnalysis_files/figure-html/cs-model-validatiaon-3-4.png" width="50%" />

Issues that come up with the model are the KS test provided by the DHARMa checks and we also see some of the lower values drop off on the qq-plot provided by the 'check_model' function. Let's see if we can fix some of this issues by changing the link function within our distributions. 

### {-}

## Re-fitting model 

Turn **REML** off when comparing models

### re-fitting models [link functions]


```r
cs.model.1.p2 <-  cs.model.1.p2 %>% update(REML = FALSE)
cs.model.1.p2.log <- cs.model.1.p2 %>% update(family=gaussian(link="log"), 
                                              REML=FALSE) 
cs.model.1.p2.sqrt <- cs.model.1.p2 %>% update(family=gaussian(link="sqrt"), 
                                               REML=FALSE) 
```

### re-fit model comparisons [link function]


```r
aic.c=AICc(cs.model.1.p2, cs.model.1.p2.log, cs.model.1.p2.sqrt,  k=2) 
bic=BIC(cs.model.1.p2, cs.model.1.p2.log, cs.model.1.p2.sqrt)

model.fit.table <- as.data.frame(aic.c) %>% 
  tibble::rownames_to_column("model") %>%
  mutate(BIC = bic$BIC, 
         r2 = c(r.squaredGLMM(cs.model.1.p2)[1], r.squaredGLMM(cs.model.1.p2.log)[1], r.squaredGLMM(cs.model.1.p2.sqrt)[1]))
model.fit.table %>% knitr::kable(format = "html")  %>%
  kable_paper(full_width = TRUE) 
```

<table class=" lightable-paper" style='font-family: "Arial Narrow", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>
 <thead>
  <tr>
   <th style="text-align:left;"> model </th>
   <th style="text-align:right;"> df </th>
   <th style="text-align:right;"> AICc </th>
   <th style="text-align:right;"> BIC </th>
   <th style="text-align:right;"> r2 </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> cs.model.1.p2 </td>
   <td style="text-align:right;"> 14 </td>
   <td style="text-align:right;"> 602.0236 </td>
   <td style="text-align:right;"> 643.9919 </td>
   <td style="text-align:right;"> 0.7716550 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> cs.model.1.p2.log </td>
   <td style="text-align:right;"> 14 </td>
   <td style="text-align:right;"> 389.3024 </td>
   <td style="text-align:right;"> 431.2707 </td>
   <td style="text-align:right;"> 0.6668260 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> cs.model.1.p2.sqrt </td>
   <td style="text-align:right;"> 14 </td>
   <td style="text-align:right;"> 446.4969 </td>
   <td style="text-align:right;"> 488.4652 </td>
   <td style="text-align:right;"> 0.5671397 </td>
  </tr>
</tbody>
</table>

```r
anova(cs.model.1.p2, cs.model.1.p2.log, cs.model.1.p2.sqrt, test = "Chisq")
```

<div data-pagedtable="false">
  <script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["BIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["logLik"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["deviance"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Chisq"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["Chi Df"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chisq)"],"name":[8],"type":["dbl"],"align":["right"]}],"data":[{"1":"14","2":"599.4469","3":"643.9919","4":"-285.7235","5":"571.4469","6":"NA","7":"NA","8":"NA","_rn_":"cs.model.1.p2"},{"1":"14","2":"386.7257","3":"431.2707","4":"-179.3629","5":"358.7257","6":"212.7212","7":"0","8":"0","_rn_":"cs.model.1.p2.log"},{"1":"14","2":"443.9202","3":"488.4652","4":"-207.9601","5":"415.9202","6":"0.0000","7":"0","8":"1","_rn_":"cs.model.1.p2.sqrt"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>

From this model comparison it looks like the model that uses the **log** link function helps improve our model. Lets see how the model validation looks. We will run the model one more time with **REML=TRUE** before looking at model validation outputs. 


```r
cs.model.1.p2.log <- cs.model.1.p2.log %>% update(REML = TRUE)
```

## Model re-validation {.tabset}

### cs.model.1.p2.log [performance]


```r
cs.model.1.p2.log %>% check_model(detrend=FALSE)
```

![](01.DataAnalysis_files/figure-html/cs-model-re-validatiaon-1-1.png)<!-- -->

### cs.model.1.p2.log [DHARMa]


```r
cs.model.1.p2.log %>% simulateResiduals(plot=TRUE)
```

![](01.DataAnalysis_files/figure-html/cs-model-re-validatiaon-2-1.png)<!-- -->

```
## Object of Class DHARMa with simulated residuals based on 250 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. 
##  
## Scaled residual values: 0.576 0.376 0.564 0.52 0.184 0.136 0.068 0.04 0.008 0.184 0.144 0.216 0.216 0.22 0.908 0.788 0.924 0.94 0.34 0.152 ...
```

```r
cs.model.1.p2.log %>% DHARMa::testResiduals(plot=TRUE)
```

![](01.DataAnalysis_files/figure-html/cs-model-re-validatiaon-2-2.png)<!-- -->

```
## $uniformity
## 
## 	Asymptotic one-sample Kolmogorov-Smirnov test
## 
## data:  simulationOutput$scaledResiduals
## D = 0.056494, p-value = 0.6209
## alternative hypothesis: two-sided
## 
## 
## $dispersion
## 
## 	DHARMa nonparametric dispersion test via sd of residuals fitted vs.
## 	simulated
## 
## data:  simulationOutput
## dispersion = 0.62173, p-value = 0.216
## alternative hypothesis: two.sided
## 
## 
## $outliers
## 
## 	DHARMa outlier test based on exact binomial test with approximate
## 	expectations
## 
## data:  simulationOutput
## outliers at both margin(s) = 0, observations = 178, p-value = 0.4111
## alternative hypothesis: true probability of success is not equal to 0.007968127
## 95 percent confidence interval:
##  0.00000000 0.02051077
## sample estimates:
## frequency of outliers (expected: 0.00796812749003984 ) 
##                                                      0
```

```
## $uniformity
## 
## 	Asymptotic one-sample Kolmogorov-Smirnov test
## 
## data:  simulationOutput$scaledResiduals
## D = 0.056494, p-value = 0.6209
## alternative hypothesis: two-sided
## 
## 
## $dispersion
## 
## 	DHARMa nonparametric dispersion test via sd of residuals fitted vs.
## 	simulated
## 
## data:  simulationOutput
## dispersion = 0.62173, p-value = 0.216
## alternative hypothesis: two.sided
## 
## 
## $outliers
## 
## 	DHARMa outlier test based on exact binomial test with approximate
## 	expectations
## 
## data:  simulationOutput
## outliers at both margin(s) = 0, observations = 178, p-value = 0.4111
## alternative hypothesis: true probability of success is not equal to 0.007968127
## 95 percent confidence interval:
##  0.00000000 0.02051077
## sample estimates:
## frequency of outliers (expected: 0.00796812749003984 ) 
##                                                      0
```

### cs.model.1.p2.log [plot_model]

```r
par(mar=c(2,2,2,2))
cs.model.1.p2.log %>% plot_model(type = "diag")
```

```
## [[1]]
```

```
## 
## [[2]]
## [[2]]$fish_id
```

```
## 
## 
## [[3]]
```

```
## 
## [[4]]
```


<img src="01.DataAnalysis_files/figure-html/cs-model-re-validatiaon-3-1.png" width="50%" /><img src="01.DataAnalysis_files/figure-html/cs-model-re-validatiaon-3-2.png" width="50%" /><img src="01.DataAnalysis_files/figure-html/cs-model-re-validatiaon-3-3.png" width="50%" /><img src="01.DataAnalysis_files/figure-html/cs-model-re-validatiaon-3-4.png" width="50%" />
### {-}

Model looks much better, there are still some issues with qq plot output from the **plot_model** validations, but otherwise the model looks like it is performing really well. Considering how well the model is performing across most metrics, the current model is judged to be suitable.  

## Partial plots {.tabset} 

### ggemmeans {.tabset} 

#### TEMPERATURE V LATITUDE

![](01.DataAnalysis_files/figure-html/cs-partial-plots-1-1.png)<!-- -->

#### TEMPERATURE V GENUS

![](01.DataAnalysis_files/figure-html/cs-partial-plots-1b-1.png)<!-- -->

#### TEMPERATURE V GENUS V LATITUDE

![](01.DataAnalysis_files/figure-html/cs-partial-plots-1c-1.png)<!-- -->

### plot_model 

![](01.DataAnalysis_files/figure-html/cs-partial-plots-1d-1.png)<!-- -->

#### {-}

### {-}

## Model investigation {.tabset .tabset-pills}

### summary 
<table class=" lightable-paper" style='font-family: "Arial Narrow", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:right;"> Estimate </th>
   <th style="text-align:right;"> StdError </th>
   <th style="text-align:right;"> Zvalue </th>
   <th style="text-align:right;"> Pvalue </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> (Intercept) </td>
   <td style="text-align:right;"> 0.7539331 </td>
   <td style="text-align:right;"> 0.1314431 </td>
   <td style="text-align:right;"> 5.7358138 </td>
   <td style="text-align:right;"> 0.0000000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2)1 </td>
   <td style="text-align:right;"> 9.5011517 </td>
   <td style="text-align:right;"> 0.6740403 </td>
   <td style="text-align:right;"> 14.0958212 </td>
   <td style="text-align:right;"> 0.0000000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2)2 </td>
   <td style="text-align:right;"> -1.0793080 </td>
   <td style="text-align:right;"> 0.4229167 </td>
   <td style="text-align:right;"> -2.5520583 </td>
   <td style="text-align:right;"> 0.0107089 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> LATITUDEtropical </td>
   <td style="text-align:right;"> 0.0010813 </td>
   <td style="text-align:right;"> 0.1819688 </td>
   <td style="text-align:right;"> 0.0059421 </td>
   <td style="text-align:right;"> 0.9952590 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> LATIN_GENUSPomacentrus </td>
   <td style="text-align:right;"> 0.4601495 </td>
   <td style="text-align:right;"> 0.1824722 </td>
   <td style="text-align:right;"> 2.5217513 </td>
   <td style="text-align:right;"> 0.0116772 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2)1:LATITUDEtropical </td>
   <td style="text-align:right;"> -0.1465629 </td>
   <td style="text-align:right;"> 0.9607412 </td>
   <td style="text-align:right;"> -0.1525519 </td>
   <td style="text-align:right;"> 0.8787516 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2)2:LATITUDEtropical </td>
   <td style="text-align:right;"> 0.1698502 </td>
   <td style="text-align:right;"> 0.6048415 </td>
   <td style="text-align:right;"> 0.2808177 </td>
   <td style="text-align:right;"> 0.7788502 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2)1:LATIN_GENUSPomacentrus </td>
   <td style="text-align:right;"> 0.0828697 </td>
   <td style="text-align:right;"> 0.8061672 </td>
   <td style="text-align:right;"> 0.1027947 </td>
   <td style="text-align:right;"> 0.9181259 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2)2:LATIN_GENUSPomacentrus </td>
   <td style="text-align:right;"> 0.1418223 </td>
   <td style="text-align:right;"> 0.5080309 </td>
   <td style="text-align:right;"> 0.2791609 </td>
   <td style="text-align:right;"> 0.7801214 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> LATITUDEtropical:LATIN_GENUSPomacentrus </td>
   <td style="text-align:right;"> 0.2040910 </td>
   <td style="text-align:right;"> 0.2517099 </td>
   <td style="text-align:right;"> 0.8108182 </td>
   <td style="text-align:right;"> 0.4174701 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2)1:LATITUDEtropical:LATIN_GENUSPomacentrus </td>
   <td style="text-align:right;"> 0.7792801 </td>
   <td style="text-align:right;"> 1.1196116 </td>
   <td style="text-align:right;"> 0.6960272 </td>
   <td style="text-align:right;"> 0.4864118 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2)2:LATITUDEtropical:LATIN_GENUSPomacentrus </td>
   <td style="text-align:right;"> -0.4588078 </td>
   <td style="text-align:right;"> 0.7046630 </td>
   <td style="text-align:right;"> -0.6511025 </td>
   <td style="text-align:right;"> 0.5149803 </td>
  </tr>
</tbody>
</table>

### anova 
<table class=" lightable-paper" style='font-family: "Arial Narrow", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:right;"> Chisq </th>
   <th style="text-align:right;"> Df </th>
   <th style="text-align:right;"> Pr(&gt;Chisq) </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2) </td>
   <td style="text-align:right;"> 3520.9038431 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.0000000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> LATITUDE </td>
   <td style="text-align:right;"> 0.9766495 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.3230274 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> LATIN_GENUS </td>
   <td style="text-align:right;"> 24.1998129 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0000009 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2):LATITUDE </td>
   <td style="text-align:right;"> 0.8190858 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.6639537 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2):LATIN_GENUS </td>
   <td style="text-align:right;"> 1.2558384 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.5337012 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> LATITUDE:LATIN_GENUS </td>
   <td style="text-align:right;"> 1.0196819 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.3125945 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2):LATITUDE:LATIN_GENUS </td>
   <td style="text-align:right;"> 0.5089339 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.7753297 </td>
  </tr>
</tbody>
</table>

### confint 
<table class=" lightable-paper" style='font-family: "Arial Narrow", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:right;"> 2.5 % </th>
   <th style="text-align:right;"> 97.5 % </th>
   <th style="text-align:right;"> Estimate </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> (Intercept) </td>
   <td style="text-align:right;"> 0.4963094 </td>
   <td style="text-align:right;"> 1.0115569 </td>
   <td style="text-align:right;"> 0.7539331 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2)1 </td>
   <td style="text-align:right;"> 8.1800570 </td>
   <td style="text-align:right;"> 10.8222464 </td>
   <td style="text-align:right;"> 9.5011517 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2)2 </td>
   <td style="text-align:right;"> -1.9082095 </td>
   <td style="text-align:right;"> -0.2504066 </td>
   <td style="text-align:right;"> -1.0793080 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> LATITUDEtropical </td>
   <td style="text-align:right;"> -0.3555710 </td>
   <td style="text-align:right;"> 0.3577335 </td>
   <td style="text-align:right;"> 0.0010813 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> LATIN_GENUSPomacentrus </td>
   <td style="text-align:right;"> 0.1025106 </td>
   <td style="text-align:right;"> 0.8177884 </td>
   <td style="text-align:right;"> 0.4601495 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2)1:LATITUDEtropical </td>
   <td style="text-align:right;"> -2.0295810 </td>
   <td style="text-align:right;"> 1.7364552 </td>
   <td style="text-align:right;"> -0.1465629 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2)2:LATITUDEtropical </td>
   <td style="text-align:right;"> -1.0156174 </td>
   <td style="text-align:right;"> 1.3553179 </td>
   <td style="text-align:right;"> 0.1698502 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2)1:LATIN_GENUSPomacentrus </td>
   <td style="text-align:right;"> -1.4971889 </td>
   <td style="text-align:right;"> 1.6629283 </td>
   <td style="text-align:right;"> 0.0828697 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2)2:LATIN_GENUSPomacentrus </td>
   <td style="text-align:right;"> -0.8538999 </td>
   <td style="text-align:right;"> 1.1375446 </td>
   <td style="text-align:right;"> 0.1418223 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> LATITUDEtropical:LATIN_GENUSPomacentrus </td>
   <td style="text-align:right;"> -0.2892514 </td>
   <td style="text-align:right;"> 0.6974333 </td>
   <td style="text-align:right;"> 0.2040910 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2)1:LATITUDEtropical:LATIN_GENUSPomacentrus </td>
   <td style="text-align:right;"> -1.4151183 </td>
   <td style="text-align:right;"> 2.9736785 </td>
   <td style="text-align:right;"> 0.7792801 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2)2:LATITUDEtropical:LATIN_GENUSPomacentrus </td>
   <td style="text-align:right;"> -1.8399219 </td>
   <td style="text-align:right;"> 0.9223063 </td>
   <td style="text-align:right;"> -0.4588078 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Std.Dev.(Intercept)|fish_id </td>
   <td style="text-align:right;"> 0.2874800 </td>
   <td style="text-align:right;"> 0.4750907 </td>
   <td style="text-align:right;"> 0.3695661 </td>
  </tr>
</tbody>
</table>

### r-squared
<table class=" lightable-paper" style='font-family: "Arial Narrow", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>
 <thead>
  <tr>
   <th style="text-align:right;"> R2_conditional </th>
   <th style="text-align:right;"> R2_marginal </th>
   <th style="text-align:left;"> optional </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:right;"> 0.7916472 </td>
   <td style="text-align:right;"> 0.6478569 </td>
   <td style="text-align:left;"> FALSE </td>
  </tr>
</tbody>
</table>

### {-} 

## Pairwise comparisons {.tabset .tabset-faded} 

### emtrends 


```r
cs.model.1.p2.log %>% emtrends(var = "temperature", type = "response") %>% pairs(by = "temperature") %>% summary(by = NULL, adjust = "sidak", infer=TRUE)
```

<div data-pagedtable="false">
  <script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["contrast"],"name":[1],"type":["fct"],"align":["left"]},{"label":["temperature"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["estimate"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["SE"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["lower.CL"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["upper.CL"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["t.ratio"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[9],"type":["dbl"],"align":["right"]}],"data":[{"1":"(sub-tropical Apogon) - tropical Apogon","2":"30.44944","3":"0.0007040977","4":"0.004897628","5":"176","6":"-0.01232830","7":"0.013736496","8":"0.1437630","9":"0.9999978","_rn_":"1"},{"1":"(sub-tropical Apogon) - (sub-tropical Pomacentrus)","2":"30.44944","3":"-0.0005035219","4":"0.004108050","5":"176","6":"-0.01143488","7":"0.010427841","8":"-0.1225696","9":"0.9999991","_rn_":"2"},{"1":"(sub-tropical Apogon) - tropical Pomacentrus","2":"30.44944","3":"-0.0037400296","4":"0.003912037","5":"176","6":"-0.01414981","7":"0.006669751","8":"-0.9560311","9":"0.9176221","_rn_":"3"},{"1":"tropical Apogon - (sub-tropical Pomacentrus)","2":"30.44944","3":"-0.0012076196","4":"0.004154785","5":"176","6":"-0.01226334","7":"0.009848103","8":"-0.2906575","9":"0.9998582","_rn_":"4"},{"1":"tropical Apogon - tropical Pomacentrus","2":"30.44944","3":"-0.0044441274","4":"0.003961084","5":"176","6":"-0.01498442","7":"0.006096163","8":"-1.1219474","9":"0.8402857","_rn_":"5"},{"1":"(sub-tropical Pomacentrus) - tropical Pomacentrus","2":"30.44944","3":"-0.0032365078","4":"0.002929061","5":"176","6":"-0.01103063","7":"0.004557611","8":"-1.1049642","9":"0.8495138","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
SCROLL TO THE RIGHT -->

The numbers in the left most column in the table just mention that the slopes are assuming mean **MASS_CENTERED** and **RESTING_TIME_SEONDS** values when looking at differences between latitudinal slopes.

### emmeans 

```r
cs.model.1.p2.log %>% emmeans(pairwise ~ temperature*LATITUDE*LATIN_GENUS, type = "response") %>% regrid() %>% pairs(by = "temperature") %>% summary(by = NULL, adjust = "sidak", infer=TRUE)
```

<div data-pagedtable="false">
  <script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["contrast"],"name":[1],"type":["fct"],"align":["left"]},{"label":["temperature"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["estimate"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["SE"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["lower.CL"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["upper.CL"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["t.ratio"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[9],"type":["dbl"],"align":["right"]}],"data":[{"1":"(sub-tropical Apogon) - tropical Apogon","2":"30.44944","3":"0.03246975","4":"0.4150604","5":"176","6":"-1.071990","7":"1.13692960","8":"0.07822898","9":"0.999999942","_rn_":"1"},{"1":"(sub-tropical Apogon) - (sub-tropical Pomacentrus)","2":"30.44944","3":"-1.32028287","4":"0.5507574","5":"176","6":"-2.785827","7":"0.14526142","8":"-2.39721302","9":"0.100880855","_rn_":"2"},{"1":"(sub-tropical Apogon) - tropical Pomacentrus","2":"30.44944","3":"-2.27018986","4":"0.6241864","5":"176","6":"-3.931126","7":"-0.60925377","8":"-3.63703805","9":"0.002170302","_rn_":"3"},{"1":"tropical Apogon - (sub-tropical Pomacentrus)","2":"30.44944","3":"-1.35275263","4":"0.5408660","5":"176","6":"-2.791976","7":"0.08647101","8":"-2.50108637","9":"0.077164356","_rn_":"4"},{"1":"tropical Apogon - tropical Pomacentrus","2":"30.44944","3":"-2.30265962","4":"0.6154713","5":"176","6":"-3.940405","7":"-0.66491412","8":"-3.74129468","9":"0.001484418","_rn_":"5"},{"1":"(sub-tropical Pomacentrus) - tropical Pomacentrus","2":"30.44944","3":"-0.94990699","4":"0.7139998","5":"176","6":"-2.849833","7":"0.95001905","8":"-1.33040226","9":"0.707178161","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>

### temperature 

```r
cs.model.1.p2.log %>% emmeans(~ temperature*LATITUDE*LATIN_GENUS, type = "response")  %>% summary(infer=TRUE)
```

<div data-pagedtable="false">
  <script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["temperature"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["LATITUDE"],"name":[2],"type":["fct"],"align":["left"]},{"label":["LATIN_GENUS"],"name":[3],"type":["fct"],"align":["left"]},{"label":["response"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["SE"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["lower.CL"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["upper.CL"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["null"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["t.ratio"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[11],"type":["dbl"],"align":["right"]}],"data":[{"1":"30.44944","2":"sub-tropical","3":"Apogon","4":"2.338808","5":"0.3026678","6":"176","7":"1.811661","8":"3.019342","9":"1","10":"6.565442","11":"5.621919e-10","_rn_":"1"},{"1":"30.44944","2":"tropical","3":"Apogon","4":"2.306338","5":"0.2842546","6":"176","7":"1.808367","8":"2.941436","9":"1","10":"6.780249","11":"1.747797e-10","_rn_":"2"},{"1":"30.44944","2":"sub-tropical","3":"Pomacentrus","4":"3.659091","5":"0.4601976","6":"176","7":"2.854814","8":"4.689954","9":"1","10":"10.314322","11":"8.272139e-20","_rn_":"3"},{"1":"30.44944","2":"tropical","3":"Pomacentrus","4":"4.608998","5":"0.5459129","6":"176","7":"3.648278","8":"5.822710","9":"1","10":"12.900588","11":"3.133507e-27","_rn_":"4"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>

### temperture [combined]

```r
cs.means.temp <- cs.model.1.p2.log %>% update(CS_ACTIVITY ~ factor(temperature) * LATITUDE * LATIN_GENUS + (1|fish_id)) %>% emmeans(pairwise ~ temperature, type = "response") %>% summary(infer=TRUE)
```

```
## NOTE: Results may be misleading due to involvement in interactions
```

```r
cs.means.temp.df <- cs.means.temp$emmeans %>% as.data.frame() %>% 
  mutate("\u394 change"=response - lag(response, n=1, default = first(response)), 
         "\u394 %change" = response/lag(response, n=1, default = first(response))*100) 
cs.means.temp.df[1,8] = 0.0000 

cs.means.temp.df  
```

<div data-pagedtable="false">
  <script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["temperature"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["response"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["SE"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["lower.CL"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["upper.CL"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["null"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["t.ratio"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["Δ change"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["Δ %change"],"name":[11],"type":["dbl"],"align":["right"]}],"data":[{"1":"10","2":"0.8830765","3":"0.09288597","4":"176","5":"0.7175385","6":"1.086805","7":"1","8":"0.000000","9":"2.387425e-01","10":"0.0000000","11":"100.0000","_rn_":"1"},{"1":"20","2":"1.7662201","3":"0.12957464","4":"176","5":"1.5281501","6":"2.041379","7":"1","8":"7.753829","9":"6.884519e-13","10":"0.8831436","11":"200.0076","_rn_":"2"},{"1":"30","2":"2.9404753","3":"0.19128365","4":"176","5":"2.5861984","6":"3.343284","7":"1","8":"16.580153","9":"8.519216e-38","10":"1.1742553","11":"166.4841","_rn_":"3"},{"1":"40","2":"4.8597611","3":"0.30200657","4":"176","5":"4.2988405","6":"5.493872","7":"1","8":"25.440606","9":"7.407060e-61","10":"1.9192858","11":"165.2713","_rn_":"4"},{"1":"50","2":"6.9898525","3":"0.42977909","4":"176","5":"6.1911102","6":"7.891644","7":"1","8":"31.624351","9":"1.657197e-74","10":"2.1300914","11":"143.8312","_rn_":"5"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>

### Genus [combined]

```r
cs.means.genus <- cs.model.1.p2.log %>% update(CS_ACTIVITY ~ factor(temperature) * LATITUDE * LATIN_GENUS + (1|fish_id)) %>% emmeans(pairwise ~ LATIN_GENUS, type = "response") %>% summary(infer=TRUE); cs.means.genus
```

```
## NOTE: Results may be misleading due to involvement in interactions
```

```
## $emmeans
##  LATIN_GENUS response    SE  df lower.CL upper.CL null t.ratio p.value
##  Apogon          2.06 0.192 176     1.72     2.48    1   7.792  <.0001
##  Pomacentrus     3.65 0.319 176     3.07     4.34    1  14.838  <.0001
## 
## Results are averaged over the levels of: temperature, LATITUDE 
## Confidence level used: 0.95 
## Intervals are back-transformed from the log scale 
## Tests are performed on the log scale 
## 
## $contrasts
##  contrast             ratio    SE  df lower.CL upper.CL null t.ratio p.value
##  Apogon / Pomacentrus 0.565 0.072 176    0.439    0.726    1  -4.483  <.0001
## 
## Results are averaged over the levels of: temperature, LATITUDE 
## Confidence level used: 0.95 
## Intervals are back-transformed from the log scale 
## Tests are performed on the log scale
```

### Means - f(temperature)

```r
cs.means <- cs.model.1.p2.log %>% update(CS_ACTIVITY ~ factor(temperature) * LATITUDE * LATIN_GENUS + (1|fish_id)) %>% emmeans(pairwise ~ temperature*LATIN_GENUS*LATITUDE, type = "response"); cs.means$emmeans
```

```
##  temperature LATIN_GENUS LATITUDE     response    SE  df lower.CL upper.CL
##           10 Apogon      sub-tropical    0.564 0.158 176    0.324    0.982
##           20 Apogon      sub-tropical    1.469 0.226 176    1.085    1.989
##           30 Apogon      sub-tropical    2.218 0.304 176    1.693    2.905
##           40 Apogon      sub-tropical    3.617 0.468 176    2.802    4.670
##           50 Apogon      sub-tropical    5.180 0.657 176    4.032    6.654
##           10 Pomacentrus sub-tropical    1.197 0.199 176    0.862    1.663
##           20 Pomacentrus sub-tropical    1.891 0.273 176    1.422    2.515
##           30 Pomacentrus sub-tropical    3.647 0.470 176    2.827    4.704
##           40 Pomacentrus sub-tropical    5.704 0.718 176    4.449    7.313
##           50 Pomacentrus sub-tropical    8.375 1.045 176    6.548   10.714
##           10 Apogon      tropical        0.751 0.158 176    0.495    1.139
##           20 Apogon      tropical        1.348 0.214 176    0.986    1.844
##           30 Apogon      tropical        2.130 0.283 176    1.639    2.769
##           40 Apogon      tropical        3.643 0.448 176    2.858    4.642
##           50 Apogon      tropical        5.149 0.628 176    4.048    6.551
##           10 Pomacentrus tropical        1.199 0.193 176    0.873    1.646
##           20 Pomacentrus tropical        2.598 0.333 176    2.017    3.347
##           30 Pomacentrus tropical        4.339 0.525 176    3.417    5.510
##           40 Pomacentrus tropical        7.421 0.879 176    5.873    9.376
##           50 Pomacentrus tropical       10.686 1.259 176    8.469   13.484
## 
## Confidence level used: 0.95 
## Intervals are back-transformed from the log scale
```

### Abs. diff - f(temperature)

```r
cs.model.1.p2.log %>% update(CS_ACTIVITY ~ factor(temperature) * LATITUDE * LATIN_GENUS + (1|fish_id)) %>% emmeans(pairwise ~ temperature*LATIN_GENUS*LATITUDE, type = "response") %>% regrid() %>% pairs(by =c("LATIN_GENUS","LATITUDE")) %>% summary(infer=TRUE, type = "response")
```

<div data-pagedtable="false">
  <script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["contrast"],"name":[1],"type":["fct"],"align":["left"]},{"label":["LATIN_GENUS"],"name":[2],"type":["fct"],"align":["left"]},{"label":["LATITUDE"],"name":[3],"type":["fct"],"align":["left"]},{"label":["estimate"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["SE"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["lower.CL"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["upper.CL"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["t.ratio"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[10],"type":["dbl"],"align":["right"]}],"data":[{"1":"temperature10 - temperature20","2":"Apogon","3":"sub-tropical","4":"-0.9047539","5":"0.2241878","6":"176","7":"-1.522675","8":"-0.28683317","9":"-4.035697","10":"7.650641e-04","_rn_":"1"},{"1":"temperature10 - temperature30","2":"Apogon","3":"sub-tropical","4":"-1.6532489","5":"0.2801087","6":"176","7":"-2.425302","8":"-0.88119535","9":"-5.902170","10":"1.794353e-07","_rn_":"2"},{"1":"temperature10 - temperature40","2":"Apogon","3":"sub-tropical","4":"-3.0531927","5":"0.4253903","6":"176","7":"-4.225681","8":"-1.88070463","9":"-7.177392","10":"1.910641e-10","_rn_":"3"},{"1":"temperature10 - temperature50","2":"Apogon","3":"sub-tropical","4":"-4.6152337","5":"0.6054825","6":"176","7":"-6.284103","8":"-2.94636397","9":"-7.622407","10":"1.491918e-11","_rn_":"4"},{"1":"temperature20 - temperature30","2":"Apogon","3":"sub-tropical","4":"-0.7484950","5":"0.2046160","6":"176","7":"-1.312471","8":"-0.18451924","9":"-3.658047","10":"3.060386e-03","_rn_":"5"},{"1":"temperature20 - temperature40","2":"Apogon","3":"sub-tropical","4":"-2.1484388","5":"0.3239652","6":"176","7":"-3.041373","8":"-1.25550503","9":"-6.631696","10":"3.922931e-09","_rn_":"6"},{"1":"temperature20 - temperature50","2":"Apogon","3":"sub-tropical","4":"-3.7104798","5":"0.4968021","6":"176","7":"-5.079798","8":"-2.34116193","9":"-7.468728","10":"3.624212e-11","_rn_":"7"},{"1":"temperature30 - temperature40","2":"Apogon","3":"sub-tropical","4":"-1.3999439","5":"0.2492828","6":"176","7":"-2.087033","8":"-0.71285448","9":"-5.615886","10":"7.453616e-07","_rn_":"8"},{"1":"temperature30 - temperature50","2":"Apogon","3":"sub-tropical","4":"-2.9619848","5":"0.4095443","6":"176","7":"-4.090797","8":"-1.83317261","9":"-7.232393","10":"1.399335e-10","_rn_":"9"},{"1":"temperature40 - temperature50","2":"Apogon","3":"sub-tropical","4":"-1.5620410","5":"0.2631820","6":"176","7":"-2.287440","8":"-0.83664184","9":"-5.935212","10":"1.517980e-07","_rn_":"10"},{"1":"temperature10 - temperature20","2":"Pomacentrus","3":"sub-tropical","4":"-0.6939285","5":"0.2123561","6":"176","7":"-1.279238","8":"-0.10861904","9":"-3.267759","10":"1.127019e-02","_rn_":"11"},{"1":"temperature10 - temperature30","2":"Pomacentrus","3":"sub-tropical","4":"-2.4496080","5":"0.3570477","6":"176","7":"-3.433726","8":"-1.46549009","9":"-6.860730","10":"1.120888e-09","_rn_":"12"},{"1":"temperature10 - temperature40","2":"Pomacentrus","3":"sub-tropical","4":"-4.5068908","5":"0.5886902","6":"176","7":"-6.129477","8":"-2.88430482","9":"-7.655793","10":"1.229317e-11","_rn_":"13"},{"1":"temperature10 - temperature50","2":"Pomacentrus","3":"sub-tropical","4":"-7.1783924","5":"0.9081446","6":"176","7":"-9.681479","8":"-4.67530578","9":"-7.904460","10":"2.913114e-12","_rn_":"14"},{"1":"temperature20 - temperature30","2":"Pomacentrus","3":"sub-tropical","4":"-1.7556796","5":"0.2912959","6":"176","7":"-2.558568","8":"-0.95279097","9":"-6.027134","10":"9.502768e-08","_rn_":"15"},{"1":"temperature20 - temperature40","2":"Pomacentrus","3":"sub-tropical","4":"-3.8129623","5":"0.5101147","6":"176","7":"-5.218973","8":"-2.40695128","9":"-7.474715","10":"3.501388e-11","_rn_":"16"},{"1":"temperature20 - temperature50","2":"Pomacentrus","3":"sub-tropical","4":"-6.4844639","5":"0.8255788","6":"176","7":"-8.759977","8":"-4.20895044","9":"-7.854446","10":"3.885781e-12","_rn_":"17"},{"1":"temperature30 - temperature40","2":"Pomacentrus","3":"sub-tropical","4":"-2.0572827","5":"0.3170070","6":"176","7":"-2.931038","8":"-1.18352754","9":"-6.489707","10":"8.426822e-09","_rn_":"18"},{"1":"temperature30 - temperature50","2":"Pomacentrus","3":"sub-tropical","4":"-4.7287843","5":"0.6150460","6":"176","7":"-6.424014","8":"-3.03355494","9":"-7.688505","10":"1.016720e-11","_rn_":"19"},{"1":"temperature40 - temperature50","2":"Pomacentrus","3":"sub-tropical","4":"-2.6715016","5":"0.3809121","6":"176","7":"-3.721396","8":"-1.62160730","9":"-7.013434","10":"4.800491e-10","_rn_":"20"},{"1":"temperature10 - temperature20","2":"Apogon","3":"tropical","4":"-0.5973301","5":"0.2054986","6":"176","7":"-1.163739","8":"-0.03092172","9":"-2.906736","10":"3.314768e-02","_rn_":"21"},{"1":"temperature10 - temperature30","2":"Apogon","3":"tropical","4":"-1.3796109","5":"0.2455827","6":"176","7":"-2.056502","8":"-0.70271999","9":"-5.617703","10":"7.387594e-07","_rn_":"22"},{"1":"temperature10 - temperature40","2":"Apogon","3":"tropical","4":"-2.8917757","5":"0.3859129","6":"176","7":"-3.955454","8":"-1.82809775","9":"-7.493338","10":"3.145584e-11","_rn_":"23"},{"1":"temperature10 - temperature50","2":"Apogon","3":"tropical","4":"-4.3985901","5":"0.5571950","6":"176","7":"-5.934367","8":"-2.86281347","9":"-7.894167","10":"3.091194e-12","_rn_":"24"},{"1":"temperature20 - temperature30","2":"Apogon","3":"tropical","4":"-0.7822807","5":"0.2136744","6":"176","7":"-1.371224","8":"-0.19333775","9":"-3.661089","10":"3.027853e-03","_rn_":"25"},{"1":"temperature20 - temperature40","2":"Apogon","3":"tropical","4":"-2.2944456","5":"0.3304608","6":"176","7":"-3.205283","8":"-1.38360843","9":"-6.943171","10":"7.100257e-10","_rn_":"26"},{"1":"temperature20 - temperature50","2":"Apogon","3":"tropical","4":"-3.8012600","5":"0.4952909","6":"176","7":"-5.166413","8":"-2.43610724","9":"-7.674802","10":"1.100930e-11","_rn_":"27"},{"1":"temperature30 - temperature40","2":"Apogon","3":"tropical","4":"-1.5121649","5":"0.2518123","6":"176","7":"-2.206226","8":"-0.81810357","9":"-6.005127","10":"1.063475e-07","_rn_":"28"},{"1":"temperature30 - temperature50","2":"Apogon","3":"tropical","4":"-3.0189792","5":"0.4069661","6":"176","7":"-4.140685","8":"-1.89727307","9":"-7.418257","10":"4.844181e-11","_rn_":"29"},{"1":"temperature40 - temperature50","2":"Apogon","3":"tropical","4":"-1.5068143","5":"0.2602223","6":"176","7":"-2.224056","8":"-0.78957285","9":"-5.790489","10":"3.144303e-07","_rn_":"30"},{"1":"temperature10 - temperature20","2":"Pomacentrus","3":"tropical","4":"-1.3994157","5":"0.2503323","6":"176","7":"-2.089398","8":"-0.70943379","9":"-5.590233","10":"8.449019e-07","_rn_":"31"},{"1":"temperature10 - temperature30","2":"Pomacentrus","3":"tropical","4":"-3.1403873","5":"0.4123952","6":"176","7":"-4.277057","8":"-2.00371718","9":"-7.614995","10":"1.557388e-11","_rn_":"32"},{"1":"temperature10 - temperature40","2":"Pomacentrus","3":"tropical","4":"-6.2220062","5":"0.7523813","6":"176","7":"-8.295768","8":"-4.14824434","9":"-8.269751","10":"4.035661e-13","_rn_":"33"},{"1":"temperature10 - temperature50","2":"Pomacentrus","3":"tropical","4":"-9.4869655","5":"1.1271752","6":"176","7":"-12.593758","8":"-6.38017254","9":"-8.416584","10":"2.123857e-13","_rn_":"34"},{"1":"temperature20 - temperature30","2":"Pomacentrus","3":"tropical","4":"-1.7409715","5":"0.2780065","6":"176","7":"-2.507231","8":"-0.97471221","9":"-6.262342","10":"2.809627e-08","_rn_":"35"},{"1":"temperature20 - temperature40","2":"Pomacentrus","3":"tropical","4":"-4.8225905","5":"0.5957059","6":"176","7":"-6.464513","8":"-3.18066760","9":"-8.095590","10":"9.928725e-13","_rn_":"36"},{"1":"temperature20 - temperature50","2":"Pomacentrus","3":"tropical","4":"-8.0875497","5":"0.9662647","6":"176","7":"-10.750831","8":"-5.42426873","9":"-8.369911","10":"2.569056e-13","_rn_":"37"},{"1":"temperature30 - temperature40","2":"Pomacentrus","3":"tropical","4":"-3.0816189","5":"0.4062731","6":"176","7":"-4.201415","8":"-1.96182292","9":"-7.585092","10":"1.851408e-11","_rn_":"38"},{"1":"temperature30 - temperature50","2":"Pomacentrus","3":"tropical","4":"-6.3465782","5":"0.7667416","6":"176","7":"-8.459921","8":"-4.23323566","9":"-8.277336","10":"3.891332e-13","_rn_":"39"},{"1":"temperature40 - temperature50","2":"Pomacentrus","3":"tropical","4":"-3.2649593","5":"0.4257018","6":"176","7":"-4.438306","8":"-2.09161263","9":"-7.669593","10":"1.134703e-11","_rn_":"40"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>

### Genus comparisons

```r
cs.model.1.p2.log %>% update(CS_ACTIVITY ~ factor(temperature) * LATITUDE * LATIN_GENUS + (1|fish_id)) %>% emmeans(pairwise ~ temperature*LATIN_GENUS*LATITUDE, type = "response") %>% regrid() %>% pairs(by =c("LATIN_GENUS")) %>% summary(infer=TRUE, type = "response")
```

<div data-pagedtable="false">
  <script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["contrast"],"name":[1],"type":["fct"],"align":["left"]},{"label":["LATIN_GENUS"],"name":[2],"type":["fct"],"align":["left"]},{"label":["estimate"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["SE"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["lower.CL"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["upper.CL"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["t.ratio"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[9],"type":["dbl"],"align":["right"]}],"data":[{"1":"(temperature10 sub-tropical) - (temperature20 sub-tropical)","2":"Apogon","3":"-0.904753928","4":"0.2241878","5":"176","6":"-1.6232217","7":"-0.18628620","8":"-4.035697042","9":"3.170364e-03","_rn_":"1"},{"1":"(temperature10 sub-tropical) - (temperature30 sub-tropical)","2":"Apogon","3":"-1.653248883","4":"0.2801087","5":"176","6":"-2.5509296","7":"-0.75556816","8":"-5.902169624","9":"8.013656e-07","_rn_":"2"},{"1":"(temperature10 sub-tropical) - (temperature40 sub-tropical)","2":"Apogon","3":"-3.053192735","4":"0.4253903","5":"176","6":"-4.4164660","7":"-1.68991944","8":"-7.177391594","9":"8.584518e-10","_rn_":"3"},{"1":"(temperature10 sub-tropical) - (temperature50 sub-tropical)","2":"Apogon","3":"-4.615233711","4":"0.6054825","5":"176","6":"-6.5556590","7":"-2.67480843","8":"-7.622406794","9":"6.686085e-11","_rn_":"4"},{"1":"(temperature10 sub-tropical) - temperature10 tropical","2":"Apogon","3":"-0.186578832","4":"0.2240877","5":"176","6":"-0.9047257","7":"0.53156806","8":"-0.832615389","9":"9.979680e-01","_rn_":"5"},{"1":"(temperature10 sub-tropical) - temperature20 tropical","2":"Apogon","3":"-0.783908944","4":"0.2661195","5":"176","6":"-1.6367576","7":"0.06893975","8":"-2.945703130","9":"1.010454e-01","_rn_":"6"},{"1":"(temperature10 sub-tropical) - temperature30 tropical","2":"Apogon","3":"-1.566189693","4":"0.3242701","5":"176","6":"-2.6053970","7":"-0.52698238","8":"-4.829893043","9":"1.262915e-04","_rn_":"7"},{"1":"(temperature10 sub-tropical) - temperature40 tropical","2":"Apogon","3":"-3.078354567","4":"0.4747728","5":"176","6":"-4.5998868","7":"-1.55682234","8":"-6.483848103","9":"3.899453e-08","_rn_":"8"},{"1":"(temperature10 sub-tropical) - temperature50 tropical","2":"Apogon","3":"-4.585168903","4":"0.6476698","5":"176","6":"-6.6607942","7":"-2.50954356","8":"-7.079485909","9":"1.489944e-09","_rn_":"9"},{"1":"(temperature20 sub-tropical) - (temperature30 sub-tropical)","2":"Apogon","3":"-0.748494955","4":"0.2046160","5":"176","6":"-1.4042398","7":"-0.09275011","8":"-3.658047492","9":"1.211990e-02","_rn_":"10"},{"1":"(temperature20 sub-tropical) - (temperature40 sub-tropical)","2":"Apogon","3":"-2.148438806","4":"0.3239652","5":"176","6":"-3.1866692","7":"-1.11020842","8":"-6.631695885","9":"1.760390e-08","_rn_":"11"},{"1":"(temperature20 sub-tropical) - (temperature50 sub-tropical)","2":"Apogon","3":"-3.710479783","4":"0.4968021","5":"176","6":"-5.3026106","7":"-2.11834896","8":"-7.468728385","9":"1.627313e-10","_rn_":"12"},{"1":"(temperature20 sub-tropical) - temperature10 tropical","2":"Apogon","3":"0.718175096","4":"0.2756281","5":"176","6":"-0.1651463","7":"1.60149652","8":"2.605595090","9":"2.229503e-01","_rn_":"13"},{"1":"(temperature20 sub-tropical) - temperature20 tropical","2":"Apogon","3":"0.120844984","4":"0.3107495","5":"176","6":"-0.8750321","7":"1.11672211","8":"0.388882338","9":"9.999965e-01","_rn_":"14"},{"1":"(temperature20 sub-tropical) - temperature30 tropical","2":"Apogon","3":"-0.661435764","4":"0.3617633","5":"176","6":"-1.8208000","7":"0.49792845","8":"-1.828365973","9":"7.163579e-01","_rn_":"15"},{"1":"(temperature20 sub-tropical) - temperature40 tropical","2":"Apogon","3":"-2.173600638","4":"0.5010987","5":"176","6":"-3.7795011","7":"-0.56770016","8":"-4.337669638","9":"9.885980e-04","_rn_":"16"},{"1":"(temperature20 sub-tropical) - temperature50 tropical","2":"Apogon","3":"-3.680414974","4":"0.6671485","5":"176","6":"-5.8184651","7":"-1.54236484","8":"-5.516635011","9":"5.367387e-06","_rn_":"17"},{"1":"(temperature30 sub-tropical) - (temperature40 sub-tropical)","2":"Apogon","3":"-1.399943852","4":"0.2492828","5":"176","6":"-2.1988352","7":"-0.60105252","8":"-5.615885636","9":"3.316967e-06","_rn_":"18"},{"1":"(temperature30 sub-tropical) - (temperature50 sub-tropical)","2":"Apogon","3":"-2.961984828","4":"0.4095443","5":"176","6":"-4.2744754","7":"-1.64949428","8":"-7.232392596","9":"6.287219e-10","_rn_":"19"},{"1":"(temperature30 sub-tropical) - temperature10 tropical","2":"Apogon","3":"1.466670051","4":"0.3423221","5":"176","6":"0.3696102","7":"2.56372988","8":"4.284473465","9":"1.220730e-03","_rn_":"20"},{"1":"(temperature30 sub-tropical) - temperature20 tropical","2":"Apogon","3":"0.869339939","4":"0.3711744","5":"176","6":"-0.3201844","7":"2.05886430","8":"2.342133462","9":"3.675621e-01","_rn_":"21"},{"1":"(temperature30 sub-tropical) - temperature30 tropical","2":"Apogon","3":"0.087059190","4":"0.4147980","5":"176","6":"-1.2422683","7":"1.41638670","8":"0.209883345","9":"1.000000e+00","_rn_":"22"},{"1":"(temperature30 sub-tropical) - temperature40 tropical","2":"Apogon","3":"-1.425105684","4":"0.5406091","5":"176","6":"-3.1576274","7":"0.30741605","8":"-2.636111220","9":"2.090278e-01","_rn_":"23"},{"1":"(temperature30 sub-tropical) - temperature50 tropical","2":"Apogon","3":"-2.931920020","4":"0.6972642","5":"176","6":"-5.1664838","7":"-0.69735629","8":"-4.204890787","9":"1.666228e-03","_rn_":"24"},{"1":"(temperature40 sub-tropical) - (temperature50 sub-tropical)","2":"Apogon","3":"-1.562040977","4":"0.2631820","5":"176","6":"-2.4054758","7":"-0.71860617","8":"-5.935212201","9":"6.781615e-07","_rn_":"25"},{"1":"(temperature40 sub-tropical) - temperature10 tropical","2":"Apogon","3":"2.866613903","4":"0.4942570","5":"176","6":"1.2826395","7":"4.45058831","8":"5.799845019","9":"1.338637e-06","_rn_":"26"},{"1":"(temperature40 sub-tropical) - temperature20 tropical","2":"Apogon","3":"2.269283791","4":"0.5146448","5":"176","6":"0.6199713","7":"3.91859628","8":"4.409417388","9":"7.410999e-04","_rn_":"27"},{"1":"(temperature40 sub-tropical) - temperature30 tropical","2":"Apogon","3":"1.487003042","4":"0.5469055","5":"176","6":"-0.2656973","7":"3.23970341","8":"2.718939393","9":"1.743056e-01","_rn_":"28"},{"1":"(temperature40 sub-tropical) - temperature40 tropical","2":"Apogon","3":"-0.025161832","4":"0.6474985","5":"176","6":"-2.1002384","7":"2.04991470","8":"-0.038860062","9":"1.000000e+00","_rn_":"29"},{"1":"(temperature40 sub-tropical) - temperature50 tropical","2":"Apogon","3":"-1.531976168","4":"0.7829681","5":"176","6":"-4.0412002","7":"0.97724788","8":"-1.956626434","9":"6.303612e-01","_rn_":"30"},{"1":"(temperature50 sub-tropical) - temperature10 tropical","2":"Apogon","3":"4.428654879","4":"0.6761555","5":"176","6":"2.2617396","7":"6.59557011","8":"6.549758124","9":"2.738952e-08","_rn_":"31"},{"1":"(temperature50 sub-tropical) - temperature20 tropical","2":"Apogon","3":"3.831324767","4":"0.6911874","5":"176","6":"1.6162359","7":"6.04641360","8":"5.543105789","9":"4.723531e-06","_rn_":"32"},{"1":"(temperature50 sub-tropical) - temperature30 tropical","2":"Apogon","3":"3.049044019","4":"0.7155058","5":"176","6":"0.7560206","7":"5.34206744","8":"4.261382818","9":"1.336785e-03","_rn_":"33"},{"1":"(temperature50 sub-tropical) - temperature40 tropical","2":"Apogon","3":"1.536879145","4":"0.7950147","5":"176","6":"-1.0109513","7":"4.08470961","8":"1.933145485","9":"6.465239e-01","_rn_":"34"},{"1":"(temperature50 sub-tropical) - temperature50 tropical","2":"Apogon","3":"0.030064809","4":"0.9086846","5":"176","6":"-2.8820501","7":"2.94217971","8":"0.033086078","9":"1.000000e+00","_rn_":"35"},{"1":"temperature10 tropical - temperature20 tropical","2":"Apogon","3":"-0.597330112","4":"0.2054986","5":"176","6":"-1.2559035","7":"0.06124325","8":"-2.906736049","9":"1.115098e-01","_rn_":"36"},{"1":"temperature10 tropical - temperature30 tropical","2":"Apogon","3":"-1.379610861","4":"0.2455827","5":"176","6":"-2.1666442","7":"-0.59257750","8":"-5.617703485","9":"3.287675e-06","_rn_":"37"},{"1":"temperature10 tropical - temperature40 tropical","2":"Apogon","3":"-2.891775735","4":"0.3859129","5":"176","6":"-4.1285335","7":"-1.65501795","8":"-7.493337656","9":"1.412072e-10","_rn_":"38"},{"1":"temperature10 tropical - temperature50 tropical","2":"Apogon","3":"-4.398590071","4":"0.5571950","5":"176","6":"-6.1842655","7":"-2.61291462","8":"-7.894166989","9":"1.366296e-11","_rn_":"39"},{"1":"temperature20 tropical - temperature30 tropical","2":"Apogon","3":"-0.782280749","4":"0.2136744","5":"176","6":"-1.4670555","7":"-0.09750599","8":"-3.661088656","9":"1.199636e-02","_rn_":"40"},{"1":"temperature20 tropical - temperature40 tropical","2":"Apogon","3":"-2.294445623","4":"0.3304608","5":"176","6":"-3.3534926","7":"-1.23539861","8":"-6.943171267","9":"3.189126e-09","_rn_":"41"},{"1":"temperature20 tropical - temperature50 tropical","2":"Apogon","3":"-3.801259959","4":"0.4952909","5":"176","6":"-5.3885479","7":"-2.21397201","8":"-7.674802327","9":"4.928336e-11","_rn_":"42"},{"1":"temperature30 tropical - temperature40 tropical","2":"Apogon","3":"-1.512164874","4":"0.2518123","5":"176","6":"-2.3191626","7":"-0.70516715","8":"-6.005126786","9":"4.754223e-07","_rn_":"43"},{"1":"temperature30 tropical - temperature50 tropical","2":"Apogon","3":"-3.018979210","4":"0.4069661","5":"176","6":"-4.3232074","7":"-1.71475103","8":"-7.418257253","9":"2.175663e-10","_rn_":"44"},{"1":"temperature40 tropical - temperature50 tropical","2":"Apogon","3":"-1.506814336","4":"0.2602223","5":"176","6":"-2.3407641","7":"-0.67286458","8":"-5.790488545","9":"1.402525e-06","_rn_":"45"},{"1":"(temperature10 sub-tropical) - (temperature20 sub-tropical)","2":"Pomacentrus","3":"-0.693928464","4":"0.2123561","5":"176","6":"-1.3744784","7":"-0.01337852","8":"-3.267759226","9":"4.162543e-02","_rn_":"46"},{"1":"(temperature10 sub-tropical) - (temperature30 sub-tropical)","2":"Pomacentrus","3":"-2.449608049","4":"0.3570477","5":"176","6":"-3.5938599","7":"-1.30535616","8":"-6.860729698","9":"5.033565e-09","_rn_":"47"},{"1":"(temperature10 sub-tropical) - (temperature40 sub-tropical)","2":"Pomacentrus","3":"-4.506890758","4":"0.5886902","5":"176","6":"-6.3935010","7":"-2.62028051","8":"-7.655793141","9":"5.505518e-11","_rn_":"48"},{"1":"(temperature10 sub-tropical) - (temperature50 sub-tropical)","2":"Pomacentrus","3":"-7.178392374","4":"0.9081446","5":"176","6":"-10.0887768","7":"-4.26800796","8":"-7.904459615","9":"1.286238e-11","_rn_":"49"},{"1":"(temperature10 sub-tropical) - temperature10 tropical","2":"Pomacentrus","3":"-0.002003417","4":"0.2772511","5":"176","6":"-0.8905262","7":"0.88651940","8":"-0.007226004","9":"1.000000e+00","_rn_":"50"},{"1":"(temperature10 sub-tropical) - temperature20 tropical","2":"Pomacentrus","3":"-1.401419157","4":"0.3885188","5":"176","6":"-2.6465281","7":"-0.15631017","8":"-3.607082134","9":"1.437013e-02","_rn_":"51"},{"1":"(temperature10 sub-tropical) - temperature30 tropical","2":"Pomacentrus","3":"-3.142390675","4":"0.5618189","5":"176","6":"-4.9428849","7":"-1.34189647","8":"-5.593244404","9":"3.703812e-06","_rn_":"52"},{"1":"(temperature10 sub-tropical) - temperature40 tropical","2":"Pomacentrus","3":"-6.224009614","4":"0.9017243","5":"176","6":"-9.1138185","7":"-3.33420068","8":"-6.902341978","9":"3.999384e-09","_rn_":"53"},{"1":"(temperature10 sub-tropical) - temperature50 tropical","2":"Pomacentrus","3":"-9.488968871","4":"1.2748050","5":"176","6":"-13.5744113","7":"-5.40352641","8":"-7.443467059","9":"1.882116e-10","_rn_":"54"},{"1":"(temperature20 sub-tropical) - (temperature30 sub-tropical)","2":"Pomacentrus","3":"-1.755679586","4":"0.2912959","5":"176","6":"-2.6892128","7":"-0.82214636","8":"-6.027133697","9":"4.249003e-07","_rn_":"55"},{"1":"(temperature20 sub-tropical) - (temperature40 sub-tropical)","2":"Pomacentrus","3":"-3.812962294","4":"0.5101147","5":"176","6":"-5.4477569","7":"-2.17816765","8":"-7.474715253","9":"1.572114e-10","_rn_":"56"},{"1":"(temperature20 sub-tropical) - (temperature50 sub-tropical)","2":"Pomacentrus","3":"-6.484463910","4":"0.8255788","5":"176","6":"-9.1302449","7":"-3.83868291","8":"-7.854445516","9":"1.724143e-11","_rn_":"57"},{"1":"(temperature20 sub-tropical) - temperature10 tropical","2":"Pomacentrus","3":"0.691925046","4":"0.3342535","5":"176","6":"-0.3792769","7":"1.76312702","8":"2.070060480","9":"5.510417e-01","_rn_":"58"},{"1":"(temperature20 sub-tropical) - temperature20 tropical","2":"Pomacentrus","3":"-0.707490693","4":"0.4310494","5":"176","6":"-2.0888999","7":"0.67391850","8":"-1.641321791","9":"8.258813e-01","_rn_":"59"},{"1":"(temperature20 sub-tropical) - temperature30 tropical","2":"Pomacentrus","3":"-2.448462211","4":"0.5920278","5":"176","6":"-4.3457686","7":"-0.55115583","8":"-4.135721496","9":"2.174011e-03","_rn_":"60"},{"1":"(temperature20 sub-tropical) - temperature40 tropical","2":"Pomacentrus","3":"-5.530081150","4":"0.9208487","5":"176","6":"-8.4811792","7":"-2.57898310","8":"-6.005417609","9":"4.747177e-07","_rn_":"61"},{"1":"(temperature20 sub-tropical) - temperature50 tropical","2":"Pomacentrus","3":"-8.795040407","4":"1.2884029","5":"176","6":"-12.9240611","7":"-4.66601976","8":"-6.826311975","9":"6.084698e-09","_rn_":"62"},{"1":"(temperature30 sub-tropical) - (temperature40 sub-tropical)","2":"Pomacentrus","3":"-2.057282708","4":"0.3170070","5":"176","6":"-3.0732138","7":"-1.04135164","8":"-6.489706878","9":"3.779226e-08","_rn_":"63"},{"1":"(temperature30 sub-tropical) - (temperature50 sub-tropical)","2":"Pomacentrus","3":"-4.728784325","4":"0.6150460","5":"176","6":"-6.6998584","7":"-2.75771021","8":"-7.688504980","9":"4.549816e-11","_rn_":"64"},{"1":"(temperature30 sub-tropical) - temperature10 tropical","2":"Pomacentrus","3":"2.447604632","4":"0.5082953","5":"176","6":"0.8186408","7":"4.07656844","8":"4.815320295","9":"1.345766e-04","_rn_":"65"},{"1":"(temperature30 sub-tropical) - temperature20 tropical","2":"Pomacentrus","3":"1.048188893","4":"0.5765768","5":"176","6":"-0.7996008","7":"2.89597860","8":"1.817951768","9":"7.230342e-01","_rn_":"66"},{"1":"(temperature30 sub-tropical) - temperature30 tropical","2":"Pomacentrus","3":"-0.692782626","4":"0.7050770","5":"176","6":"-2.9523844","7":"1.56681914","8":"-0.982563052","9":"9.929138e-01","_rn_":"67"},{"1":"(temperature30 sub-tropical) - temperature40 tropical","2":"Pomacentrus","3":"-3.774401564","4":"0.9972949","5":"176","6":"-6.9704912","7":"-0.57831192","8":"-3.784639333","9":"7.850417e-03","_rn_":"68"},{"1":"(temperature30 sub-tropical) - temperature50 tropical","2":"Pomacentrus","3":"-7.039360821","4":"1.3441034","5":"176","6":"-11.3468880","7":"-2.73183360","8":"-5.237216691","9":"2.014050e-05","_rn_":"69"},{"1":"(temperature40 sub-tropical) - (temperature50 sub-tropical)","2":"Pomacentrus","3":"-2.671501616","4":"0.3809121","5":"176","6":"-3.8922329","7":"-1.45077035","8":"-7.013434122","9":"2.156463e-09","_rn_":"70"},{"1":"(temperature40 sub-tropical) - temperature10 tropical","2":"Pomacentrus","3":"4.504887340","4":"0.7435029","5":"176","6":"2.1221397","7":"6.88763495","8":"6.059004008","9":"3.609321e-07","_rn_":"71"},{"1":"(temperature40 sub-tropical) - temperature20 tropical","2":"Pomacentrus","3":"3.105471601","4":"0.7917522","5":"176","6":"0.5680967","7":"5.64284649","8":"3.922277099","9":"4.810268e-03","_rn_":"72"},{"1":"(temperature40 sub-tropical) - temperature30 tropical","2":"Pomacentrus","3":"1.364500083","4":"0.8896985","5":"176","6":"-1.4867690","7":"4.21576921","8":"1.533665692","9":"8.767764e-01","_rn_":"73"},{"1":"(temperature40 sub-tropical) - temperature40 tropical","2":"Pomacentrus","3":"-1.717118856","4":"1.1353521","5":"176","6":"-5.3556486","7":"1.92141091","8":"-1.512410810","9":"8.856366e-01","_rn_":"74"},{"1":"(temperature40 sub-tropical) - temperature50 tropical","2":"Pomacentrus","3":"-4.982078113","4":"1.4494956","5":"176","6":"-9.6273618","7":"-0.33679441","8":"-3.437111632","9":"2.486738e-02","_rn_":"75"},{"1":"(temperature50 sub-tropical) - temperature10 tropical","2":"Pomacentrus","3":"7.176388957","4":"1.0624828","5":"176","6":"3.7713880","7":"10.58138990","8":"6.754358062","9":"9.030002e-09","_rn_":"76"},{"1":"(temperature50 sub-tropical) - temperature20 tropical","2":"Pomacentrus","3":"5.776973217","4":"1.0967872","5":"176","6":"2.2620349","7":"9.29191154","8":"5.267177977","9":"1.751930e-05","_rn_":"77"},{"1":"(temperature50 sub-tropical) - temperature30 tropical","2":"Pomacentrus","3":"4.036001699","4":"1.1694583","5":"176","6":"0.2881699","7":"7.78383353","8":"3.451171911","9":"2.379224e-02","_rn_":"78"},{"1":"(temperature50 sub-tropical) - temperature40 tropical","2":"Pomacentrus","3":"0.954382761","4":"1.3656831","5":"176","6":"-3.4223023","7":"5.33106778","8":"0.698831770","9":"9.994946e-01","_rn_":"79"},{"1":"(temperature50 sub-tropical) - temperature50 tropical","2":"Pomacentrus","3":"-2.310576496","4":"1.6361840","5":"176","6":"-7.5541515","7":"2.93299856","8":"-1.412173997","9":"9.220262e-01","_rn_":"80"},{"1":"temperature10 tropical - temperature20 tropical","2":"Pomacentrus","3":"-1.399415739","4":"0.2503323","5":"176","6":"-2.2016703","7":"-0.59716114","8":"-5.590232718","9":"3.758474e-06","_rn_":"81"},{"1":"temperature10 tropical - temperature30 tropical","2":"Pomacentrus","3":"-3.140387258","4":"0.4123952","5":"176","6":"-4.4620143","7":"-1.81876023","8":"-7.614995365","9":"6.980405e-11","_rn_":"82"},{"1":"temperature10 tropical - temperature40 tropical","2":"Pomacentrus","3":"-6.222006196","4":"0.7523813","5":"176","6":"-8.6332069","7":"-3.81080548","8":"-8.269750798","9":"1.568412e-12","_rn_":"83"},{"1":"temperature10 tropical - temperature50 tropical","2":"Pomacentrus","3":"-9.486965453","4":"1.1271752","5":"176","6":"-13.0992902","7":"-5.87464069","8":"-8.416584326","9":"7.170931e-13","_rn_":"84"},{"1":"temperature20 tropical - temperature30 tropical","2":"Pomacentrus","3":"-1.740971518","4":"0.2780065","5":"176","6":"-2.6319152","7":"-0.85002785","8":"-6.262341822","9":"1.258487e-07","_rn_":"85"},{"1":"temperature20 tropical - temperature40 tropical","2":"Pomacentrus","3":"-4.822590457","4":"0.5957059","5":"176","6":"-6.7316841","7":"-2.91349681","8":"-8.095589874","9":"4.217404e-12","_rn_":"86"},{"1":"temperature20 tropical - temperature50 tropical","2":"Pomacentrus","3":"-8.087549714","4":"0.9662647","5":"176","6":"-11.1841951","7":"-4.99090436","8":"-8.369911019","9":"9.132695e-13","_rn_":"87"},{"1":"temperature30 tropical - temperature40 tropical","2":"Pomacentrus","3":"-3.081618939","4":"0.4062731","5":"176","6":"-4.3836262","7":"-1.77961169","8":"-7.585092481","9":"8.303169e-11","_rn_":"88"},{"1":"temperature30 tropical - temperature50 tropical","2":"Pomacentrus","3":"-6.346578195","4":"0.7667416","5":"176","6":"-8.8038001","7":"-3.88935631","8":"-8.277336436","9":"1.503797e-12","_rn_":"89"},{"1":"temperature40 tropical - temperature50 tropical","2":"Pomacentrus","3":"-3.264959257","4":"0.4257018","5":"176","6":"-4.6292308","7":"-1.90068775","8":"-7.669592746","9":"5.080203e-11","_rn_":"90"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>

### effect size

```r
cs.emm <- cs.model.1.p2.log %>% emmeans(~temperature*LATITUDE*LATIN_GENUS)
eff_size(cs.emm, sigma = sigma(cs.model.1.p2.log), edf=df.residual(cs.model.1.p2.log))
```

```
##  contrast                                                                                                  
##  (temperature30.4494382022472 sub-tropical Apogon) - temperature30.4494382022472 tropical Apogon           
##  (temperature30.4494382022472 sub-tropical Apogon) - (temperature30.4494382022472 sub-tropical Pomacentrus)
##  (temperature30.4494382022472 sub-tropical Apogon) - temperature30.4494382022472 tropical Pomacentrus      
##  temperature30.4494382022472 tropical Apogon - (temperature30.4494382022472 sub-tropical Pomacentrus)      
##  temperature30.4494382022472 tropical Apogon - temperature30.4494382022472 tropical Pomacentrus            
##  (temperature30.4494382022472 sub-tropical Pomacentrus) - temperature30.4494382022472 tropical Pomacentrus 
##  effect.size    SE  df lower.CL upper.CL
##       0.0314 0.402 176   -0.761    0.824
##      -1.0061 0.409 176   -1.814   -0.199
##      -1.5249 0.403 176   -2.319   -0.730
##      -1.0375 0.400 176   -1.826   -0.249
##      -1.5563 0.393 176   -2.332   -0.781
##      -0.5188 0.389 176   -1.287    0.250
## 
## sigma used for effect sizes: 0.4449 
## Confidence level used: 0.95
```

### {-}

## Summary figure 



```r
cs.emm <- emmeans(cs.model.1.p2.log, ~temperature|LATITUDE|LATIN_GENUS, 
                   at = list(temperature = seq(from =10, to =50, by =.1)), 
                   type = "response") 

cs.emm.df <- cs.emm %>% as.data.frame() %>%
  unite("species", c("LATIN_GENUS","LATITUDE"), sep = "-", remove = FALSE) 

cs.obs <-  CS.data %>% 
  mutate(Pred=exp(predict(cs.model.1.p2.log, re.form=NA)),
         Resid = residuals(cs.model.1.p2.log,  type="response"),
         Fit = Pred + Resid) %>%
   unite("species", c("LATIN_GENUS","LATITUDE"), sep = "-", remove = FALSE) 


cs.plot <- ggplot(cs.emm.df, aes(y=response, x=temperature, linetype=species, color = species, fill=species))+
  geom_jitter(data=cs.obs, 
              aes(y=Fit, color = species), 
              width=0.05, 
              alpha = 0.3, 
              size = 2) +
  geom_line(linewidth =1) + 
  geom_ribbon(aes(x=temperature, 
              ymin= lower.CL, ymax= upper.CL),
              alpha = 0.2, 
              color=NA)+ 
  #scale_x_continuous(limits = c(9, 52), 
                     #breaks = seq(10, 52, by = 10))+ 
  #scale_y_continuous(limits = c(0,16), breaks = seq(0, 16, by = 2)) +
  theme_classic() + 
  ylab(expression("CS ACTIVITY (U mg "^{-1} * "tissue)")) + 
  xlab("")+
  scale_linetype_manual(values = c("solid", "dashed","solid", "dashed"), 
                        labels = c("Apogon doederlein","Apogon rubrimacula","Pomacentrus australis", "Pomacentrus moluccensis"))+
  scale_color_manual(values=c("#3F3525","#C65C1B",  "#07AFF2", "#EAAE00"), 
                        labels = c("Apogon doederlein","Apogon rubrimacula","Pomacentrus australis", "Pomacentrus moluccensis")) +
  scale_fill_manual(values=c("#3F3525","#C65C1B",  "#07AFF2", "#EAAE00"), 
                        labels = c("Apogon doederlein","Apogon rubrimacula","Pomacentrus australis", "Pomacentrus moluccensis")) +  
  theme(legend.position = "top", 
        legend.text = element_text(size = 10), 
        legend.title = element_blank(), 
        axis.title = element_text(size =12), 
        axis.text = element_text(size=10)); cs.plot
```

![](01.DataAnalysis_files/figure-html/cs-sum-fig-1.png)<!-- -->

## Arrhenius plot 

```r
cs.arrhenius.plot <- ggplot(cs.emm.df, aes(y=log(response), x=1/(temperature+273.15), linetype=species, color = species, fill=species))+
  geom_jitter(data=cs.obs, 
              aes(y=log(Fit), color = species), 
              #width=0.005, 
              alpha = 0.3, 
              size = 2) +
  stat_poly_line(method="lm", se = TRUE) + 
  stat_poly_eq(use_label(c("eq", "R2")), hjust = -1.6)+
  #geom_ribbon(aes(x=1/(temperature+273.15), 
              #ymin= log(asymp.LCL), ymax= log(asymp.UCL)),
              #alpha = 0.2, 
              #color=NA)+ 
  #scale_x_continuous(limits = c(9, 52), 
                     #breaks = seq(10, 52, by = 10))+ 
  #scale_y_continuous(limits = c(0,120), breaks = seq(0, 120, by = 20)) +
  theme_classic() + 
  ylab(expression("log(CS (U mg "^{-1} * "tissue))")) + 
  xlab("")+
  scale_linetype_manual(values = c("solid", "dashed","solid", "dashed"), 
                        labels = c("Apogon doederlein","Apogon rubrimacula","Pomacentrus australis", "Pomacentrus moluccensis"))+
  scale_color_manual(values=c("#3F3525","#C65C1B",  "#07AFF2", "#EAAE00"), 
                        labels = c("Apogon doederlein","Apogon rubrimacula","Pomacentrus australis", "Pomacentrus moluccensis")) +
  scale_fill_manual(values=c("#3F3525","#C65C1B",  "#07AFF2", "#EAAE00"), 
                        labels = c("Apogon doederlein","Apogon rubrimacula","Pomacentrus australis", "Pomacentrus moluccensis")) +  
  theme(legend.position = "top", 
        legend.text = element_text(size = 10), 
        legend.title = element_blank(), 
        axis.title = element_text(size =12), 
        axis.text = element_text(size=10)); cs.arrhenius.plot
```

![](01.DataAnalysis_files/figure-html/cs-arrhenius plot-1.png)<!-- -->
 
# CS:LDH ratio 

## Merge dataframes 

To start we will merge the lactate dehydrogenase (LDH) and citrate synthase (CS) dataframes


```r
lc.data <- CS.data |> 
  left_join(select(ldh.data, c("UNIQUE_SAMPLE_ID","LDH_ACTIVITY")), by = "UNIQUE_SAMPLE_ID") |> 
  mutate(LDHCS = LDH_ACTIVITY/CS_ACTIVITY) |> 
  drop_na(LDHCS)
```

## Initial plot {.tabset}

### LDH:CS v TEMPERATURE [SPECIES]


```r
ggplot(lc.data, aes(x =temperature, y= LDHCS, color = species)) + 
  geom_point() + 
  stat_smooth(method = "lm", se=FALSE) + 
  theme_classic() 
```

![](01.DataAnalysis_files/figure-html/lcr-initial-plots-1.png)<!-- -->

### LDH:CS [distribution]

```r
ggplot(lc.data, aes(x = LDHCS, fill = temperature, color = temperature)) + 
  geom_density(alpha =0.5, position = "identity") 
```

![](01.DataAnalysis_files/figure-html/lcr-initial-plots-2-1.png)<!-- -->

```r
ggplot(lc.data, aes(x=LDHCS)) + geom_histogram()
```

![](01.DataAnalysis_files/figure-html/lcr-initial-plots-2-2.png)<!-- -->

### LDH:CS v TEMPERATURE [LATITUDE]

```r
ggplot(lc.data, aes(x =temperature, y= LDHCS, colour = LATITUDE, fill=LATITUDE)) +   geom_point(alpha=0.3) + stat_smooth(method = "lm", se=TRUE,  formula=y ~ poly(x, 2, raw=TRUE), alpha=0.3) + facet_grid(~LATIN_GENUS) + theme_classic()
```

![](01.DataAnalysis_files/figure-html/lcr-initial-plots-3-1.png)<!-- -->

### LDH:CS v TEMPERATURE [GENUS]

```r
ggplot(lc.data, aes(x =temperature, y= LDHCS, colour = LATIN_GENUS, fill=LATIN_GENUS)) +   geom_point(alpha=0.3) + stat_smooth(method = "lm", se=TRUE,  formula=y ~ poly(x, 2, raw=TRUE), alpha=0.3) + facet_grid(~LATITUDE) + theme_classic()
```

![](01.DataAnalysis_files/figure-html/lcr-initial-plots-4-1.png)<!-- -->

### LDH:CS v TEMPERATURE [SPECIES]

```r
ggplot(lc.data, aes(x =temperature, y= LDHCS, colour = species, fill= species)) +   geom_point(alpha=0.3) + stat_smooth(method = "lm", se=TRUE,  formula=y ~ poly(x, 2, raw=TRUE), alpha=0.3) + theme_classic()
```

![](01.DataAnalysis_files/figure-html/lcr-initial-plots-5-1.png)<!-- -->

### {-} 

## Fit the model 

The model was fit using the **glm** and later **glmmTMB** packages in R. A number of different models were tested to determine which hypothesis and associated variables best predicted enzyme activity when measured as a ratio between lactate dehygronease and citrate synthase. Model fit was examined using AICc, BIC, and r-squared values. Additional model were examined via the validation diagnostics provided by the **performance**,**dHARMA**, and **plot_model** packages in R.

From out initial plots we can see that our data is heavily skewed to the right. From our initial plots we can all see that the relationship between enzyme activity (LDH:CS) and temperature is not linear, but rather may represent either a quadratic or cubic relationship. Let's start out model selection process by comparing different polynomial models.  

### polynomial models

```r
#--- model 1 ---# 
lc.model.1 <- glm(LDHCS ~ temperature * LATITUDE * LATIN_GENUS, 
               family = gaussian(),
               data = lc.data) 

lc.model.1.p2 <- glm(LDHCS ~ poly(temperature, 2) * LATITUDE * LATIN_GENUS, 
               family = gaussian(),
               data = lc.data)  

lc.model.1.p3 <- glm(LDHCS ~ poly(temperature, 3) * LATITUDE * LATIN_GENUS, 
               family = gaussian(),
               data = lc.data) 
```

#### model comparisons - polynomial models 

```r
aic.c=AICc(lc.model.1, lc.model.1.p2, lc.model.1.p3, k=2) 
bic=BIC(lc.model.1, lc.model.1.p2, lc.model.1.p3)

model.fit.table <- as.data.frame(aic.c) %>% 
  tibble::rownames_to_column("model") %>%
  mutate(BIC = bic$BIC, 
         r2 = c(r.squaredLR(lc.model.1)[1], r.squaredLR(lc.model.1.p2)[1], r.squaredLR(lc.model.1.p3)[1]))
model.fit.table %>% knitr::kable(format = "html")  %>%
  kable_paper(full_width = TRUE) 
```

<table class=" lightable-paper" style='font-family: "Arial Narrow", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>
 <thead>
  <tr>
   <th style="text-align:left;"> model </th>
   <th style="text-align:right;"> df </th>
   <th style="text-align:right;"> AICc </th>
   <th style="text-align:right;"> BIC </th>
   <th style="text-align:right;"> r2 </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> lc.model.1 </td>
   <td style="text-align:right;"> 9 </td>
   <td style="text-align:right;"> 1293.297 </td>
   <td style="text-align:right;"> 1320.334 </td>
   <td style="text-align:right;"> 0.6275226 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> lc.model.1.p2 </td>
   <td style="text-align:right;"> 13 </td>
   <td style="text-align:right;"> 1254.304 </td>
   <td style="text-align:right;"> 1292.644 </td>
   <td style="text-align:right;"> 0.7199652 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> lc.model.1.p3 </td>
   <td style="text-align:right;"> 17 </td>
   <td style="text-align:right;"> 1258.352 </td>
   <td style="text-align:right;"> 1307.508 </td>
   <td style="text-align:right;"> 0.7291822 </td>
  </tr>
</tbody>
</table>

```r
anova(lc.model.1, lc.model.1.p2, lc.model.1.p3, test = "Chisq")
```

<div data-pagedtable="false">
  <script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Resid. Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Resid. Dev"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Deviance"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chi)"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"161","2":"18610.07","3":"NA","4":"NA","5":"NA","_rn_":"1"},{"1":"157","2":"13991.37","3":"4","4":"4618.703","5":"1.237262e-10","_rn_":"2"},{"1":"153","2":"13530.86","3":"4","4":"460.510","5":"2.666894e-01","_rn_":"3"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>

Looks like the model where temperature is treated as a second order polynomial (quadratic model) is better than the first and third order polynomial models. **Tissue mass** did not improve the model when looking at either lactate dehydrogenase or citrate synthase, therefore we will not be including it in the LDH:CS ratio analysis.

Because tissue samples from the same fish were tested at multiple temperatures we need to include **fish_id** as a random factor. 

### Generalised linear mixed model (GLMM)

```r
lc.model.1.p2 <- glmmTMB(LDHCS ~ poly(temperature, 2) * LATITUDE * LATIN_GENUS + (1|fish_id), 
               family = gaussian(),
               REML = TRUE,
               data = lc.data) 
```

Great! Now lets check our model validations to see how the model is performing. 

## Model validation {.tabset}

### lc.model.1 [performance]


```r
lc.model.1.p2 %>% check_model(detrend = FALSE)
```

![](01.DataAnalysis_files/figure-html/lcr-model-validatiaon-1-1.png)<!-- -->

### lc.model.1 [DHARMa]


```r
lc.model.1.p2 %>% simulateResiduals(plot=TRUE)
```

![](01.DataAnalysis_files/figure-html/lcr-model-validatiaon-2-1.png)<!-- -->

```
Object of Class DHARMa with simulated residuals based on 250 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. 
 
Scaled residual values: 0.28 0.988 0.78 0.368 1 0.568 0.74 0.836 1 0.796 0.328 0.188 0.968 0.988 0.136 0.26 0.04 0 0.968 0.604 ...
```

```r
lc.model.1.p2 %>% DHARMa::testResiduals(plot=TRUE)
```

![](01.DataAnalysis_files/figure-html/lcr-model-validatiaon-2-2.png)<!-- -->

```
$uniformity

	Asymptotic one-sample Kolmogorov-Smirnov test

data:  simulationOutput$scaledResiduals
D = 0.16123, p-value = 0.0003056
alternative hypothesis: two-sided


$dispersion

	DHARMa nonparametric dispersion test via sd of residuals fitted vs.
	simulated

data:  simulationOutput
dispersion = 0.92406, p-value = 0.544
alternative hypothesis: two.sided


$outliers

	DHARMa outlier test based on exact binomial test with approximate
	expectations

data:  simulationOutput
outliers at both margin(s) = 8, observations = 169, p-value = 7.281e-05
alternative hypothesis: true probability of success is not equal to 0.007968127
95 percent confidence interval:
 0.02065554 0.09114038
sample estimates:
frequency of outliers (expected: 0.00796812749003984 ) 
                                            0.04733728 
```

```
$uniformity

	Asymptotic one-sample Kolmogorov-Smirnov test

data:  simulationOutput$scaledResiduals
D = 0.16123, p-value = 0.0003056
alternative hypothesis: two-sided


$dispersion

	DHARMa nonparametric dispersion test via sd of residuals fitted vs.
	simulated

data:  simulationOutput
dispersion = 0.92406, p-value = 0.544
alternative hypothesis: two.sided


$outliers

	DHARMa outlier test based on exact binomial test with approximate
	expectations

data:  simulationOutput
outliers at both margin(s) = 8, observations = 169, p-value = 7.281e-05
alternative hypothesis: true probability of success is not equal to 0.007968127
95 percent confidence interval:
 0.02065554 0.09114038
sample estimates:
frequency of outliers (expected: 0.00796812749003984 ) 
                                            0.04733728 
```

### lc.model.1 [plot model]

```r
par(mar=c(2,2,2,2))
lc.model.1.p2 %>% plot_model(type = "diag")
```

```
[[1]]
```

```

[[2]]
[[2]]$fish_id
```

```


[[3]]
```

```

[[4]]
```


<img src="01.DataAnalysis_files/figure-html/lcr-model-validatiaon-3-1.png" width="50%" /><img src="01.DataAnalysis_files/figure-html/lcr-model-validatiaon-3-2.png" width="50%" /><img src="01.DataAnalysis_files/figure-html/lcr-model-validatiaon-3-3.png" width="50%" /><img src="01.DataAnalysis_files/figure-html/lcr-model-validatiaon-3-4.png" width="50%" />

Our initial model (gaussian distribution) does not seem to function well. The predictive model does not fit the observed data, and the qq-plot also does not do a good job of ensuring that sample quantiles fit within the expectations of a gaussian distribution. Unexpectedly there are a number of issues also brought up with the DHARMa checks, KS-test is significant, and so is the deviation of the model quantiles from thier expectations. Similar trends can found in the plot_model output as well. 

Lets start by changing the link distribution used within the model to see if this helps the model out.

### {-}

## Re-fitting model 

Turn **REML** off when comparing models

### re-fitting models [link functions]


```r
lc.model.1.p2 <-  lc.model.1.p2 %>% update(REML = FALSE)
lc.model.1.p2.log <- lc.model.1.p2 %>% update(family=gaussian(link="log"), 
                                              REML=FALSE) 
lc.model.1.p2.sqrt <- lc.model.1.p2 %>% update(family=gaussian(link="sqrt"), 
                                               REML=FALSE) 
```

### re-fit model comparisons [link function]


```r
aic.c=AICc(lc.model.1.p2, lc.model.1.p2.log, lc.model.1.p2.sqrt,  k=2) 
bic=BIC(lc.model.1.p2, lc.model.1.p2.log, lc.model.1.p2.sqrt)

model.fit.table <- as.data.frame(aic.c) %>% 
  tibble::rownames_to_column("model") %>%
  mutate(BIC = bic$BIC, 
         r2 = c(r.squaredGLMM(lc.model.1.p2)[1], r.squaredGLMM(lc.model.1.p2.log)[1], r.squaredGLMM(lc.model.1.p2.sqrt)[1]))
model.fit.table %>% knitr::kable(format = "html")  %>%
  kable_paper(full_width = TRUE) 
```

<table class=" lightable-paper" style='font-family: "Arial Narrow", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>
 <thead>
  <tr>
   <th style="text-align:left;"> model </th>
   <th style="text-align:right;"> df </th>
   <th style="text-align:right;"> AICc </th>
   <th style="text-align:right;"> BIC </th>
   <th style="text-align:right;"> r2 </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> lc.model.1.p2 </td>
   <td style="text-align:right;"> 14 </td>
   <td style="text-align:right;"> 1216.195 </td>
   <td style="text-align:right;"> 1257.286 </td>
   <td style="text-align:right;"> 0.7232741 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> lc.model.1.p2.log </td>
   <td style="text-align:right;"> 14 </td>
   <td style="text-align:right;"> 1157.202 </td>
   <td style="text-align:right;"> 1198.293 </td>
   <td style="text-align:right;"> 0.0156265 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> lc.model.1.p2.sqrt </td>
   <td style="text-align:right;"> 14 </td>
   <td style="text-align:right;"> 1171.686 </td>
   <td style="text-align:right;"> 1212.777 </td>
   <td style="text-align:right;"> 0.0624606 </td>
  </tr>
</tbody>
</table>

```r
anova(lc.model.1.p2, lc.model.1.p2.log, lc.model.1.p2.sqrt, test = "Chisq")
```

<div data-pagedtable="false">
  <script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["BIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["logLik"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["deviance"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Chisq"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["Chi Df"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chisq)"],"name":[8],"type":["dbl"],"align":["right"]}],"data":[{"1":"14","2":"1213.467","3":"1257.286","4":"-592.7337","5":"1185.467","6":"NA","7":"NA","8":"NA","_rn_":"lc.model.1.p2"},{"1":"14","2":"1154.474","3":"1198.293","4":"-563.2371","5":"1126.474","6":"58.99316","7":"0","8":"0","_rn_":"lc.model.1.p2.log"},{"1":"14","2":"1168.959","3":"1212.777","4":"-570.4794","5":"1140.959","6":"0.00000","7":"0","8":"1","_rn_":"lc.model.1.p2.sqrt"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>

From our model outputs it looks like transforming the data via a log-link function seems to help. However, we will have to explore that data further as the r-squared value drops drastically

## Model re-validation {.tabset}


```r
lc.model.1.p2.log <- lc.model.1.p2.log %>% update(REML=TRUE)
```

### lc.model.1.p2.log [performance]


```r
lc.model.1.p2.log %>% check_model(detrend=FALSE)
```

![](01.DataAnalysis_files/figure-html/lc-model-re-validatiaon-1-1.png)<!-- -->

### lc.model.1.p2.log [DHARMa]


```r
lc.model.1.p2.log %>% simulateResiduals(plot=TRUE)
```

![](01.DataAnalysis_files/figure-html/lc-model-re-validatiaon-2-1.png)<!-- -->

```
## Object of Class DHARMa with simulated residuals based on 250 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. 
##  
## Scaled residual values: 0.332 0.964 0.808 0.508 1 0.444 0.712 0.836 0.92 0.868 0.152 0.136 0.944 0.848 0.02 0.2 0.124 0.032 0.98 0.472 ...
```

```r
lc.model.1.p2.log %>% DHARMa::testResiduals(plot=TRUE)
```

![](01.DataAnalysis_files/figure-html/lc-model-re-validatiaon-2-2.png)<!-- -->

```
## $uniformity
## 
## 	Asymptotic one-sample Kolmogorov-Smirnov test
## 
## data:  simulationOutput$scaledResiduals
## D = 0.13614, p-value = 0.003805
## alternative hypothesis: two-sided
## 
## 
## $dispersion
## 
## 	DHARMa nonparametric dispersion test via sd of residuals fitted vs.
## 	simulated
## 
## data:  simulationOutput
## dispersion = 1.018, p-value = 0.752
## alternative hypothesis: two.sided
## 
## 
## $outliers
## 
## 	DHARMa outlier test based on exact binomial test with approximate
## 	expectations
## 
## data:  simulationOutput
## outliers at both margin(s) = 2, observations = 169, p-value = 0.3901
## alternative hypothesis: true probability of success is not equal to 0.007968127
## 95 percent confidence interval:
##  0.001436418 0.042093896
## sample estimates:
## frequency of outliers (expected: 0.00796812749003984 ) 
##                                             0.01183432
```

```
## $uniformity
## 
## 	Asymptotic one-sample Kolmogorov-Smirnov test
## 
## data:  simulationOutput$scaledResiduals
## D = 0.13614, p-value = 0.003805
## alternative hypothesis: two-sided
## 
## 
## $dispersion
## 
## 	DHARMa nonparametric dispersion test via sd of residuals fitted vs.
## 	simulated
## 
## data:  simulationOutput
## dispersion = 1.018, p-value = 0.752
## alternative hypothesis: two.sided
## 
## 
## $outliers
## 
## 	DHARMa outlier test based on exact binomial test with approximate
## 	expectations
## 
## data:  simulationOutput
## outliers at both margin(s) = 2, observations = 169, p-value = 0.3901
## alternative hypothesis: true probability of success is not equal to 0.007968127
## 95 percent confidence interval:
##  0.001436418 0.042093896
## sample estimates:
## frequency of outliers (expected: 0.00796812749003984 ) 
##                                             0.01183432
```

### lc.model.1.p2.log [plot_model]

```r
par(mar=c(2,2,2,2))
lc.model.1.p2.log %>% plot_model(type = "diag")
```

```
## [[1]]
```

```
## 
## [[2]]
## [[2]]$fish_id
```

```
## 
## 
## [[3]]
```

```
## 
## [[4]]
```


<img src="01.DataAnalysis_files/figure-html/lc-model-re-validatiaon-3-1.png" width="50%" /><img src="01.DataAnalysis_files/figure-html/lc-model-re-validatiaon-3-2.png" width="50%" /><img src="01.DataAnalysis_files/figure-html/lc-model-re-validatiaon-3-3.png" width="50%" /><img src="01.DataAnalysis_files/figure-html/lc-model-re-validatiaon-3-4.png" width="50%" />
### {-}

The log-link version of the model still has a number of issues, including a significant results for KS-test and quantile distributions, which shows that predicted data does not match the expected quantiles of a gaussian distribution and therefore violates assumptions within the gaussian distribution. 

Because out data is continuous and all positive we can try to see if a Gamma distribution does a better job at modelling the data. We can also try fitting a Gamma distribution with a log-link function as well (the default for gamma is 'inverse').

## Re-re-fitting model 

Turn **REML** off when comparing models

### re-fitting models [link functions]


```r
lc.model.1.p2 <-  lc.model.1.p2 %>% update(REML = FALSE)
lc.model.1.p2.log <-  lc.model.1.p2.log %>% update(REML = FALSE)
lc.model.1.p2.gamma <- lc.model.1.p2 %>% update(family=Gamma(), 
                                              REML=FALSE) 
lc.model.1.p2.gamma.log <- lc.model.1.p2 %>% update(family=Gamma(link="log"), 
                                              REML=FALSE)
```


```r
aic.c=AICc(lc.model.1.p2, lc.model.1.p2.log, lc.model.1.p2.gamma, lc.model.1.p2.gamma.log,   k=2) 
bic=BIC(lc.model.1.p2, lc.model.1.p2.log, lc.model.1.p2.gamma, lc.model.1.p2.gamma.log )

model.fit.table <- as.data.frame(aic.c) %>% 
  tibble::rownames_to_column("model") %>%
  mutate(BIC = bic$BIC, 
         r2 = c(r.squaredGLMM(lc.model.1.p2)[1], r.squaredGLMM(lc.model.1.p2.log)[1], r.squaredGLMM(lc.model.1.p2.gamma)[1], r.squaredGLMM(lc.model.1.p2.gamma.log)[1]))
model.fit.table %>% knitr::kable(format = "html")  %>%
  kable_paper(full_width = TRUE) 
```

<table class=" lightable-paper" style='font-family: "Arial Narrow", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>
 <thead>
  <tr>
   <th style="text-align:left;"> model </th>
   <th style="text-align:right;"> df </th>
   <th style="text-align:right;"> AICc </th>
   <th style="text-align:right;"> BIC </th>
   <th style="text-align:right;"> r2 </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> lc.model.1.p2 </td>
   <td style="text-align:right;"> 14 </td>
   <td style="text-align:right;"> 1216.195 </td>
   <td style="text-align:right;"> 1257.286 </td>
   <td style="text-align:right;"> 0.7232741 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> lc.model.1.p2.log </td>
   <td style="text-align:right;"> 14 </td>
   <td style="text-align:right;"> 1157.202 </td>
   <td style="text-align:right;"> 1198.293 </td>
   <td style="text-align:right;"> 0.0156265 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> lc.model.1.p2.gamma </td>
   <td style="text-align:right;"> 14 </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 0.1049388 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> lc.model.1.p2.gamma.log </td>
   <td style="text-align:right;"> 14 </td>
   <td style="text-align:right;"> 1087.798 </td>
   <td style="text-align:right;"> 1128.889 </td>
   <td style="text-align:right;"> 0.7045121 </td>
  </tr>
</tbody>
</table>

```r
anova(lc.model.1.p2, lc.model.1.p2.log, lc.model.1.p2.gamma, lc.model.1.p2.gamma.log,  test = "Chisq")
```

<div data-pagedtable="false">
  <script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["BIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["logLik"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["deviance"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Chisq"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["Chi Df"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chisq)"],"name":[8],"type":["dbl"],"align":["right"]}],"data":[{"1":"14","2":"1213.467","3":"1257.286","4":"-592.7337","5":"1185.467","6":"NA","7":"NA","8":"NA","_rn_":"lc.model.1.p2"},{"1":"14","2":"1154.474","3":"1198.293","4":"-563.2371","5":"1126.474","6":"58.99316","7":"0","8":"0","_rn_":"lc.model.1.p2.log"},{"1":"14","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"0","8":"NA","_rn_":"lc.model.1.p2.gamma"},{"1":"14","2":"1085.070","3":"1128.889","4":"-528.5352","5":"1057.070","6":"NA","7":"0","8":"NA","_rn_":"lc.model.1.p2.gamma.log"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>

The gamma model seems to help when using a log. Lets look at the model validation to see if it is an appropriate model to use. 

## Model re-re-validation {.tabset}

Turn REML on 


```r
lc.model.1.p2.gamma.log <- lc.model.1.p2.gamma.log %>% update(REML=TRUE) 
```

### [performance] 

#### lc.model.1.p2.gamma.log


```r
lc.model.1.p2.gamma.log %>% check_model(detrend=FALSE)
```

![](01.DataAnalysis_files/figure-html/lc-model-re-re-validatiaon-1-1.png)<!-- -->


### [DHARMa] 

#### lc.model.1.p2.gamma.log

```r
lc.model.1.p2.gamma.log %>% simulateResiduals(plot=TRUE)
```

![](01.DataAnalysis_files/figure-html/lc-model-re-32-validatiaon-1.2-1.png)<!-- -->

```
## Object of Class DHARMa with simulated residuals based on 250 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. 
##  
## Scaled residual values: 0.3 0.98 0.848 0.452 0.988 0.644 0.84 0.832 0.788 0.888 0.24 0.256 0.936 0.692 0.012 0.372 0.364 0.06 0.98 0.724 ...
```

```r
lc.model.1.p2.gamma.log %>% DHARMa::testResiduals(plot=TRUE)
```

![](01.DataAnalysis_files/figure-html/lc-model-re-32-validatiaon-1.2-2.png)<!-- -->

```
## $uniformity
## 
## 	Asymptotic one-sample Kolmogorov-Smirnov test
## 
## data:  simulationOutput$scaledResiduals
## D = 0.048899, p-value = 0.8138
## alternative hypothesis: two-sided
## 
## 
## $dispersion
## 
## 	DHARMa nonparametric dispersion test via sd of residuals fitted vs.
## 	simulated
## 
## data:  simulationOutput
## dispersion = 0.65492, p-value = 0.288
## alternative hypothesis: two.sided
## 
## 
## $outliers
## 
## 	DHARMa outlier test based on exact binomial test with approximate
## 	expectations
## 
## data:  simulationOutput
## outliers at both margin(s) = 0, observations = 169, p-value = 0.6488
## alternative hypothesis: true probability of success is not equal to 0.007968127
## 95 percent confidence interval:
##  0.00000000 0.02159119
## sample estimates:
## frequency of outliers (expected: 0.00796812749003984 ) 
##                                                      0
```

```
## $uniformity
## 
## 	Asymptotic one-sample Kolmogorov-Smirnov test
## 
## data:  simulationOutput$scaledResiduals
## D = 0.048899, p-value = 0.8138
## alternative hypothesis: two-sided
## 
## 
## $dispersion
## 
## 	DHARMa nonparametric dispersion test via sd of residuals fitted vs.
## 	simulated
## 
## data:  simulationOutput
## dispersion = 0.65492, p-value = 0.288
## alternative hypothesis: two.sided
## 
## 
## $outliers
## 
## 	DHARMa outlier test based on exact binomial test with approximate
## 	expectations
## 
## data:  simulationOutput
## outliers at both margin(s) = 0, observations = 169, p-value = 0.6488
## alternative hypothesis: true probability of success is not equal to 0.007968127
## 95 percent confidence interval:
##  0.00000000 0.02159119
## sample estimates:
## frequency of outliers (expected: 0.00796812749003984 ) 
##                                                      0
```

### {-} 

This model does not violate any assumptions and therefore we can start to look at the results.  

## Partial plots {.tabset} 

### ggemmeans {.tabset} 

#### TEMPERATURE V LATITUDE

![](01.DataAnalysis_files/figure-html/lcr-partial-plots-1-1.png)<!-- -->

#### TEMPERATURE V GENUS

![](01.DataAnalysis_files/figure-html/lcr-partial-plots-1b-1.png)<!-- -->

#### TEMPERATURE V GENUS V LATITUDE

![](01.DataAnalysis_files/figure-html/lcr-partial-plots-1c-1.png)<!-- -->

### plot_model 

![](01.DataAnalysis_files/figure-html/lcr-partial-plots-1d-1.png)<!-- -->

#### {-}

### {-}

## Model investigation {.tabset .tabset-pills}

### summary 
<table class=" lightable-paper" style='font-family: "Arial Narrow", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:right;"> Estimate </th>
   <th style="text-align:right;"> StdError </th>
   <th style="text-align:right;"> Zvalue </th>
   <th style="text-align:right;"> Pvalue </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> (Intercept) </td>
   <td style="text-align:right;"> 3.1946626 </td>
   <td style="text-align:right;"> 0.1096844 </td>
   <td style="text-align:right;"> 29.1259588 </td>
   <td style="text-align:right;"> 0.0000000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2)1 </td>
   <td style="text-align:right;"> 7.3408837 </td>
   <td style="text-align:right;"> 0.8544045 </td>
   <td style="text-align:right;"> 8.5918134 </td>
   <td style="text-align:right;"> 0.0000000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2)2 </td>
   <td style="text-align:right;"> 2.9817251 </td>
   <td style="text-align:right;"> 0.8443918 </td>
   <td style="text-align:right;"> 3.5312102 </td>
   <td style="text-align:right;"> 0.0004137 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> LATITUDEtropical </td>
   <td style="text-align:right;"> -0.5106248 </td>
   <td style="text-align:right;"> 0.1527589 </td>
   <td style="text-align:right;"> -3.3426849 </td>
   <td style="text-align:right;"> 0.0008297 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> LATIN_GENUSPomacentrus </td>
   <td style="text-align:right;"> -1.0400144 </td>
   <td style="text-align:right;"> 0.1645946 </td>
   <td style="text-align:right;"> -6.3186425 </td>
   <td style="text-align:right;"> 0.0000000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2)1:LATITUDEtropical </td>
   <td style="text-align:right;"> -0.9620851 </td>
   <td style="text-align:right;"> 1.2366484 </td>
   <td style="text-align:right;"> -0.7779779 </td>
   <td style="text-align:right;"> 0.4365821 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2)2:LATITUDEtropical </td>
   <td style="text-align:right;"> 0.0182144 </td>
   <td style="text-align:right;"> 1.2329079 </td>
   <td style="text-align:right;"> 0.0147735 </td>
   <td style="text-align:right;"> 0.9882128 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2)1:LATIN_GENUSPomacentrus </td>
   <td style="text-align:right;"> -0.7821338 </td>
   <td style="text-align:right;"> 1.2625364 </td>
   <td style="text-align:right;"> -0.6194941 </td>
   <td style="text-align:right;"> 0.5355909 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2)2:LATIN_GENUSPomacentrus </td>
   <td style="text-align:right;"> 0.7577820 </td>
   <td style="text-align:right;"> 1.2724884 </td>
   <td style="text-align:right;"> 0.5955119 </td>
   <td style="text-align:right;"> 0.5515013 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> LATITUDEtropical:LATIN_GENUSPomacentrus </td>
   <td style="text-align:right;"> 0.4921850 </td>
   <td style="text-align:right;"> 0.2215114 </td>
   <td style="text-align:right;"> 2.2219392 </td>
   <td style="text-align:right;"> 0.0262874 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2)1:LATITUDEtropical:LATIN_GENUSPomacentrus </td>
   <td style="text-align:right;"> 1.3732146 </td>
   <td style="text-align:right;"> 1.7399056 </td>
   <td style="text-align:right;"> 0.7892466 </td>
   <td style="text-align:right;"> 0.4299679 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2)2:LATITUDEtropical:LATIN_GENUSPomacentrus </td>
   <td style="text-align:right;"> -0.5330759 </td>
   <td style="text-align:right;"> 1.7452125 </td>
   <td style="text-align:right;"> -0.3054505 </td>
   <td style="text-align:right;"> 0.7600231 </td>
  </tr>
</tbody>
</table>

### anova 
<table class=" lightable-paper" style='font-family: "Arial Narrow", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:right;"> Chisq </th>
   <th style="text-align:right;"> Df </th>
   <th style="text-align:right;"> Pr(&gt;Chisq) </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2) </td>
   <td style="text-align:right;"> 281.2878379 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.0000000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> LATITUDE </td>
   <td style="text-align:right;"> 6.3632438 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0116508 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> LATIN_GENUS </td>
   <td style="text-align:right;"> 48.6147551 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0000000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2):LATITUDE </td>
   <td style="text-align:right;"> 0.1568395 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.9245763 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2):LATIN_GENUS </td>
   <td style="text-align:right;"> 0.3095348 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.8566144 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> LATITUDE:LATIN_GENUS </td>
   <td style="text-align:right;"> 4.9747905 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0257193 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2):LATITUDE:LATIN_GENUS </td>
   <td style="text-align:right;"> 0.7807472 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.6768040 </td>
  </tr>
</tbody>
</table>

### confint 
<table class=" lightable-paper" style='font-family: "Arial Narrow", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:right;"> 2.5 % </th>
   <th style="text-align:right;"> 97.5 % </th>
   <th style="text-align:right;"> Estimate </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> (Intercept) </td>
   <td style="text-align:right;"> 2.9796852 </td>
   <td style="text-align:right;"> 3.4096401 </td>
   <td style="text-align:right;"> 3.1946626 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2)1 </td>
   <td style="text-align:right;"> 5.6662817 </td>
   <td style="text-align:right;"> 9.0154857 </td>
   <td style="text-align:right;"> 7.3408837 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2)2 </td>
   <td style="text-align:right;"> 1.3267475 </td>
   <td style="text-align:right;"> 4.6367026 </td>
   <td style="text-align:right;"> 2.9817251 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> LATITUDEtropical </td>
   <td style="text-align:right;"> -0.8100267 </td>
   <td style="text-align:right;"> -0.2112229 </td>
   <td style="text-align:right;"> -0.5106248 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> LATIN_GENUSPomacentrus </td>
   <td style="text-align:right;"> -1.3626138 </td>
   <td style="text-align:right;"> -0.7174149 </td>
   <td style="text-align:right;"> -1.0400144 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2)1:LATITUDEtropical </td>
   <td style="text-align:right;"> -3.3858713 </td>
   <td style="text-align:right;"> 1.4617012 </td>
   <td style="text-align:right;"> -0.9620851 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2)2:LATITUDEtropical </td>
   <td style="text-align:right;"> -2.3982407 </td>
   <td style="text-align:right;"> 2.4346696 </td>
   <td style="text-align:right;"> 0.0182144 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2)1:LATIN_GENUSPomacentrus </td>
   <td style="text-align:right;"> -3.2566597 </td>
   <td style="text-align:right;"> 1.6923921 </td>
   <td style="text-align:right;"> -0.7821338 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2)2:LATIN_GENUSPomacentrus </td>
   <td style="text-align:right;"> -1.7362495 </td>
   <td style="text-align:right;"> 3.2518135 </td>
   <td style="text-align:right;"> 0.7577820 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> LATITUDEtropical:LATIN_GENUSPomacentrus </td>
   <td style="text-align:right;"> 0.0580305 </td>
   <td style="text-align:right;"> 0.9263394 </td>
   <td style="text-align:right;"> 0.4921850 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2)1:LATITUDEtropical:LATIN_GENUSPomacentrus </td>
   <td style="text-align:right;"> -2.0369377 </td>
   <td style="text-align:right;"> 4.7833669 </td>
   <td style="text-align:right;"> 1.3732146 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> poly(temperature, 2)2:LATITUDEtropical:LATIN_GENUSPomacentrus </td>
   <td style="text-align:right;"> -3.9536296 </td>
   <td style="text-align:right;"> 2.8874777 </td>
   <td style="text-align:right;"> -0.5330759 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Std.Dev.(Intercept)|fish_id </td>
   <td style="text-align:right;"> 0.1809393 </td>
   <td style="text-align:right;"> 0.3872273 </td>
   <td style="text-align:right;"> 0.2646973 </td>
  </tr>
</tbody>
</table>

### r-squared
<table class=" lightable-paper" style='font-family: "Arial Narrow", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>
 <thead>
  <tr>
   <th style="text-align:right;"> R2_conditional </th>
   <th style="text-align:right;"> R2_marginal </th>
   <th style="text-align:left;"> optional </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:right;"> 0.7757235 </td>
   <td style="text-align:right;"> 0.6867299 </td>
   <td style="text-align:left;"> FALSE </td>
  </tr>
</tbody>
</table>

## Pairwise comparisons {.tabset .tabset-faded} 

### emtrends 


```r
lc.model.1.p2.gamma.log %>% emtrends(var = "temperature", type = "response") %>% pairs(by = "temperature") %>% summary(by = NULL, adjust = "sidak", infer=TRUE)
```

<div data-pagedtable="false">
  <script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["contrast"],"name":[1],"type":["fct"],"align":["left"]},{"label":["temperature"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["estimate"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["SE"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["asymp.LCL"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["asymp.UCL"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["z.ratio"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[9],"type":["dbl"],"align":["right"]}],"data":[{"1":"(sub-tropical Apogon) - tropical Apogon","2":"30.4142","3":"0.005251232","4":"0.006837304","5":"Inf","6":"-0.01273798","7":"0.02324044","8":"0.7680267","9":"0.9699667","_rn_":"1"},{"1":"(sub-tropical Apogon) - (sub-tropical Pomacentrus)","2":"30.4142","3":"0.003964050","4":"0.006977531","5":"Inf","6":"-0.01439410","7":"0.02232220","8":"0.5681165","9":"0.9936747","_rn_":"2"},{"1":"(sub-tropical Apogon) - tropical Pomacentrus","2":"30.4142","3":"0.001928177","4":"0.006449633","5":"Inf","6":"-0.01504105","7":"0.01889741","8":"0.2989592","9":"0.9998315","_rn_":"3"},{"1":"tropical Apogon - (sub-tropical Pomacentrus)","2":"30.4142","3":"-0.001287182","4":"0.007134800","5":"Inf","6":"-0.02005911","7":"0.01748475","8":"-0.1804089","9":"0.9999914","_rn_":"4"},{"1":"tropical Apogon - tropical Pomacentrus","2":"30.4142","3":"-0.003323055","4":"0.006620220","5":"Inf","6":"-0.02074111","7":"0.01409500","8":"-0.5019554","9":"0.9967787","_rn_":"5"},{"1":"(sub-tropical Pomacentrus) - tropical Pomacentrus","2":"30.4142","3":"-0.002035873","4":"0.006763166","5":"Inf","6":"-0.01983002","7":"0.01575827","8":"-0.3010237","9":"0.9998246","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
SCROLL TO THE RIGHT -->

The numbers in the left most column in the table just mention that the slopes are assuming mean **MASS_CENTERED** and **RESTING_TIME_SEONDS** values when looking at differences between latitudinal slopes.

### emmeans 

```r
lc.model.1.p2.gamma.log %>% emmeans(pairwise ~ temperature*LATITUDE*LATIN_GENUS, type = "response") %>% regrid() %>% pairs(by = "temperature") %>% summary(by = NULL, adjust = "sidak", infer=TRUE)
```

<div data-pagedtable="false">
  <script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["contrast"],"name":[1],"type":["fct"],"align":["left"]},{"label":["temperature"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["estimate"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["SE"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["asymp.LCL"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["asymp.UCL"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["z.ratio"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[9],"type":["dbl"],"align":["right"]}],"data":[{"1":"(sub-tropical Apogon) - tropical Apogon","2":"30.4142","3":"7.4601479","4":"2.885137","5":"Inf","6":"-0.1307584","7":"15.051054","8":"2.5857169","9":"5.690775e-02","_rn_":"1"},{"1":"(sub-tropical Apogon) - (sub-tropical Pomacentrus)","2":"30.4142","3":"12.4699023","4":"2.646606","5":"Inf","6":"5.5065804","7":"19.433224","8":"4.7116579","9":"1.474249e-05","_rn_":"2"},{"1":"(sub-tropical Apogon) - tropical Pomacentrus","2":"30.4142","3":"12.2933455","4":"2.605193","5":"Inf","6":"5.4389833","7":"19.147708","8":"4.7187852","9":"1.423535e-05","_rn_":"3"},{"1":"tropical Apogon - (sub-tropical Pomacentrus)","2":"30.4142","3":"5.0097544","4":"1.742872","5":"Inf","6":"0.4241914","7":"9.595317","8":"2.8744247","9":"2.404143e-02","_rn_":"4"},{"1":"tropical Apogon - tropical Pomacentrus","2":"30.4142","3":"4.8331975","4":"1.679385","5":"Inf","6":"0.4146720","7":"9.251723","8":"2.8779573","9":"2.377653e-02","_rn_":"5"},{"1":"(sub-tropical Pomacentrus) - tropical Pomacentrus","2":"30.4142","3":"-0.1765569","4":"1.220881","5":"Inf","6":"-3.3887424","7":"3.035629","8":"-0.1446143","9":"9.999977e-01","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>

### temperature 

```r
lc.model.1.p2.gamma.log %>% emmeans(~ temperature*LATITUDE*LATIN_GENUS, type = "response")  %>% summary(infer=TRUE)
```

<div data-pagedtable="false">
  <script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["temperature"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["LATITUDE"],"name":[2],"type":["fct"],"align":["left"]},{"label":["LATIN_GENUS"],"name":[3],"type":["fct"],"align":["left"]},{"label":["response"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["SE"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["asymp.LCL"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["asymp.UCL"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["null"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["z.ratio"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[11],"type":["dbl"],"align":["right"]}],"data":[{"1":"30.4142","2":"sub-tropical","3":"Apogon","4":"18.609799","5":"2.4803060","6":"Inf","7":"14.331574","8":"24.165148","9":"1","10":"21.93651","11":"1.165132e-106","_rn_":"1"},{"1":"30.4142","2":"tropical","3":"Apogon","4":"11.149651","5":"1.4781526","6":"Inf","7":"8.598331","8":"14.458005","9":"1","10":"18.18916","11":"6.289227e-74","_rn_":"2"},{"1":"30.4142","2":"sub-tropical","3":"Pomacentrus","4":"6.139897","5":"0.9236479","6":"Inf","7":"4.572056","8":"8.245377","9":"1","10":"12.06383","11":"1.639739e-33","_rn_":"3"},{"1":"30.4142","2":"tropical","3":"Pomacentrus","4":"6.316453","5":"0.7984430","6":"Inf","7":"4.930325","8":"8.092282","9":"1","10":"14.58115","11":"3.702046e-48","_rn_":"4"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>

### temperture [combined]

```r
lc.means.temp <- lc.model.1.p2.gamma.log %>% update(LDHCS ~ factor(temperature) * LATITUDE * LATIN_GENUS + (1|fish_id)) %>% emmeans(pairwise ~ temperature, type = "response")
```

```
## NOTE: Results may be misleading due to involvement in interactions
```

```r
lc.means.temp.df <- lc.means.temp$emmeans %>% as.data.frame() %>% 
  mutate("\u394 change"=response - lag(response, n=1, default = first(response)), 
         "\u394 %change" = response/lag(response, n=1, default = first(response))*100) 
lc.means.temp.df[1,8] = 0.0000 

lc.means.temp.df  
```

<div data-pagedtable="false">
  <script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["temperature"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["response"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["SE"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["asymp.LCL"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["asymp.UCL"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["Δ change"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["Δ %change"],"name":[8],"type":["dbl"],"align":["right"]}],"data":[{"1":"10","2":"8.947021","3":"0.7275260","4":"Inf","5":"7.628921","6":"10.492858","7":"0.000000","8":"0.00000","_rn_":"1"},{"1":"20","2":"5.551432","3":"0.4609452","4":"Inf","5":"4.717677","6":"6.532535","7":"-3.395589","8":"62.04782","_rn_":"2"},{"1":"30","2":"8.849240","3":"0.6999365","4":"Inf","5":"7.578437","6":"10.333140","7":"3.297808","8":"159.40465","_rn_":"3"},{"1":"40","2":"19.913180","3":"1.5559317","4":"Inf","5":"17.085643","6":"23.208651","7":"11.063940","8":"225.02700","_rn_":"4"},{"1":"50","2":"30.827295","3":"2.4578309","4":"Inf","5":"26.367559","6":"36.041338","7":"10.914115","8":"154.80850","_rn_":"5"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>

### Genus [combined]

```r
lc.means.genus <- lc.model.1.p2.gamma.log %>% update(LDHCS ~ factor(temperature) * LATITUDE * LATIN_GENUS + (1|fish_id)) %>% emmeans(pairwise ~ LATIN_GENUS, type = "response") %>% summary(infer=TRUE); lc.means.genus
```

```
## NOTE: Results may be misleading due to involvement in interactions
```

```
## $emmeans
##  LATIN_GENUS response    SE  df asymp.LCL asymp.UCL null z.ratio p.value
##  Apogon         17.99 1.370 Inf     15.50     20.89    1  37.947  <.0001
##  Pomacentrus     8.27 0.663 Inf      7.06      9.67    1  26.339  <.0001
## 
## Results are averaged over the levels of: temperature, LATITUDE 
## Confidence level used: 0.95 
## Intervals are back-transformed from the log scale 
## Tests are performed on the log scale 
## 
## $contrasts
##  contrast             ratio    SE  df asymp.LCL asymp.UCL null z.ratio p.value
##  Apogon / Pomacentrus  2.18 0.241 Inf      1.75       2.7    1   7.036  <.0001
## 
## Results are averaged over the levels of: temperature, LATITUDE 
## Confidence level used: 0.95 
## Intervals are back-transformed from the log scale 
## Tests are performed on the log scale
```

### Means - f(temperature)

```r
lc.means <- lc.model.1.p2.gamma.log %>% update(LDHCS ~ factor(temperature) * LATITUDE * LATIN_GENUS + (1|fish_id)) %>% emmeans(pairwise ~ temperature*LATIN_GENUS*LATITUDE, type = "response") 

lc.means.df <- lc.means$emmeans %>% as.data.frame() %>% 
  mutate("change"=response - lag(response, n=1, default = first(response)), 
         "%change" = response/lag(response, n=1, default = first(response))*100) %>% 
  mutate("%change" = case_when(temperature == 10 ~ 0, 
                                     TRUE ~ `%change`), 
         "change" = case_when(temperature == 10 ~ 0, 
                                     TRUE ~ `change`)) %>% 
  rename("\u394 %change" = "%change", 
         "\u394 change" = "change")

lc.means.df %>% knitr::kable(format = "html")  %>%
  kable_paper(full_width = TRUE) 
```

<table class=" lightable-paper" style='font-family: "Arial Narrow", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>
 <thead>
  <tr>
   <th style="text-align:right;"> temperature </th>
   <th style="text-align:left;"> LATIN_GENUS </th>
   <th style="text-align:left;"> LATITUDE </th>
   <th style="text-align:right;"> response </th>
   <th style="text-align:right;"> SE </th>
   <th style="text-align:right;"> df </th>
   <th style="text-align:right;"> asymp.LCL </th>
   <th style="text-align:right;"> asymp.UCL </th>
   <th style="text-align:right;"> Δ change </th>
   <th style="text-align:right;"> Δ %change </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:right;"> 10 </td>
   <td style="text-align:left;"> Apogon </td>
   <td style="text-align:left;"> sub-tropical </td>
   <td style="text-align:right;"> 16.663231 </td>
   <td style="text-align:right;"> 2.7162142 </td>
   <td style="text-align:right;"> Inf </td>
   <td style="text-align:right;"> 12.106201 </td>
   <td style="text-align:right;"> 22.935624 </td>
   <td style="text-align:right;"> 0.0000000 </td>
   <td style="text-align:right;"> 0.00000 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 20 </td>
   <td style="text-align:left;"> Apogon </td>
   <td style="text-align:left;"> sub-tropical </td>
   <td style="text-align:right;"> 8.397940 </td>
   <td style="text-align:right;"> 1.3622750 </td>
   <td style="text-align:right;"> Inf </td>
   <td style="text-align:right;"> 6.110754 </td>
   <td style="text-align:right;"> 11.541194 </td>
   <td style="text-align:right;"> -8.2652913 </td>
   <td style="text-align:right;"> 50.39803 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 30 </td>
   <td style="text-align:left;"> Apogon </td>
   <td style="text-align:left;"> sub-tropical </td>
   <td style="text-align:right;"> 19.101364 </td>
   <td style="text-align:right;"> 2.9739347 </td>
   <td style="text-align:right;"> Inf </td>
   <td style="text-align:right;"> 14.077932 </td>
   <td style="text-align:right;"> 25.917307 </td>
   <td style="text-align:right;"> 10.7034240 </td>
   <td style="text-align:right;"> 227.45298 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 40 </td>
   <td style="text-align:left;"> Apogon </td>
   <td style="text-align:left;"> sub-tropical </td>
   <td style="text-align:right;"> 40.354019 </td>
   <td style="text-align:right;"> 6.2337973 </td>
   <td style="text-align:right;"> Inf </td>
   <td style="text-align:right;"> 29.812275 </td>
   <td style="text-align:right;"> 54.623369 </td>
   <td style="text-align:right;"> 21.2526559 </td>
   <td style="text-align:right;"> 211.26251 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 50 </td>
   <td style="text-align:left;"> Apogon </td>
   <td style="text-align:left;"> sub-tropical </td>
   <td style="text-align:right;"> 59.618001 </td>
   <td style="text-align:right;"> 9.2225179 </td>
   <td style="text-align:right;"> Inf </td>
   <td style="text-align:right;"> 44.025273 </td>
   <td style="text-align:right;"> 80.733311 </td>
   <td style="text-align:right;"> 19.2639815 </td>
   <td style="text-align:right;"> 147.73745 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 10 </td>
   <td style="text-align:left;"> Pomacentrus </td>
   <td style="text-align:left;"> sub-tropical </td>
   <td style="text-align:right;"> 6.343275 </td>
   <td style="text-align:right;"> 1.1163744 </td>
   <td style="text-align:right;"> Inf </td>
   <td style="text-align:right;"> 4.492703 </td>
   <td style="text-align:right;"> 8.956109 </td>
   <td style="text-align:right;"> 0.0000000 </td>
   <td style="text-align:right;"> 0.00000 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 20 </td>
   <td style="text-align:left;"> Pomacentrus </td>
   <td style="text-align:left;"> sub-tropical </td>
   <td style="text-align:right;"> 4.364028 </td>
   <td style="text-align:right;"> 0.7672357 </td>
   <td style="text-align:right;"> Inf </td>
   <td style="text-align:right;"> 3.091993 </td>
   <td style="text-align:right;"> 6.159373 </td>
   <td style="text-align:right;"> -1.9792467 </td>
   <td style="text-align:right;"> 68.79771 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 30 </td>
   <td style="text-align:left;"> Pomacentrus </td>
   <td style="text-align:left;"> sub-tropical </td>
   <td style="text-align:right;"> 5.301889 </td>
   <td style="text-align:right;"> 0.9303789 </td>
   <td style="text-align:right;"> Inf </td>
   <td style="text-align:right;"> 3.758904 </td>
   <td style="text-align:right;"> 7.478250 </td>
   <td style="text-align:right;"> 0.9378607 </td>
   <td style="text-align:right;"> 121.49071 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 40 </td>
   <td style="text-align:left;"> Pomacentrus </td>
   <td style="text-align:left;"> sub-tropical </td>
   <td style="text-align:right;"> 13.270229 </td>
   <td style="text-align:right;"> 2.3248371 </td>
   <td style="text-align:right;"> Inf </td>
   <td style="text-align:right;"> 9.413579 </td>
   <td style="text-align:right;"> 18.706910 </td>
   <td style="text-align:right;"> 7.9683405 </td>
   <td style="text-align:right;"> 250.29249 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 50 </td>
   <td style="text-align:left;"> Pomacentrus </td>
   <td style="text-align:left;"> sub-tropical </td>
   <td style="text-align:right;"> 21.522177 </td>
   <td style="text-align:right;"> 3.7714997 </td>
   <td style="text-align:right;"> Inf </td>
   <td style="text-align:right;"> 15.265938 </td>
   <td style="text-align:right;"> 30.342329 </td>
   <td style="text-align:right;"> 8.2519480 </td>
   <td style="text-align:right;"> 162.18392 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 10 </td>
   <td style="text-align:left;"> Apogon </td>
   <td style="text-align:left;"> tropical </td>
   <td style="text-align:right;"> 10.338694 </td>
   <td style="text-align:right;"> 1.6757260 </td>
   <td style="text-align:right;"> Inf </td>
   <td style="text-align:right;"> 7.524895 </td>
   <td style="text-align:right;"> 14.204664 </td>
   <td style="text-align:right;"> 0.0000000 </td>
   <td style="text-align:right;"> 0.00000 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 20 </td>
   <td style="text-align:left;"> Apogon </td>
   <td style="text-align:left;"> tropical </td>
   <td style="text-align:right;"> 7.381772 </td>
   <td style="text-align:right;"> 1.2626136 </td>
   <td style="text-align:right;"> Inf </td>
   <td style="text-align:right;"> 5.279187 </td>
   <td style="text-align:right;"> 10.321771 </td>
   <td style="text-align:right;"> -2.9569221 </td>
   <td style="text-align:right;"> 71.39946 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 30 </td>
   <td style="text-align:left;"> Apogon </td>
   <td style="text-align:left;"> tropical </td>
   <td style="text-align:right;"> 9.818838 </td>
   <td style="text-align:right;"> 1.5065017 </td>
   <td style="text-align:right;"> Inf </td>
   <td style="text-align:right;"> 7.268763 </td>
   <td style="text-align:right;"> 13.263549 </td>
   <td style="text-align:right;"> 2.4370660 </td>
   <td style="text-align:right;"> 133.01465 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 40 </td>
   <td style="text-align:left;"> Apogon </td>
   <td style="text-align:left;"> tropical </td>
   <td style="text-align:right;"> 22.088592 </td>
   <td style="text-align:right;"> 3.2433051 </td>
   <td style="text-align:right;"> Inf </td>
   <td style="text-align:right;"> 16.564743 </td>
   <td style="text-align:right;"> 29.454482 </td>
   <td style="text-align:right;"> 12.2697541 </td>
   <td style="text-align:right;"> 224.96136 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 50 </td>
   <td style="text-align:left;"> Apogon </td>
   <td style="text-align:left;"> tropical </td>
   <td style="text-align:right;"> 33.426505 </td>
   <td style="text-align:right;"> 5.3491132 </td>
   <td style="text-align:right;"> Inf </td>
   <td style="text-align:right;"> 24.427359 </td>
   <td style="text-align:right;"> 45.740977 </td>
   <td style="text-align:right;"> 11.3379131 </td>
   <td style="text-align:right;"> 151.32927 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 10 </td>
   <td style="text-align:left;"> Pomacentrus </td>
   <td style="text-align:left;"> tropical </td>
   <td style="text-align:right;"> 5.863749 </td>
   <td style="text-align:right;"> 0.8666266 </td>
   <td style="text-align:right;"> Inf </td>
   <td style="text-align:right;"> 4.389075 </td>
   <td style="text-align:right;"> 7.833896 </td>
   <td style="text-align:right;"> 0.0000000 </td>
   <td style="text-align:right;"> 0.00000 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 20 </td>
   <td style="text-align:left;"> Pomacentrus </td>
   <td style="text-align:left;"> tropical </td>
   <td style="text-align:right;"> 3.510743 </td>
   <td style="text-align:right;"> 0.5378392 </td>
   <td style="text-align:right;"> Inf </td>
   <td style="text-align:right;"> 2.600139 </td>
   <td style="text-align:right;"> 4.740253 </td>
   <td style="text-align:right;"> -2.3530058 </td>
   <td style="text-align:right;"> 59.87199 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 30 </td>
   <td style="text-align:left;"> Pomacentrus </td>
   <td style="text-align:left;"> tropical </td>
   <td style="text-align:right;"> 6.166927 </td>
   <td style="text-align:right;"> 0.9052013 </td>
   <td style="text-align:right;"> Inf </td>
   <td style="text-align:right;"> 4.625160 </td>
   <td style="text-align:right;"> 8.222633 </td>
   <td style="text-align:right;"> 2.6561841 </td>
   <td style="text-align:right;"> 175.65874 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 40 </td>
   <td style="text-align:left;"> Pomacentrus </td>
   <td style="text-align:left;"> tropical </td>
   <td style="text-align:right;"> 13.293190 </td>
   <td style="text-align:right;"> 1.9518381 </td>
   <td style="text-align:right;"> Inf </td>
   <td style="text-align:right;"> 9.968902 </td>
   <td style="text-align:right;"> 17.726013 </td>
   <td style="text-align:right;"> 7.1262621 </td>
   <td style="text-align:right;"> 215.55612 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 50 </td>
   <td style="text-align:left;"> Pomacentrus </td>
   <td style="text-align:left;"> tropical </td>
   <td style="text-align:right;"> 21.056543 </td>
   <td style="text-align:right;"> 3.0872075 </td>
   <td style="text-align:right;"> Inf </td>
   <td style="text-align:right;"> 15.797489 </td>
   <td style="text-align:right;"> 28.066360 </td>
   <td style="text-align:right;"> 7.7633538 </td>
   <td style="text-align:right;"> 158.40099 </td>
  </tr>
</tbody>
</table>

### Abs. diff - f(temperature)

```r
lc.model.1.p2.gamma.log %>% update(LDHCS ~ factor(temperature) * LATITUDE * LATIN_GENUS + (1|fish_id)) %>% emmeans(pairwise ~ temperature*LATIN_GENUS*LATITUDE, type = "response") %>% regrid() %>% pairs(by =c("LATIN_GENUS","LATITUDE")) %>% summary(infer=TRUE, type = "response")
```

<div data-pagedtable="false">
  <script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["contrast"],"name":[1],"type":["fct"],"align":["left"]},{"label":["LATIN_GENUS"],"name":[2],"type":["fct"],"align":["left"]},{"label":["LATITUDE"],"name":[3],"type":["fct"],"align":["left"]},{"label":["estimate"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["SE"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["asymp.LCL"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["asymp.UCL"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["z.ratio"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[10],"type":["dbl"],"align":["right"]}],"data":[{"1":"temperature10 - temperature20","2":"Apogon","3":"sub-tropical","4":"8.2652913","5":"2.5909966","6":"Inf","7":"1.19763728","8":"15.3329453","9":"3.1900047","10":"1.239495e-02","_rn_":"1"},{"1":"temperature10 - temperature30","2":"Apogon","3":"sub-tropical","4":"-2.4381327","5":"3.2780018","6":"Inf","7":"-11.37978201","8":"6.5035166","9":"-0.7437863","10":"9.461567e-01","_rn_":"2"},{"1":"temperature10 - temperature40","2":"Apogon","3":"sub-tropical","4":"-23.6907886","5":"5.8789527","6":"Inf","7":"-39.72724520","8":"-7.6543320","9":"-4.0297634","10":"5.350521e-04","_rn_":"3"},{"1":"temperature10 - temperature50","2":"Apogon","3":"sub-tropical","4":"-42.9547701","5":"8.6599563","6":"Inf","7":"-66.57717704","8":"-19.3323632","9":"-4.9601601","10":"6.979694e-06","_rn_":"4"},{"1":"temperature20 - temperature30","2":"Apogon","3":"sub-tropical","4":"-10.7034240","5":"2.8268328","6":"Inf","7":"-18.41438607","8":"-2.9924620","9":"-3.7863662","10":"1.438079e-03","_rn_":"5"},{"1":"temperature20 - temperature40","2":"Apogon","3":"sub-tropical","4":"-31.9560799","5":"5.8996235","6":"Inf","7":"-48.04892185","8":"-15.8632379","9":"-5.4166303","10":"6.049835e-07","_rn_":"6"},{"1":"temperature20 - temperature50","2":"Apogon","3":"sub-tropical","4":"-51.2200614","5":"8.8379092","6":"Inf","7":"-75.32788374","8":"-27.1122391","9":"-5.7954953","10":"6.799691e-08","_rn_":"7"},{"1":"temperature30 - temperature40","2":"Apogon","3":"sub-tropical","4":"-21.2526559","5":"5.8669671","6":"Inf","7":"-37.25641836","8":"-5.2488934","9":"-3.6224263","10":"2.701836e-03","_rn_":"8"},{"1":"temperature30 - temperature50","2":"Apogon","3":"sub-tropical","4":"-40.5166374","5":"8.6185376","6":"Inf","7":"-64.02606341","8":"-17.0072114","9":"-4.7011035","10":"2.550683e-05","_rn_":"9"},{"1":"temperature40 - temperature50","2":"Apogon","3":"sub-tropical","4":"-19.2639815","5":"9.0403097","6":"Inf","7":"-43.92390667","8":"5.3959436","9":"-2.1308984","10":"2.068834e-01","_rn_":"10"},{"1":"temperature10 - temperature20","2":"Pomacentrus","3":"sub-tropical","4":"1.9792467","5":"1.1026568","6":"Inf","7":"-1.02855213","8":"4.9870456","9":"1.7949799","10":"3.764218e-01","_rn_":"11"},{"1":"temperature10 - temperature30","2":"Pomacentrus","3":"sub-tropical","4":"1.0413861","5":"1.1701876","6":"Inf","7":"-2.15062162","8":"4.2333938","9":"0.8899309","10":"9.007430e-01","_rn_":"12"},{"1":"temperature10 - temperature40","2":"Pomacentrus","3":"sub-tropical","4":"-6.9269544","5":"2.1836153","6":"Inf","7":"-12.88336437","8":"-0.9705444","9":"-3.1722411","10":"1.313697e-02","_rn_":"13"},{"1":"temperature10 - temperature50","2":"Pomacentrus","3":"sub-tropical","4":"-15.1789024","5":"3.5256316","6":"Inf","7":"-24.79603006","8":"-5.5617748","9":"-4.3053002","10":"1.622005e-04","_rn_":"14"},{"1":"temperature20 - temperature30","2":"Pomacentrus","3":"sub-tropical","4":"-0.9378607","5":"0.9706801","6":"Inf","7":"-3.58565704","8":"1.7099357","9":"-0.9661892","10":"8.703681e-01","_rn_":"15"},{"1":"temperature20 - temperature40","2":"Pomacentrus","3":"sub-tropical","4":"-8.9062012","5":"2.1684788","6":"Inf","7":"-14.82132212","8":"-2.9910802","9":"-4.1071193","10":"3.857495e-04","_rn_":"16"},{"1":"temperature20 - temperature50","2":"Pomacentrus","3":"sub-tropical","4":"-17.1581492","5":"3.5652266","6":"Inf","7":"-26.88328291","8":"-7.4330155","9":"-4.8126392","10":"1.471978e-05","_rn_":"17"},{"1":"temperature30 - temperature40","2":"Pomacentrus","3":"sub-tropical","4":"-7.9683405","5":"2.1676378","6":"Inf","7":"-13.88116734","8":"-2.0555137","9":"-3.6760480","10":"2.205219e-03","_rn_":"18"},{"1":"temperature30 - temperature50","2":"Pomacentrus","3":"sub-tropical","4":"-16.2202885","5":"3.5426367","6":"Inf","7":"-25.88380230","8":"-6.5567748","9":"-4.5785921","10":"4.599038e-05","_rn_":"19"},{"1":"temperature40 - temperature50","2":"Pomacentrus","3":"sub-tropical","4":"-8.2519480","5":"3.6345947","6":"Inf","7":"-18.16630244","8":"1.6624064","9":"-2.2703901","10":"1.545208e-01","_rn_":"20"},{"1":"temperature10 - temperature20","2":"Apogon","3":"tropical","4":"2.9569221","5":"1.7448477","6":"Inf","7":"-1.80262862","8":"7.7164729","9":"1.6946592","10":"4.372005e-01","_rn_":"21"},{"1":"temperature10 - temperature30","2":"Apogon","3":"tropical","4":"0.5198561","5":"1.9000957","6":"Inf","7":"-4.66317628","8":"5.7028885","9":"0.2735947","10":"9.987740e-01","_rn_":"22"},{"1":"temperature10 - temperature40","2":"Apogon","3":"tropical","4":"-11.7498980","5":"3.1386585","6":"Inf","7":"-20.31145013","8":"-3.1883458","9":"-3.7436051","10":"1.699882e-03","_rn_":"23"},{"1":"temperature10 - temperature50","2":"Apogon","3":"tropical","4":"-23.0878110","5":"5.1046731","6":"Inf","7":"-37.01220756","8":"-9.1634145","9":"-4.5228775","10":"5.983067e-05","_rn_":"24"},{"1":"temperature20 - temperature30","2":"Apogon","3":"tropical","4":"-2.4370660","5":"1.6754545","6":"Inf","7":"-7.00732777","8":"2.1331957","9":"-1.4545701","10":"5.921652e-01","_rn_":"25"},{"1":"temperature20 - temperature40","2":"Apogon","3":"tropical","4":"-14.7068201","5":"3.0857905","6":"Inf","7":"-23.12416033","8":"-6.2894799","9":"-4.7659814","10":"1.855389e-05","_rn_":"26"},{"1":"temperature20 - temperature50","2":"Apogon","3":"tropical","4":"-26.0447332","5":"5.1603451","6":"Inf","7":"-40.12099046","8":"-11.9684759","9":"-5.0470913","10":"4.451142e-06","_rn_":"27"},{"1":"temperature30 - temperature40","2":"Apogon","3":"tropical","4":"-12.2697541","5":"3.0581748","6":"Inf","7":"-20.61176496","8":"-3.9277432","9":"-4.0121166","10":"5.760134e-04","_rn_":"28"},{"1":"temperature30 - temperature50","2":"Apogon","3":"tropical","4":"-23.6076671","5":"5.0783981","6":"Inf","7":"-37.46039135","8":"-9.7549429","9":"-4.6486445","10":"3.289129e-05","_rn_":"29"},{"1":"temperature40 - temperature50","2":"Apogon","3":"tropical","4":"-11.3379131","5":"5.2783059","6":"Inf","7":"-25.73594062","8":"3.0601145","9":"-2.1480212","10":"1.998730e-01","_rn_":"30"},{"1":"temperature10 - temperature20","2":"Pomacentrus","3":"tropical","4":"2.3530058","5":"0.8426695","6":"Inf","7":"0.05439356","8":"4.6516181","9":"2.7923235","10":"4.177339e-02","_rn_":"31"},{"1":"temperature10 - temperature30","2":"Pomacentrus","3":"tropical","4":"-0.3031783","5":"1.0038604","6":"Inf","7":"-3.04148289","8":"2.4351263","9":"-0.3020124","10":"9.981934e-01","_rn_":"32"},{"1":"temperature10 - temperature40","2":"Pomacentrus","3":"tropical","4":"-7.4294404","5":"1.8346846","6":"Inf","7":"-12.43404614","8":"-2.4248347","9":"-4.0494373","10":"4.926219e-04","_rn_":"33"},{"1":"temperature10 - temperature50","2":"Pomacentrus","3":"tropical","4":"-15.1927942","5":"2.8961490","6":"Inf","7":"-23.09283524","8":"-7.2927531","9":"-5.2458607","10":"1.547217e-06","_rn_":"34"},{"1":"temperature20 - temperature30","2":"Pomacentrus","3":"tropical","4":"-2.6561841","5":"0.8769730","6":"Inf","7":"-5.04836852","8":"-0.2639997","9":"-3.0288096","10":"2.073364e-02","_rn_":"35"},{"1":"temperature20 - temperature40","2":"Pomacentrus","3":"tropical","4":"-9.7824462","5":"1.8381364","6":"Inf","7":"-14.79646767","8":"-4.7684248","9":"-5.3219370","10":"1.021925e-06","_rn_":"36"},{"1":"temperature20 - temperature50","2":"Pomacentrus","3":"tropical","4":"-17.5458000","5":"2.9463668","6":"Inf","7":"-25.58282378","8":"-9.5087762","9":"-5.9550631","10":"2.596357e-08","_rn_":"37"},{"1":"temperature30 - temperature40","2":"Pomacentrus","3":"tropical","4":"-7.1262621","5":"1.8286096","6":"Inf","7":"-12.11429654","8":"-2.1382277","9":"-3.8970932","10":"9.242568e-04","_rn_":"38"},{"1":"temperature30 - temperature50","2":"Pomacentrus","3":"tropical","4":"-14.8896159","5":"2.8824420","6":"Inf","7":"-22.75226726","8":"-7.0269645","9":"-5.1656255","10":"2.381450e-06","_rn_":"39"},{"1":"temperature40 - temperature50","2":"Pomacentrus","3":"tropical","4":"-7.7633538","5":"2.9852331","6":"Inf","7":"-15.90639623","8":"0.3796887","9":"-2.6005854","10":"7.021748e-02","_rn_":"40"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>

### effect size

```r
lc.emm <- lc.model.1.p2.gamma.log %>% emmeans(~temperature*LATITUDE*LATIN_GENUS)
eff_size(lc.emm, sigma = sigma(lc.model.1.p2.gamma.log), edf=df.residual(lc.model.1.p2.gamma.log))
```

```
##  contrast                                                                                                
##  (temperature30.414201183432 sub-tropical Apogon) - temperature30.414201183432 tropical Apogon           
##  (temperature30.414201183432 sub-tropical Apogon) - (temperature30.414201183432 sub-tropical Pomacentrus)
##  (temperature30.414201183432 sub-tropical Apogon) - temperature30.414201183432 tropical Pomacentrus      
##  temperature30.414201183432 tropical Apogon - (temperature30.414201183432 sub-tropical Pomacentrus)      
##  temperature30.414201183432 tropical Apogon - temperature30.414201183432 tropical Pomacentrus            
##  (temperature30.414201183432 sub-tropical Pomacentrus) - temperature30.414201183432 tropical Pomacentrus 
##  effect.size    SE  df asymp.LCL asymp.UCL
##       1.2191 0.452 Inf     0.333     2.105
##       2.6389 0.500 Inf     1.660     3.618
##       2.5714 0.459 Inf     1.672     3.471
##       1.4198 0.483 Inf     0.472     2.367
##       1.3523 0.442 Inf     0.486     2.219
##      -0.0675 0.468 Inf    -0.984     0.849
## 
## sigma used for effect sizes: 0.4202 
## Confidence level used: 0.95
```

### {-}

## Summary figure


```r
lc.emm <- emmeans(lc.model.1.p2.gamma.log, ~temperature|LATITUDE|LATIN_GENUS, 
                   at = list(temperature = seq(from =10, to =50, by =.1)), 
                   type = "response") 

lc.emm.df <- lc.emm %>% as.data.frame() %>%
  unite("species", c("LATIN_GENUS","LATITUDE"), sep = "-", remove = FALSE) 

lc.obs <-  lc.data %>% 
  mutate(Pred=exp(predict(lc.model.1.p2.gamma.log, re.form=NA)),
         Resid = residuals(lc.model.1.p2.gamma.log, type="response"),
         Fit = Pred + Resid) %>%
   unite("species", c("LATIN_GENUS","LATITUDE"), sep = "-", remove = FALSE) 


lc.plot <- ggplot(lc.emm.df, aes(y=response, x=temperature, linetype=species, color = species, fill=species))+
  geom_jitter(data=lc.obs, 
              aes(y=Fit, color = species), 
              width=0.05, 
              alpha = 0.3, 
              size = 2) +
  geom_line(linewidth =1) + 
  geom_ribbon(aes(x=temperature, 
              ymin= asymp.LCL, ymax= asymp.UCL),
              alpha = 0.2, 
              color=NA)+ 
  #scale_x_continuous(limits = c(9, 52), 
                     #breaks = seq(10, 52, by = 10))+ 
  #scale_y_continuous(limits = c(0,120), breaks = seq(0, 120, by = 20)) +
  theme_classic() + 
  ylab(expression("log(LDH:CS (U mg "^{-1} * "tissue))")) + 
  xlab("")+
  scale_linetype_manual(values = c("solid", "dashed","solid", "dashed"), 
                        labels = c("Apogon doederlein","Apogon rubrimacula","Pomacentrus australis", "Pomacentrus moluccensis")) +
  scale_color_manual(values=c("#3F3525","#C65C1B",  "#07AFF2", "#EAAE00"), 
                        labels = c("Apogon doederlein","Apogon rubrimacula","Pomacentrus australis", "Pomacentrus moluccensis")) +
  scale_fill_manual(values=c("#3F3525","#C65C1B",  "#07AFF2", "#EAAE00"), 
                        labels = c("Apogon doederlein","Apogon rubrimacula","Pomacentrus australis", "Pomacentrus moluccensis")) +  
  theme(legend.position = "top", 
        legend.text = element_text(size = 10), 
        legend.title = element_blank(), 
        axis.title = element_text(size =12), 
        axis.text = element_text(size=10)); lc.plot
```

![](01.DataAnalysis_files/figure-html/lc-sum-fig-1.png)<!-- -->



# Descriptive statistics 


```r
lc.data2 <- lc.data %>% select(c("LATIN_NAME", "temperature", "CS_ACTIVITY", "LDH_ACTIVITY", "LDHCS")) %>% 
  pivot_longer(!c(LATIN_NAME,temperature), names_to = "enzyme")
table(lc.data2$LATIN_NAME,lc.data2$temperature, lc.data2$enzyme) %>% knitr::kable(format = "html")  %>%
  kable_paper(full_width = TRUE)
```

<table class=" lightable-paper" style='font-family: "Arial Narrow", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>
 <thead>
  <tr>
   <th style="text-align:left;"> Var1 </th>
   <th style="text-align:left;"> Var2 </th>
   <th style="text-align:left;"> Var3 </th>
   <th style="text-align:right;"> Freq </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Apogon doederlein </td>
   <td style="text-align:left;"> 10 </td>
   <td style="text-align:left;"> CS_ACTIVITY </td>
   <td style="text-align:right;"> 8 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Apogon rubrimacula </td>
   <td style="text-align:left;"> 10 </td>
   <td style="text-align:left;"> CS_ACTIVITY </td>
   <td style="text-align:right;"> 8 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Pomacentrus australis </td>
   <td style="text-align:left;"> 10 </td>
   <td style="text-align:left;"> CS_ACTIVITY </td>
   <td style="text-align:right;"> 7 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Pomacentrus moluccensis </td>
   <td style="text-align:left;"> 10 </td>
   <td style="text-align:left;"> CS_ACTIVITY </td>
   <td style="text-align:right;"> 10 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Apogon doederlein </td>
   <td style="text-align:left;"> 20 </td>
   <td style="text-align:left;"> CS_ACTIVITY </td>
   <td style="text-align:right;"> 8 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Apogon rubrimacula </td>
   <td style="text-align:left;"> 20 </td>
   <td style="text-align:left;"> CS_ACTIVITY </td>
   <td style="text-align:right;"> 7 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Pomacentrus australis </td>
   <td style="text-align:left;"> 20 </td>
   <td style="text-align:left;"> CS_ACTIVITY </td>
   <td style="text-align:right;"> 7 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Pomacentrus moluccensis </td>
   <td style="text-align:left;"> 20 </td>
   <td style="text-align:left;"> CS_ACTIVITY </td>
   <td style="text-align:right;"> 9 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Apogon doederlein </td>
   <td style="text-align:left;"> 30 </td>
   <td style="text-align:left;"> CS_ACTIVITY </td>
   <td style="text-align:right;"> 9 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Apogon rubrimacula </td>
   <td style="text-align:left;"> 30 </td>
   <td style="text-align:left;"> CS_ACTIVITY </td>
   <td style="text-align:right;"> 9 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Pomacentrus australis </td>
   <td style="text-align:left;"> 30 </td>
   <td style="text-align:left;"> CS_ACTIVITY </td>
   <td style="text-align:right;"> 7 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Pomacentrus moluccensis </td>
   <td style="text-align:left;"> 30 </td>
   <td style="text-align:left;"> CS_ACTIVITY </td>
   <td style="text-align:right;"> 10 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Apogon doederlein </td>
   <td style="text-align:left;"> 40 </td>
   <td style="text-align:left;"> CS_ACTIVITY </td>
   <td style="text-align:right;"> 9 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Apogon rubrimacula </td>
   <td style="text-align:left;"> 40 </td>
   <td style="text-align:left;"> CS_ACTIVITY </td>
   <td style="text-align:right;"> 10 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Pomacentrus australis </td>
   <td style="text-align:left;"> 40 </td>
   <td style="text-align:left;"> CS_ACTIVITY </td>
   <td style="text-align:right;"> 7 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Pomacentrus moluccensis </td>
   <td style="text-align:left;"> 40 </td>
   <td style="text-align:left;"> CS_ACTIVITY </td>
   <td style="text-align:right;"> 10 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Apogon doederlein </td>
   <td style="text-align:left;"> 50 </td>
   <td style="text-align:left;"> CS_ACTIVITY </td>
   <td style="text-align:right;"> 9 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Apogon rubrimacula </td>
   <td style="text-align:left;"> 50 </td>
   <td style="text-align:left;"> CS_ACTIVITY </td>
   <td style="text-align:right;"> 8 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Pomacentrus australis </td>
   <td style="text-align:left;"> 50 </td>
   <td style="text-align:left;"> CS_ACTIVITY </td>
   <td style="text-align:right;"> 7 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Pomacentrus moluccensis </td>
   <td style="text-align:left;"> 50 </td>
   <td style="text-align:left;"> CS_ACTIVITY </td>
   <td style="text-align:right;"> 10 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Apogon doederlein </td>
   <td style="text-align:left;"> 10 </td>
   <td style="text-align:left;"> LDH_ACTIVITY </td>
   <td style="text-align:right;"> 8 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Apogon rubrimacula </td>
   <td style="text-align:left;"> 10 </td>
   <td style="text-align:left;"> LDH_ACTIVITY </td>
   <td style="text-align:right;"> 8 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Pomacentrus australis </td>
   <td style="text-align:left;"> 10 </td>
   <td style="text-align:left;"> LDH_ACTIVITY </td>
   <td style="text-align:right;"> 7 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Pomacentrus moluccensis </td>
   <td style="text-align:left;"> 10 </td>
   <td style="text-align:left;"> LDH_ACTIVITY </td>
   <td style="text-align:right;"> 10 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Apogon doederlein </td>
   <td style="text-align:left;"> 20 </td>
   <td style="text-align:left;"> LDH_ACTIVITY </td>
   <td style="text-align:right;"> 8 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Apogon rubrimacula </td>
   <td style="text-align:left;"> 20 </td>
   <td style="text-align:left;"> LDH_ACTIVITY </td>
   <td style="text-align:right;"> 7 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Pomacentrus australis </td>
   <td style="text-align:left;"> 20 </td>
   <td style="text-align:left;"> LDH_ACTIVITY </td>
   <td style="text-align:right;"> 7 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Pomacentrus moluccensis </td>
   <td style="text-align:left;"> 20 </td>
   <td style="text-align:left;"> LDH_ACTIVITY </td>
   <td style="text-align:right;"> 9 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Apogon doederlein </td>
   <td style="text-align:left;"> 30 </td>
   <td style="text-align:left;"> LDH_ACTIVITY </td>
   <td style="text-align:right;"> 9 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Apogon rubrimacula </td>
   <td style="text-align:left;"> 30 </td>
   <td style="text-align:left;"> LDH_ACTIVITY </td>
   <td style="text-align:right;"> 9 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Pomacentrus australis </td>
   <td style="text-align:left;"> 30 </td>
   <td style="text-align:left;"> LDH_ACTIVITY </td>
   <td style="text-align:right;"> 7 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Pomacentrus moluccensis </td>
   <td style="text-align:left;"> 30 </td>
   <td style="text-align:left;"> LDH_ACTIVITY </td>
   <td style="text-align:right;"> 10 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Apogon doederlein </td>
   <td style="text-align:left;"> 40 </td>
   <td style="text-align:left;"> LDH_ACTIVITY </td>
   <td style="text-align:right;"> 9 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Apogon rubrimacula </td>
   <td style="text-align:left;"> 40 </td>
   <td style="text-align:left;"> LDH_ACTIVITY </td>
   <td style="text-align:right;"> 10 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Pomacentrus australis </td>
   <td style="text-align:left;"> 40 </td>
   <td style="text-align:left;"> LDH_ACTIVITY </td>
   <td style="text-align:right;"> 7 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Pomacentrus moluccensis </td>
   <td style="text-align:left;"> 40 </td>
   <td style="text-align:left;"> LDH_ACTIVITY </td>
   <td style="text-align:right;"> 10 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Apogon doederlein </td>
   <td style="text-align:left;"> 50 </td>
   <td style="text-align:left;"> LDH_ACTIVITY </td>
   <td style="text-align:right;"> 9 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Apogon rubrimacula </td>
   <td style="text-align:left;"> 50 </td>
   <td style="text-align:left;"> LDH_ACTIVITY </td>
   <td style="text-align:right;"> 8 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Pomacentrus australis </td>
   <td style="text-align:left;"> 50 </td>
   <td style="text-align:left;"> LDH_ACTIVITY </td>
   <td style="text-align:right;"> 7 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Pomacentrus moluccensis </td>
   <td style="text-align:left;"> 50 </td>
   <td style="text-align:left;"> LDH_ACTIVITY </td>
   <td style="text-align:right;"> 10 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Apogon doederlein </td>
   <td style="text-align:left;"> 10 </td>
   <td style="text-align:left;"> LDHCS </td>
   <td style="text-align:right;"> 8 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Apogon rubrimacula </td>
   <td style="text-align:left;"> 10 </td>
   <td style="text-align:left;"> LDHCS </td>
   <td style="text-align:right;"> 8 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Pomacentrus australis </td>
   <td style="text-align:left;"> 10 </td>
   <td style="text-align:left;"> LDHCS </td>
   <td style="text-align:right;"> 7 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Pomacentrus moluccensis </td>
   <td style="text-align:left;"> 10 </td>
   <td style="text-align:left;"> LDHCS </td>
   <td style="text-align:right;"> 10 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Apogon doederlein </td>
   <td style="text-align:left;"> 20 </td>
   <td style="text-align:left;"> LDHCS </td>
   <td style="text-align:right;"> 8 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Apogon rubrimacula </td>
   <td style="text-align:left;"> 20 </td>
   <td style="text-align:left;"> LDHCS </td>
   <td style="text-align:right;"> 7 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Pomacentrus australis </td>
   <td style="text-align:left;"> 20 </td>
   <td style="text-align:left;"> LDHCS </td>
   <td style="text-align:right;"> 7 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Pomacentrus moluccensis </td>
   <td style="text-align:left;"> 20 </td>
   <td style="text-align:left;"> LDHCS </td>
   <td style="text-align:right;"> 9 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Apogon doederlein </td>
   <td style="text-align:left;"> 30 </td>
   <td style="text-align:left;"> LDHCS </td>
   <td style="text-align:right;"> 9 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Apogon rubrimacula </td>
   <td style="text-align:left;"> 30 </td>
   <td style="text-align:left;"> LDHCS </td>
   <td style="text-align:right;"> 9 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Pomacentrus australis </td>
   <td style="text-align:left;"> 30 </td>
   <td style="text-align:left;"> LDHCS </td>
   <td style="text-align:right;"> 7 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Pomacentrus moluccensis </td>
   <td style="text-align:left;"> 30 </td>
   <td style="text-align:left;"> LDHCS </td>
   <td style="text-align:right;"> 10 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Apogon doederlein </td>
   <td style="text-align:left;"> 40 </td>
   <td style="text-align:left;"> LDHCS </td>
   <td style="text-align:right;"> 9 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Apogon rubrimacula </td>
   <td style="text-align:left;"> 40 </td>
   <td style="text-align:left;"> LDHCS </td>
   <td style="text-align:right;"> 10 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Pomacentrus australis </td>
   <td style="text-align:left;"> 40 </td>
   <td style="text-align:left;"> LDHCS </td>
   <td style="text-align:right;"> 7 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Pomacentrus moluccensis </td>
   <td style="text-align:left;"> 40 </td>
   <td style="text-align:left;"> LDHCS </td>
   <td style="text-align:right;"> 10 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Apogon doederlein </td>
   <td style="text-align:left;"> 50 </td>
   <td style="text-align:left;"> LDHCS </td>
   <td style="text-align:right;"> 9 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Apogon rubrimacula </td>
   <td style="text-align:left;"> 50 </td>
   <td style="text-align:left;"> LDHCS </td>
   <td style="text-align:right;"> 8 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Pomacentrus australis </td>
   <td style="text-align:left;"> 50 </td>
   <td style="text-align:left;"> LDHCS </td>
   <td style="text-align:right;"> 7 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Pomacentrus moluccensis </td>
   <td style="text-align:left;"> 50 </td>
   <td style="text-align:left;"> LDHCS </td>
   <td style="text-align:right;"> 10 </td>
  </tr>
</tbody>
</table>
